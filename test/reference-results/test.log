[92mannotate-ref-simu[0m                ./bin/partis annotate --plot-performance --plotdir test/new-results/simu-ref-performance --only-csv-plots --is-simu --sw-cachefname test/reference-results/test/parameters/simu/sw-cache.csv --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/annotate-ref-simu.csv
annotating
smith-waterman 
        reading sw results from test/reference-results/test/parameters/simu/sw-cache
      info for 2586 / 2586 = 1.000   (0 failed)
      kept 1908 (0.738) unproductive
    -9098341673696474289 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    211172323439390501 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    6437644377004362661 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -6965878471761077150 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    5793973750091398127 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -6965878471761077149 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    7462386109648167113 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.2 sec)
        water time: 4.0
hmm
    running 10 procs
    read output
    7462386109648167113 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    211172323439390501 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    6437644377004362661 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    5793973750091398127 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -9098341673696474289 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -6965878471761077149 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -6965878471761077150 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.3 sec)
        processed 2586 hmm output lines with 2586 sequences in 2586 events  (0 failures)
         infra time: 7.9
      hmm step time: 13.4
      total time: 18.7
[92mpartition-ref-simu[0m               ./bin/partis partition --n-max-queries 500 --n-precache-procs 10 --biggest-logprob-cluster-to-calculate 5 --biggest-naive-seq-cluster-to-calculate 5 --persistent-cachefname test/new-results/cache-ref-partition.csv --is-simu --sw-cachefname test/reference-results/test/parameters/simu/sw-cache.csv --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/partition-ref-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
        reading sw results from test/reference-results/test/parameters/simu/sw-cache
      info for 500 / 500 = 1.000   (0 failed)
      kept 344 (0.688) unproductive
        water time: 1.3
hmm
--> caching all 500 naive sequences
    running 10 procs
                no/empty cache file
                    calcd:         vtb 500        fwd   0
                   merged:       hfrac   0     lratio   0
             min-max time:  1.8 - 2.3 sec
         infra time: 0.2
      hmm step time: 2.6
--> 500 clusters with 10 procs
       naive hfrac bounds: 0.015 0.118   (0.132 mean mutation in parameter dir test/reference-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 500   logprobs   0
                    calcd:         vtb 102        fwd 345
                   merged:       hfrac 127     lratio  29
             min-max time:  2.5 - 3.9 sec
         infra time: 0.2
      hmm step time: 4.1
--> 344 clusters with 7 procs
    running 7 procs
          read from cache:  naive-seqs 656   logprobs 345
                    calcd:         vtb  51        fwd 163
                   merged:       hfrac  69     lratio  16
             min-max time:  2.8 - 4.0 sec
         infra time: 0.3
      hmm step time: 4.3
--> 259 clusters with 5 procs
    running 5 procs
          read from cache:  naive-seqs 746   logprobs 508
                    calcd:         vtb  38        fwd 135
                   merged:       hfrac  36     lratio  17
             min-max time:  3.0 - 5.7 sec
         infra time: 0.1
      hmm step time: 5.9
--> 206 clusters with 3 procs
    running 3 procs
          read from cache:  naive-seqs 805   logprobs 643
                    calcd:         vtb  33        fwd 135
                   merged:       hfrac  33     lratio  13
             min-max time:  5.9 - 7.5 sec
         infra time: 0.1
      hmm step time: 7.7
--> 160 clusters with 2 procs
    running 2 procs
          read from cache:  naive-seqs 858   logprobs 778
                    calcd:         vtb  19        fwd  95
                   merged:       hfrac  27     lratio  10
             min-max time:  7.8 - 10.4 sec
         infra time: 0.2
      hmm step time: 10.6
--> 123 clusters with 2 procs
    running 2 procs
          read from cache:  naive-seqs 901   logprobs 873
                    calcd:         vtb   9        fwd  46
                   merged:       hfrac  11     lratio   5
             min-max time:  4.4 - 6.6 sec
      hmm step time: 6.8
--> 107 clusters with 2 procs
    running 2 procs
          read from cache:  naive-seqs 922   logprobs 919
                    calcd:         vtb   5        fwd  25
                   merged:       hfrac   6     lratio   2
             min-max time:  4.1 - 6.5 sec
      hmm step time: 6.7
--> 99 clusters with 2 procs
    running 2 procs
          read from cache:  naive-seqs 931   logprobs 944
                    calcd:         vtb   4        fwd  15
                   merged:       hfrac   3     lratio   1
             min-max time:  3.3 - 3.4 sec
         infra time: 0.2
      hmm step time: 3.7
--> 95 clusters with 1 proc
    running 1 proc
          read from cache:  naive-seqs 936   logprobs 959
                    calcd:         vtb   0        fwd  62
                   merged:       hfrac   2     lratio   1
                     time:  12.2 sec
      hmm step time: 12.3
      loop time: 62.1
--> getting annotations for final partition
    running 10 procs
      hmm step time: 1.8
    read output
        processed 92 hmm output lines with 500 sequences in 92 events  (0 failures)
      total time: 68.4
[92mseed-partition-ref-simu[0m          ./bin/partis partition --n-max-queries 500 --persistent-cachefname test/new-results/cache-ref-partition.csv --dont-precache-naive-seqs --is-simu --sw-cachefname test/reference-results/test/parameters/simu/sw-cache.csv --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed-unique-id -2993100530090912503 --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/seed-partition-ref-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
        reading sw results from test/reference-results/test/parameters/simu/sw-cache
      info for 500 / 500 = 1.000   (0 failed)
      kept 344 (0.688) unproductive
      removed 488 / 500 = 0.98 sequences with cdr3 length different from seed sequence (leaving 12)
        water time: 1.0
hmm
--> 12 clusters with 10 procs
       naive hfrac bounds: 0.015 0.118   (0.132 mean mutation in parameter dir test/reference-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 939   logprobs 1021
                    calcd:         vtb   7        fwd   8
                   merged:       hfrac   4     lratio   3
             min-max time:  0.0 - 0.7 sec
      hmm step time: 0.8
--> 14 clusters with 7 procs
    running 7 procs
          read from cache:  naive-seqs 946   logprobs 1027
                    calcd:         vtb   0        fwd   0
                   merged:       hfrac   0     lratio   0
             min-max time:  0.0 - 0.0 sec
    nothing to merge into /tmp/dralph/hmms/65941/hmm_cached_info.csv
      hmm step time: 0.1
--> 11 clusters with 5 procs
    running 5 procs
          read from cache:  naive-seqs 946   logprobs 1027
                    calcd:         vtb   2        fwd   2
                   merged:       hfrac   1     lratio   1
             min-max time:  0.0 - 0.9 sec
      hmm step time: 1.0
      removing 4 sequences in unseeded clusters, and splitting 5 seeded clusters into 8 singletons
        new n_procs 8 (initial seqs/proc: 1.20   new seqs/proc: 1.00
--> 8 clusters with 8 procs
    running 8 procs
          read from cache:  naive-seqs 948   logprobs 1029
                    calcd:         vtb   0        fwd   0
                   merged:       hfrac   0     lratio   0
             min-max time:  0.0 - 0.0 sec
    nothing to merge into /tmp/dralph/hmms/65941/hmm_cached_info.csv
      hmm step time: 0.1
--> 8 clusters with 6 procs
    running 6 procs
          read from cache:  naive-seqs 948   logprobs 1029
                    calcd:         vtb   2        fwd   2
                   merged:       hfrac   0     lratio   2
             min-max time:  0.0 - 0.6 sec
      hmm step time: 0.6
--> 6 clusters with 4 procs
    running 4 procs
          read from cache:  naive-seqs 950   logprobs 1031
                    calcd:         vtb   1        fwd   0
                   merged:       hfrac   2     lratio   0
             min-max time:  0.0 - 0.5 sec
      hmm step time: 0.6
--> 4 clusters with 3 procs
    running 3 procs
          read from cache:  naive-seqs 951   logprobs 1031
                    calcd:         vtb   1        fwd   2
                   merged:       hfrac   0     lratio   1
             min-max time:  0.0 - 0.7 sec
      hmm step time: 0.7
--> 3 clusters with 2 procs
    running 2 procs
          read from cache:  naive-seqs 952   logprobs 1033
                    calcd:         vtb   1        fwd   1
                   merged:       hfrac   0     lratio   1
             min-max time:  0.0 - 0.5 sec
      hmm step time: 0.5
--> 2 clusters with 1 proc
    running 1 proc
          read from cache:  naive-seqs 953   logprobs 1034
                    calcd:         vtb   1        fwd   2
                   merged:       hfrac   0     lratio   1
                     time:  0.6 sec
      hmm step time: 0.6
      loop time: 5.2
--> getting annotations for final partition
    running 1 proc
      hmm step time: 0.4
    read output
        processed 1 hmm output lines with 8 sequences in 1 events  (0 failures)
      total time: 7.1
[92mvsearch-partition-ref-simu[0m       ./bin/partis partition --naive-vsearch --n-max-queries 500 --persistent-cachefname test/new-results/cache-ref-partition.csv --dont-precache-naive-seqs --is-simu --sw-cachefname test/reference-results/test/parameters/simu/sw-cache.csv --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/vsearch-partition-ref-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
        reading sw results from test/reference-results/test/parameters/simu/sw-cache
      info for 500 / 500 = 1.000   (0 failed)
      kept 344 (0.688) unproductive
        water time: 1.1
hmm
       naive hfrac bounds: 0.036 0.036   (0.132 mean mutation in parameter dir test/reference-results/test/parameters/simu/hmm)
        collapsed 500 sequences into 283 unique naive sequences
    using hfrac bound for vsearch 0.036
    running vsearch 22 times (once for each cdr3 length class): . . . . . . . . . . . . . . . . . . . . . . 
      vsearch time: 1.8
--> getting annotations for final partition
    running 10 procs
         infra time: 0.2
      hmm step time: 2.7
    read output
        processed 104 hmm output lines with 500 sequences in 104 events  (0 failures)
      total time: 6.2
[92mcache-parameters-data[0m            ./bin/partis cache-parameters --n-max-total-alleles 10 --n-alleles-per-gene 1 --plotdir test/new-results/test/plots/data --only-csv-plots --only-overall-plots --sw-cachefname test/new-results/test/parameters/data/sw-cache.csv --infname test/mishmash.fa --parameter-dir test/new-results/test/parameters/data --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human
caching parameters
      vsearch: 1412 v annotations in 0.3 sec
    keeping 10 / 239 v genes
smith-waterman 
  removing old sw cache test/new-results/test/parameters/data/sw-cache
        sequences    n_procs     ig-sw time    processing time
            1412       10            0.7           1.8
             310       10            0.2           0.2
             141       10            0.2           0.2
              79        7            0.1           0.1
      info for 1340 / 1412 = 0.949   (72 failed)
      kept 410 (0.290) unproductive
      removed 23 / 1340 = 0.02 duplicate sequences after trimming framework insertions (leaving 1317)
        water time: 4.0
clustering for new alleles
   removing 916/1317 sequences with v_5p or j_3p deletions
   collapsed 401 input sequences into 76 representatives from 232 clones (removed 156 clones with >= 8 j mutations)
   vsearch clustering 76 v segments with threshold 0.07 (*300 = 19)
     read 61 vsearch clusters (76 sequences))
     removed 61 clusters with fewer than 15 sequences
smith-waterman 
        sequences    n_procs     ig-sw time    processing time
            1340       10            0.7           0.9
             238       10            0.2           0.3
              69        6            0.1           0.1
               7        1            0.0           0.0
      info for 1340 / 1412 = 0.949   (72 failed)
      kept 410 (0.290) unproductive
      removed 23 / 1340 = 0.02 duplicate sequences after trimming framework insertions (leaving 1317)
        water time: 2.9
   v mutations:
                    0      1      2      3      4      5      6      7      8      9     10     11     12     13     14     15     16     17     18     19     20     21     22     23
                   33     16     12      3     17     16     17     23     20     11      6      0      1      1      1      0      0      0      0      0      0      0      0      0     [95mh[0m[91mv[0m[95m1[0m[95m-2[0m[93m02[0m
                   65     44     30     22     11     13      9      7      6      7      3      1      0      0      0      0      0      0      0      0      0      0      0      0     [95mh[0m[91mv[0m[95m3[0m[95m-23[0m[93m01[0m
                   14     27     48     23     16     12      6     12      4      6      6      3      0      1      0      0      0      0      0      0      0      0      0      0     [95mh[0m[91mv[0m[95m4[0m[95m-61[0m[93m08[0m
   sequence counts:
                 excluded             excluded                 excluded             included                       actually
              >23 mutations       5p del (>N bases)        3p del (>N bases)       total seqs        clones          used
                     0                0  (251)                 1   (7)                226              142            177      [95mh[0m[91mv[0m[95m1[0m[95m-2[0m[93m02[0m
                     0                0  (259)                 2   (6)                234              197            218      [95mh[0m[91mv[0m[95m3[0m[95m-23[0m[93m01[0m
                     0                0  (259)                 1  (11)                193              178            178      [95mh[0m[91mv[0m[95m4[0m[95m-61[0m[93m08[0m
[94mtry 0[0m: looking for new alleles among 3 genes (7 genes didn't have enough counts)
    plotting allele finding     <only_csv> not yet implemented in allelefinder
    adding new allele to glfo: 
      template CAGGTGCAGCTGCAGGAGTCGGGCCCAGGACTGGTGAAGCCTTCGGAGACCCTGTCCCTCACCTGCACTGTCTCTGGTGGCTCCGTCAGCAGTGGTGGTTACTACTGGAGCTGGATCCGGCAGCCCCCAGGGAAGGGACTGGAGTGGATTGGGTATATCTATTACAGTGGGAGCACCAACTACAACCCCTCCCTCAAGAGTCGAGTCACCATATCAGTAGACACGTCCAAGAACCAGTTCTCCCTGAAGCTGAGCTCTGTGACCGCTGCGGACACGGCCGTGTATTACTGTGCGAGAGA   [95mh[0m[91mv[0m[95m4[0m[95m-61[0m[93m08[0m
           new CAG[91mC[0mTGCAGCTGCAGGAGTC[91mC[0mGGC[91mT[0mCAGGACTGGTGAAGCCTTC[91mA[0m[91mC[0mAGACCCTGTCCCTCACCTGC[91mG[0mCTGTCTCTGGTGGCTCC[91mA[0mTCAGCAGTGGTGGTTACT[91mC[0mCTGGAGCTGGATCCGGCAGCC[91mA[0mCCAGGGAAGGG[91mC[0mCTGGAGTGGATTGGGTA[91mC[0mATCTAT[91mC[0mA[91mT[0mAGTGGGAGCACC[91mT[0mACTACAACCC[91mG[0mTCCCTCAAGAGTCGAGTCACCATATCAGTAGACA[91mG[0mGTCCAAGAACCAGTTCTCCCTGAAGCTGAGCTCTGTGACCGC[91mC[0mGCGGACACGGCCGTGTATTACTGTGC[91mC[0mAGAGA   [95mh[0m[91mv[0m[95m4[0m[95m-30-2[0m[93m01[0m
smith-waterman   (writing parameters) 
        sequences    n_procs     ig-sw time    processing time
            1340       10            0.8           0.7
             238       10            0.2           0.3
              69        6            0.2           0.1
               7        1            0.0           0.0
      info for 1340 / 1412 = 0.949   (72 failed)
      kept 410 (0.290) unproductive
      removed 23 / 1340 = 0.02 duplicate sequences after trimming framework insertions (leaving 1317)
        writing sw results to test/new-results/test/parameters/data/sw-cache
  plotting parameters (1.8 sec)
    writing parameters (0.7 sec)
        water time: 6.9
  writing hmms (2.4 sec)
hmm
    running 10 procs
    read output
  plotting parameters (2.1 sec)
    writing parameters (0.5 sec)
        processed 1317 hmm output lines with 1316 sequences in 1316 events  (1 failures)
            [91mwarning[0m skipped 1 invalid events
         infra time: 6.1
      hmm step time: 10.7
  writing hmms (1.5 sec)
      total time: 32.7
[92msimulate[0m                         ./bin/partis simulate --n-sim-events 500 --n-trees 500 --n-leaves 5 --parameter-dir test/new-results/test/parameters/data --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/test/simu.csv --indel-frequency 0.01 --indel-location v
simulating
   read 499 events from 10 files
      total time: 6.3
[92mcache-parameters-simu[0m            ./bin/partis cache-parameters --n-max-total-alleles 10 --n-alleles-per-gene 1 --plotdir test/new-results/test/plots/simu --only-csv-plots --only-overall-plots --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human
caching parameters
      vsearch: 2593 v annotations in 0.3 sec
    keeping 10 / 239 v genes
smith-waterman 
  removing old sw cache test/new-results/test/parameters/simu/sw-cache
        sequences    n_procs     ig-sw time    processing time
            2593       10            1.3           1.8
             144       10            0.2           0.1
              35        3            0.1           0.1
      info for 2593 / 2593 = 1.000   (0 failed)
      kept 1831 (0.706) unproductive
        water time: 4.3
clustering for new alleles
   removing 5/2593 sequences with v_5p or j_3p deletions
   collapsed 2588 input sequences into 749 representatives from 1614 clones (removed 865 clones with >= 8 j mutations)
   vsearch clustering 749 v segments with threshold 0.06 (*300 = 16)
     read 547 vsearch clusters (749 sequences))
     removed 543 clusters with fewer than 15 sequences
smith-waterman 
        sequences    n_procs     ig-sw time    processing time
            2593       10            1.5           1.8
             144       10            0.2           0.1
              35        3            0.1           0.0
      info for 2593 / 2593 = 1.000   (0 failed)
      kept 1831 (0.706) unproductive
        water time: 4.5
[94mtry 0[0m: looking for new alleles among 0 genes (10 genes didn't have enough counts)
    plotting allele finding     <only_csv> not yet implemented in allelefinder
smith-waterman   (writing parameters) 
        sequences    n_procs     ig-sw time    processing time
            2593       10            1.6           1.5
             144       10            0.2           0.1
              35        3            0.2           0.1
      info for 2593 / 2593 = 1.000   (0 failed)
      kept 1831 (0.706) unproductive
        writing sw results to test/new-results/test/parameters/simu/sw-cache
  plotting parameters (1.7 sec)
  plotting parameters (1.5 sec)
    writing parameters (0.4 sec)
    writing parameters (0.6 sec)
        water time: 12.2
  writing hmms (2.0 sec)
hmm
    running 10 procs
    read output
  plotting parameters (1.4 sec)
    writing parameters (0.6 sec)
  plotting parameters (2.3 sec)
    writing parameters (0.5 sec)
        processed 2593 hmm output lines with 2593 sequences in 2593 events  (0 failures)
         infra time: 11.4
      hmm step time: 16.8
  writing hmms (2.0 sec)
      total time: 45.0
[92mannotate-new-simu[0m                ./bin/partis annotate --plot-performance --plotdir test/new-results/simu-new-performance --only-csv-plots --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/annotate-new-simu.csv
annotating
smith-waterman 
        reading sw results from test/new-results/test/parameters/simu/sw-cache
      info for 2593 / 2593 = 1.000   (0 failed)
      kept 1831 (0.706) unproductive
    3489390720539552177 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    6430515538579299224 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    4436030682607227520 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    2322753960068119352 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -200082834084945136 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7296672363604352806 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -6488612694863678336 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7717424396053052240 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    6861717572680796295 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    7066664948556387754 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    7308197642707743479 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    8663720624590359185 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -3815347006109356531 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.2 sec)
        water time: 6.1
hmm
    running 10 procs
    read output
    6430515538579299224 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7717424396053052240 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    4436030682607227520 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    2322753960068119352 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    7066664948556387754 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -200082834084945136 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    8663720624590359185 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -3815347006109356531 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7296672363604352806 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    7308197642707743479 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    3489390720539552177 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -6488612694863678336 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    6861717572680796295 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.2 sec)
        processed 2593 hmm output lines with 2593 sequences in 2593 events  (0 failures)
         infra time: 8.7
      hmm step time: 13.8
      total time: 21.5
[92mpartition-new-simu[0m               ./bin/partis partition --n-max-queries 500 --n-precache-procs 10 --biggest-logprob-cluster-to-calculate 5 --biggest-naive-seq-cluster-to-calculate 5 --persistent-cachefname test/new-results/cache-new-partition.csv --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/partition-new-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
        reading sw results from test/new-results/test/parameters/simu/sw-cache
      info for 500 / 500 = 1.000   (0 failed)
      kept 355 (0.710) unproductive
        water time: 0.9
hmm
--> caching all 500 naive sequences
    running 10 procs
                no/empty cache file
                    calcd:         vtb 500        fwd   0
                   merged:       hfrac   0     lratio   0
             min-max time:  2.0 - 2.4 sec
         infra time: 0.2
      hmm step time: 2.8
--> 500 clusters with 10 procs
       naive hfrac bounds: 0.015 0.118   (0.131 mean mutation in parameter dir test/new-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 500   logprobs   0
                    calcd:         vtb 110        fwd 362
                   merged:       hfrac 117     lratio  31
             min-max time:  2.3 - 4.5 sec
         infra time: 0.1
      hmm step time: 4.7
--> 352 clusters with 7 procs
    running 7 procs
          read from cache:  naive-seqs 648   logprobs 362
                    calcd:         vtb  67        fwd 169
                   merged:       hfrac  73     lratio  22
             min-max time:  2.2 - 4.6 sec
         infra time: 0.1
      hmm step time: 4.8
--> 257 clusters with 5 procs
    running 5 procs
          read from cache:  naive-seqs 746   logprobs 531
                    calcd:         vtb  40        fwd 114
                   merged:       hfrac  39     lratio  13
             min-max time:  3.0 - 5.7 sec
         infra time: 0.1
      hmm step time: 5.8
--> 205 clusters with 3 procs
    running 3 procs
          read from cache:  naive-seqs 803   logprobs 645
                    calcd:         vtb  34        fwd 100
                   merged:       hfrac  40     lratio  11
             min-max time:  4.7 - 9.3 sec
         infra time: 0.1
      hmm step time: 9.5
--> 154 clusters with 2 procs
    running 2 procs
          read from cache:  naive-seqs 861   logprobs 745
                    calcd:         vtb  25        fwd  86
                   merged:       hfrac  28     lratio   7
             min-max time:  8.1 - 11.0 sec
         infra time: 0.2
      hmm step time: 11.3
--> 119 clusters with 2 procs
    running 2 procs
          read from cache:  naive-seqs 903   logprobs 831
                    calcd:         vtb  10        fwd  40
                   merged:       hfrac   9     lratio   7
             min-max time:  4.6 - 7.6 sec
      hmm step time: 7.8
--> 103 clusters with 2 procs
    running 2 procs
          read from cache:  naive-seqs 923   logprobs 871
                    calcd:         vtb   5        fwd  22
                   merged:       hfrac   7     lratio   0
             min-max time:  3.5 - 3.6 sec
      hmm step time: 3.7
--> 96 clusters with 2 procs
    running 2 procs
          read from cache:  naive-seqs 932   logprobs 893
                    calcd:         vtb   1        fwd   9
                   merged:       hfrac   1     lratio   0
             min-max time:  1.1 - 2.7 sec
      hmm step time: 2.9
--> 95 clusters with 1 proc
    running 1 proc
          read from cache:  naive-seqs 934   logprobs 902
                    calcd:         vtb   3        fwd  67
                   merged:       hfrac   4     lratio   2
                     time:  12.7 sec
      hmm step time: 12.8
      loop time: 63.4
--> getting annotations for final partition
    running 10 procs
      hmm step time: 1.9
    read output
        processed 89 hmm output lines with 500 sequences in 89 events  (0 failures)
      total time: 69.3
[92mseed-partition-new-simu[0m          ./bin/partis partition --n-max-queries 500 --persistent-cachefname test/new-results/cache-new-partition.csv --dont-precache-naive-seqs --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed-unique-id 4730626846417369276 --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/seed-partition-new-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
        reading sw results from test/new-results/test/parameters/simu/sw-cache
      info for 500 / 500 = 1.000   (0 failed)
      kept 355 (0.710) unproductive
      removed 405 / 500 = 0.81 sequences with cdr3 length different from seed sequence (leaving 95)
        water time: 0.9
hmm
--> 95 clusters with 10 procs
       naive hfrac bounds: 0.015 0.118   (0.131 mean mutation in parameter dir test/new-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 943   logprobs 969
                    calcd:         vtb  12        fwd  17
                   merged:       hfrac  15     lratio   1
             min-max time:  0.0 - 1.1 sec
      hmm step time: 1.2
--> 88 clusters with 7 procs
    running 7 procs
          read from cache:  naive-seqs 958   logprobs 986
                    calcd:         vtb   2        fwd  13
                   merged:       hfrac   1     lratio   1
             min-max time:  0.3 - 0.8 sec
      hmm step time: 0.9
--> 85 clusters with 5 procs
    running 5 procs
          read from cache:  naive-seqs 960   logprobs 999
                    calcd:         vtb   1        fwd   7
                   merged:       hfrac   2     lratio   0
             min-max time:  0.0 - 0.8 sec
      hmm step time: 0.9
      removing 78 sequences in unseeded clusters, and splitting 5 seeded clusters into 17 singletons
        new n_procs 1 (initial seqs/proc: 9.50   new seqs/proc: 17.00
--> 17 clusters with 1 proc
    running 1 proc
          read from cache:  naive-seqs 962   logprobs 1006
                    calcd:         vtb   5        fwd  21
                   merged:       hfrac  14     lratio   0
                     time:  3.7 sec
      hmm step time: 3.8
      loop time: 6.7
--> getting annotations for final partition
    running 3 procs
      hmm step time: 1.0
    read output
        processed 3 hmm output lines with 17 sequences in 3 events  (0 failures)
      total time: 9.1
[92mvsearch-partition-new-simu[0m       ./bin/partis partition --naive-vsearch --n-max-queries 500 --persistent-cachefname test/new-results/cache-new-partition.csv --dont-precache-naive-seqs --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/vsearch-partition-new-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
        reading sw results from test/new-results/test/parameters/simu/sw-cache
      info for 500 / 500 = 1.000   (0 failed)
      kept 355 (0.710) unproductive
        water time: 1.4
hmm
       naive hfrac bounds: 0.036 0.036   (0.131 mean mutation in parameter dir test/new-results/test/parameters/simu/hmm)
        collapsed 500 sequences into 301 unique naive sequences
    using hfrac bound for vsearch 0.036
    running vsearch 22 times (once for each cdr3 length class): . . . . . . . . . . . . . . . . . . . . . . 
      vsearch time: 1.6
--> getting annotations for final partition
    running 10 procs
         infra time: 0.2
      hmm step time: 2.5
    read output
        processed 106 hmm output lines with 500 sequences in 106 events  (0 failures)
      total time: 6.1
