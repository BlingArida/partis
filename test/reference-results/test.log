[92mannotate-ref-simu[0m                ./bin/partis run-viterbi --plot-performance --plotdir test/_new-results/simu-ref-performance --only-csv-plots --is-simu --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/_new-results/annotate-ref-simu.csv
running viterbi
smith-waterman 
        reading sw results from test/reference-results/test/parameters/simu/sw-cache-6821554342063078619.csv
    skipping performance evaluation of 3916575519181570240 because of indels
    skipping performance evaluation of 4638537895259520433 because of indels
    skipping performance evaluation of -7829725254102920905 because of indels
    skipping performance evaluation of -1838870529905718504 because of indels
    skipping performance evaluation of -7412937390934044834 because of indels
    skipping performance evaluation of -27065312974377017 because of indels
    skipping performance evaluation of -8932478048782146751 because of indels
    skipping performance evaluation of -1210541606854735754 because of indels
    skipping performance evaluation of -5772736770207164802 because of indels
    skipping performance evaluation of 952627299983456150 because of indels
    skipping performance evaluation of -6777070966356926348 because of indels
    skipping performance evaluation of 3781492018973163354 because of indels
    skipping performance evaluation of 3638221520282597478 because of indels
    skipping performance evaluation of 8134467020097944220 because of indels
    skipping performance evaluation of 2831588768506176459 because of indels
    skipping performance evaluation of -3467588411121338151 because of indels
    skipping performance evaluation of 3312196281651092286 because of indels
    skipping performance evaluation of -1653302207128651255 because of indels
    skipping performance evaluation of -1392219867145143804 because of indels
    skipping performance evaluation of 3210908193554380081 because of indels
    skipping performance evaluation of 5630030942862912796 because of indels
    skipping performance evaluation of -7414965680216621535 because of indels
    skipping performance evaluation of 755479189736510219 because of indels
    skipping performance evaluation of 8090518683811709673 because of indels
    skipping performance evaluation of -6003499180866381899 because of indels
    skipping performance evaluation of -1803779264717789789 because of indels
    skipping performance evaluation of -3947223774054379180 because of indels
      info for 2440 / 2440 = 1.000
      kept 1747 (0.716) unproductive
  plotting performance (0.2 sec)
        water time: 3.7
hmm
    running 10 procs
    read output
    skipping performance evaluation of -3467588411121338151 because of indels
    skipping performance evaluation of 2831588768506176459 because of indels
    skipping performance evaluation of 8134467020097944220 because of indels
    skipping performance evaluation of -3947223774054379180 because of indels
    skipping performance evaluation of -6777070966356926348 because of indels
    skipping performance evaluation of 3916575519181570240 because of indels
    skipping performance evaluation of -6003499180866381899 because of indels
    skipping performance evaluation of -7412937390934044834 because of indels
    skipping performance evaluation of 5630030942862912796 because of indels
    skipping performance evaluation of 3210908193554380081 because of indels
    skipping performance evaluation of -8932478048782146751 because of indels
    skipping performance evaluation of 952627299983456150 because of indels
    skipping performance evaluation of -27065312974377017 because of indels
    skipping performance evaluation of 3781492018973163354 because of indels
    skipping performance evaluation of 3312196281651092286 because of indels
    skipping performance evaluation of 4638537895259520433 because of indels
    skipping performance evaluation of -5772736770207164802 because of indels
    skipping performance evaluation of -1210541606854735754 because of indels
    skipping performance evaluation of -1653302207128651255 because of indels
    skipping performance evaluation of 8090518683811709673 because of indels
    skipping performance evaluation of -1392219867145143804 because of indels
    skipping performance evaluation of -1838870529905718504 because of indels
    skipping performance evaluation of -7414965680216621535 because of indels
    skipping performance evaluation of 3638221520282597478 because of indels
    skipping performance evaluation of -7829725254102920905 because of indels
    skipping performance evaluation of 755479189736510219 because of indels
    skipping performance evaluation of -1803779264717789789 because of indels
  plotting performance (0.1 sec)
        processed 2440 hmm output lines with 2440 sequences in 2440 events
      hmm step time: 11.5
      total time: 16.6
[92mpartition-ref-simu[0m               ./bin/partis partition --n-max-queries 500 --n-precache-procs 10 --biggest-logprob-cluster-to-calculate 5 --biggest-naive-seq-cluster-to-calculate 5 --persistent-cachefname test/_new-results/cache-ref-partition.csv --is-simu --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/_new-results/partition-ref-simu.csv
partitioning
smith-waterman 
        sequences    n_procs     ig-sw time    processing time
             500       10            0.7           0.6
              38        1            0.2           0.0
               1        1            0.0           0.0
      info for 500 / 500 = 1.000
      kept 381 (0.762) unproductive
        water time: 1.6
hmm
--> caching all 500 naive sequences
    running 10 procs
                no/empty cache file
                    calcd:         vtb 500        fwd   0
                   merged:       hfrac   0     lratio   0
             min-max time:  1.9 - 2.2 sec
      hmm step time: 2.6
--> 500 clusters with 10 procs
       naive hfrac bounds: 0.015 0.111   (0.117 mean mutation in parameter dir test/reference-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 500   logprobs   0
                    calcd:         vtb 117        fwd 527
                   merged:       hfrac 111     lratio  54
             min-max time:  2.4 - 9.6 sec
      hmm step time: 9.9
--> 335 clusters with 7 procs
    running 7 procs
          read from cache:  naive-seqs 665   logprobs 527
                    calcd:         vtb  68        fwd 274
                   merged:       hfrac  58     lratio  32
             min-max time:  3.4 - 8.2 sec
      hmm step time: 8.6
--> 245 clusters with 5 procs
    running 5 procs
          read from cache:  naive-seqs 758   logprobs 801
                    calcd:         vtb  34        fwd 134
                   merged:       hfrac  37     lratio  13
             min-max time:  3.8 - 7.1 sec
      hmm step time: 7.4
--> 195 clusters with 3 procs
    running 3 procs
          read from cache:  naive-seqs 813   logprobs 935
                    calcd:         vtb  38        fwd 149
                   merged:       hfrac  39     lratio  13
             min-max time:  6.6 - 11.2 sec
      hmm step time: 11.4
--> 143 clusters with 2 procs
    running 2 procs
          read from cache:  naive-seqs 875   logprobs 1084
                    calcd:         vtb  18        fwd  94
                   merged:       hfrac  19     lratio   6
             min-max time:  7.5 - 11.3 sec
      hmm step time: 11.6
--> 118 clusters with 1 proc
    running 1 proc
          read from cache:  naive-seqs 905   logprobs 1178
                    calcd:         vtb  15        fwd 157
                   merged:       hfrac  18     lratio   8
                     time:  42.1 sec
      hmm step time: 42.4
      loop time: 91.3
--> getting annotations for final partition
    running 10 procs
      hmm step time: 2.9
    read output
        processed 92 hmm output lines with 500 sequences in 92 events
      total time: 99.1
[92mseed-partition-ref-simu[0m          ./bin/partis partition --n-max-queries 500 --persistent-cachefname test/_new-results/cache-ref-partition.csv --dont-precache-naive-seqs --is-simu --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed-unique-id 7545702563878701531 --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/_new-results/seed-partition-ref-simu.csv
partitioning
smith-waterman 
        sequences    n_procs     ig-sw time    processing time
             500       10            0.7           0.2
              38        1            0.4           0.1
               1        1            0.0           0.0
      info for 500 / 500 = 1.000
      kept 381 (0.762) unproductive
      removed 461 / 500 = 0.92 sequences with cdr3 length different from seed sequence (leaving 39)
        water time: 1.5
hmm
--> 39 clusters with 10 procs
       naive hfrac bounds: 0.015 0.111   (0.117 mean mutation in parameter dir test/reference-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 941   logprobs 1335
                    calcd:         vtb   2        fwd   8
                   merged:       hfrac   4     lratio   0
             min-max time:  0.0 - 0.5 sec
      hmm step time: 0.8
--> 44 clusters with 7 procs
    running 7 procs
          read from cache:  naive-seqs 944   logprobs 1341
                    calcd:         vtb   0        fwd   4
                   merged:       hfrac   0     lratio   0
             min-max time:  0.0 - 0.4 sec
      hmm step time: 0.6
--> 41 clusters with 5 procs
    running 5 procs
          read from cache:  naive-seqs 944   logprobs 1345
                    calcd:         vtb   0        fwd   2
                   merged:       hfrac   0     lratio   0
             min-max time:  0.0 - 0.4 sec
      hmm step time: 0.6
      removing 34 sequences in unseeded clusters, and splitting 5 seeded clusters into 5 singletons
        new n_procs 1 (initial seqs/proc: 3.90   new seqs/proc: 5.00
--> 5 clusters with 1 proc
    running 1 proc
          read from cache:  naive-seqs 944   logprobs 1347
                    calcd:         vtb   2        fwd   5
                   merged:       hfrac   4     lratio   0
                     time:  0.4 sec
      hmm step time: 0.5
      loop time: 2.5
--> getting annotations for final partition
    running 1 proc
      hmm step time: 0.3
    read output
        processed 1 hmm output lines with 5 sequences in 1 events
      total time: 4.9
[92mvsearch-partition-ref-simu[0m       ./bin/partis partition --naive-vsearch --n-max-queries 500 --persistent-cachefname test/_new-results/cache-ref-partition.csv --dont-precache-naive-seqs --is-simu --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/_new-results/vsearch-partition-ref-simu.csv
partitioning
smith-waterman 
        sequences    n_procs     ig-sw time    processing time
             500       10            0.7           0.7
              38        1            0.4           0.1
               1        1            0.0           0.0
      info for 500 / 500 = 1.000
      kept 381 (0.762) unproductive
        water time: 2.1
hmm
       naive hfrac bounds: 0.033 0.033   (0.117 mean mutation in parameter dir test/reference-results/test/parameters/simu/hmm)
        collapsed 500 sequences into 310 unique naive sequences
    using hfrac bound for vsearch 0.033
    running vsearch 19 times (once for each cdr3 length class): . . . . . . . . . . . . . . . . . . . 
      vsearch time: 1.9
--> getting annotations for final partition
    running 10 procs
      hmm step time: 2.7
    read output
        processed 115 hmm output lines with 500 sequences in 115 events
      total time: 7.3
[92mcache-parameters-data[0m            ./bin/partis cache-parameters --n-max-total-alleles 10 --n-alleles-per-gene 1 --plotdir test/_new-results/test/plots/data --only-csv-plots --only-overall-plots --infname test/mishmash.fa --parameter-dir test/_new-results/test/parameters/data --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human
caching parameters
smith-waterman   (removing less-likely alleles) 
  removing old sw cache file test/_new-results/test/parameters/data/sw-cache-7465598398907330838.csv
    and test/_new-results/test/parameters/data/sw-cache-7465598398907330838-glfo
        sequences    n_procs     ig-sw time    processing time
            1412       10            5.2           2.1
             291        2            3.5           0.7
              93        1            4.1           0.1
              85        1            2.0           0.1
      info for 1334 / 1412 = 0.945
      kept 406 (0.288) unproductive
    keeping 10 v genes
    removing 277 v genes: 102 with no matches, 175 with unconvincing matches (797 / 1334 queries had their best match removed)
      removed 23 / 1334 = 0.02 duplicate sequences after trimming framework insertions (leaving 1311)
        water time: 18.7
smith-waterman   (writing parameters) 
        sequences    n_procs     ig-sw time    processing time
            1311       10            0.7           1.1
             242        1            0.3           0.3
              67        1            0.6           0.1
              53        1            0.4           0.1
      info for 1266 / 1311 = 0.966
      kept 359 (0.274) unproductive
        writing sw results to test/_new-results/test/parameters/data/sw-cache-7465598398907330838.csv
  plotting parameters (2.3 sec)
    writing parameters (0.5 sec)
        water time: 7.6
  writing hmms (15.8 sec)
hmm
    running 10 procs
    read output
  plotting parameters (1.1 sec)
    writing parameters (0.4 sec)
        processed 1266 hmm output lines with 1264 sequences in 1264 events
            [91mwarning[0m skipped 2 invalid events
      hmm step time: 8.5
  writing hmms (12.0 sec)
      total time: 63.1
[92msimulate[0m                         ./bin/partis simulate --n-sim-events 500 --n-trees 500 --n-leaves 5 --parameter-dir test/_new-results/test/parameters/data --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/_new-results/test/simu.csv
simulating
   read 500 events from 10 files
      total time: 6.6
[92mcache-parameters-simu[0m            ./bin/partis cache-parameters --n-max-total-alleles 10 --n-alleles-per-gene 1 --plotdir test/_new-results/test/plots/simu --only-csv-plots --only-overall-plots --is-simu --infname test/_new-results/test/simu.csv --parameter-dir test/_new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human
caching parameters
smith-waterman   (removing less-likely alleles) 
        sequences    n_procs     ig-sw time    processing time
            2426       10           14.5           5.8
              92        1            4.9           0.2
               8        1            0.6           0.1
      info for 2426 / 2426 = 1.000
      kept 1630 (0.672) unproductive
    keeping 10 v genes
    removing 277 v genes: 255 with no matches, 22 with unconvincing matches (252 / 2426 queries had their best match removed)
        water time: 27.2
smith-waterman   (writing parameters) 
        sequences    n_procs     ig-sw time    processing time
            2426       10            1.3           4.9
              92        1            0.8           0.5
               8        1            0.1           0.1
      info for 2426 / 2426 = 1.000
      kept 1630 (0.672) unproductive
        writing sw results to test/_new-results/test/parameters/simu/sw-cache-1930762267444642798.csv
  plotting parameters (1.3 sec)
  plotting parameters (1.6 sec)
    writing parameters (0.5 sec)
    writing parameters (0.5 sec)
        water time: 13.0
  writing hmms (8.7 sec)
hmm
    running 10 procs
    read output
  plotting parameters (1.1 sec)
    writing parameters (0.3 sec)
  plotting parameters (1.5 sec)
    writing parameters (0.5 sec)
        processed 2426 hmm output lines with 2426 sequences in 2426 events
      hmm step time: 13.3
  writing hmms (11.2 sec)
      total time: 75.0
[92mannotate-new-simu[0m                ./bin/partis run-viterbi --plot-performance --plotdir test/_new-results/simu-new-performance --only-csv-plots --is-simu --infname test/_new-results/test/simu.csv --parameter-dir test/_new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/_new-results/annotate-new-simu.csv
running viterbi
smith-waterman 
        reading sw results from test/_new-results/test/parameters/simu/sw-cache-1930762267444642798.csv
    skipping performance evaluation of -7888304906857033707 because of indels
    skipping performance evaluation of -8243081027310769399 because of indels
    skipping performance evaluation of 8003581797825190918 because of indels
    skipping performance evaluation of -8336812982827930258 because of indels
    skipping performance evaluation of 3032674279606861415 because of indels
    skipping performance evaluation of 1975920950658836647 because of indels
    skipping performance evaluation of 5922461321881824096 because of indels
    skipping performance evaluation of -8979853866764054255 because of indels
      info for 2426 / 2426 = 1.000
      kept 1630 (0.672) unproductive
  plotting performance (0.2 sec)
        water time: 4.6
hmm
    running 10 procs
    read output
    skipping performance evaluation of 3032674279606861415 because of indels
    skipping performance evaluation of -8336812982827930258 because of indels
    skipping performance evaluation of 8003581797825190918 because of indels
    skipping performance evaluation of 5922461321881824096 because of indels
    skipping performance evaluation of -8979853866764054255 because of indels
    skipping performance evaluation of -8243081027310769399 because of indels
    skipping performance evaluation of -7888304906857033707 because of indels
    skipping performance evaluation of 1975920950658836647 because of indels
  plotting performance (0.1 sec)
        processed 2426 hmm output lines with 2426 sequences in 2426 events
      hmm step time: 11.7
      total time: 17.8
[92mpartition-new-simu[0m               ./bin/partis partition --n-max-queries 500 --n-precache-procs 10 --biggest-logprob-cluster-to-calculate 5 --biggest-naive-seq-cluster-to-calculate 5 --persistent-cachefname test/_new-results/cache-new-partition.csv --is-simu --infname test/_new-results/test/simu.csv --parameter-dir test/_new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/_new-results/partition-new-simu.csv
partitioning
smith-waterman 
        sequences    n_procs     ig-sw time    processing time
             500       10            0.7           0.7
               4        1            0.1           0.0
      info for 500 / 500 = 1.000
      kept 328 (0.656) unproductive
        water time: 1.7
hmm
--> caching all 500 naive sequences
    running 10 procs
                no/empty cache file
                    calcd:         vtb 500        fwd   0
                   merged:       hfrac   0     lratio   0
             min-max time:  1.8 - 2.3 sec
      hmm step time: 2.6
--> 500 clusters with 10 procs
       naive hfrac bounds: 0.015 0.110   (0.115 mean mutation in parameter dir test/_new-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 500   logprobs   0
                    calcd:         vtb 119        fwd 579
                   merged:       hfrac 110     lratio  40
             min-max time:  4.2 - 9.1 sec
      hmm step time: 9.5
--> 350 clusters with 7 procs
    running 7 procs
          read from cache:  naive-seqs 650   logprobs 579
                    calcd:         vtb  64        fwd 248
                   merged:       hfrac  66     lratio  20
             min-max time:  3.6 - 9.6 sec
      hmm step time: 9.8
--> 264 clusters with 5 procs
    running 5 procs
          read from cache:  naive-seqs 739   logprobs 827
                    calcd:         vtb  48        fwd 145
                   merged:       hfrac  46     lratio  15
             min-max time:  2.2 - 7.7 sec
      hmm step time: 7.9
--> 203 clusters with 3 procs
    running 3 procs
          read from cache:  naive-seqs 807   logprobs 972
                    calcd:         vtb  36        fwd 121
                   merged:       hfrac  40     lratio   9
             min-max time:  6.3 - 10.8 sec
      hmm step time: 11.0
--> 154 clusters with 2 procs
    running 2 procs
          read from cache:  naive-seqs 864   logprobs 1093
                    calcd:         vtb  21        fwd  78
                   merged:       hfrac  25     lratio   3
             min-max time:  7.5 - 7.8 sec
      hmm step time: 8.0
--> 126 clusters with 1 proc
    running 1 proc
          read from cache:  naive-seqs 899   logprobs 1171
                    calcd:         vtb  18        fwd 132
                   merged:       hfrac  28     lratio   5
                     time:  24.3 sec
      hmm step time: 24.4
      loop time: 70.5
--> getting annotations for final partition
    running 10 procs
      hmm step time: 2.9
    read output
        processed 93 hmm output lines with 500 sequences in 93 events
      total time: 78.7
[92mseed-partition-new-simu[0m          ./bin/partis partition --n-max-queries 500 --persistent-cachefname test/_new-results/cache-new-partition.csv --dont-precache-naive-seqs --is-simu --infname test/_new-results/test/simu.csv --parameter-dir test/_new-results/test/parameters/simu --seed-unique-id 8916811530536526390 --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/_new-results/seed-partition-new-simu.csv
partitioning
smith-waterman 
        sequences    n_procs     ig-sw time    processing time
             500       10            0.7           0.8
               4        1            0.1           0.0
      info for 500 / 500 = 1.000
      kept 328 (0.656) unproductive
      removed 359 / 500 = 0.72 sequences with cdr3 length different from seed sequence (leaving 141)
        water time: 1.6
hmm
--> 141 clusters with 10 procs
       naive hfrac bounds: 0.015 0.110   (0.115 mean mutation in parameter dir test/_new-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 938   logprobs 1303
                    calcd:         vtb   5        fwd  94
                   merged:       hfrac   5     lratio   0
             min-max time:  1.0 - 2.0 sec
      hmm step time: 2.4
--> 145 clusters with 7 procs
    running 7 procs
          read from cache:  naive-seqs 943   logprobs 1397
                    calcd:         vtb   0        fwd  49
                   merged:       hfrac   0     lratio   0
             min-max time:  0.7 - 2.2 sec
      hmm step time: 2.4
--> 142 clusters with 5 procs
    running 5 procs
          read from cache:  naive-seqs 943   logprobs 1446
                    calcd:         vtb   0        fwd  28
                   merged:       hfrac   0     lratio   0
             min-max time:  0.6 - 1.7 sec
      hmm step time: 2.0
      removing 135 sequences in unseeded clusters, and splitting 5 seeded clusters into 6 singletons
        new n_procs 1 (initial seqs/proc: 14.10   new seqs/proc: 6.00
--> 6 clusters with 1 proc
    running 1 proc
          read from cache:  naive-seqs 943   logprobs 1474
                    calcd:         vtb   3        fwd   6
                   merged:       hfrac   5     lratio   0
                     time:  1.5 sec
      hmm step time: 1.6
      loop time: 8.4
--> getting annotations for final partition
    running 1 proc
      hmm step time: 0.6
    read output
        processed 1 hmm output lines with 6 sequences in 1 events
      total time: 11.3
[92mvsearch-partition-new-simu[0m       ./bin/partis partition --naive-vsearch --n-max-queries 500 --persistent-cachefname test/_new-results/cache-new-partition.csv --dont-precache-naive-seqs --is-simu --infname test/_new-results/test/simu.csv --parameter-dir test/_new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/_new-results/vsearch-partition-new-simu.csv
partitioning
smith-waterman 
        sequences    n_procs     ig-sw time    processing time
             500       10            0.6           0.2
               4        1            0.0           0.0
      info for 500 / 500 = 1.000
      kept 328 (0.656) unproductive
        water time: 1.0
hmm
       naive hfrac bounds: 0.033 0.033   (0.115 mean mutation in parameter dir test/_new-results/test/parameters/simu/hmm)
        collapsed 500 sequences into 340 unique naive sequences
    using hfrac bound for vsearch 0.033
    running vsearch 17 times (once for each cdr3 length class): . . . . . . . . . . . . . . . . . 
      vsearch time: 1.6
--> getting annotations for final partition
    running 10 procs
      hmm step time: 2.7
    read output
        processed 109 hmm output lines with 500 sequences in 109 events
      total time: 6.3
