[92mannotate-ref-simu[0m                ./bin/partis annotate --plot-annotation-performance --plotdir test/new-results/annotate-ref-simu-annotation-performance --only-csv-plots --is-simu --sw-cachefname test/reference-results/test/parameters/simu/sw-cache.csv --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/annotate-ref-simu.csv
annotating
smith-waterman 
        reading sw results from test/reference-results/test/parameters/simu/sw-cache
      info for 2593 / 2594 = 1.000   (1 failed)
      kept 1750 (0.675) unproductive
    6631087085765162684 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    5716283203692768398 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -4944602676842877384 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7538163976229077410 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7538163976229077409 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -132447434639868537 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.2 sec)
        water time: 2.6
hmm
    prepare_for_hmm: (0.3 sec)
    running 10 procs
                    calcd:         vtb 2593        fwd    0
             min-max time:  5.9 - 6.3 sec
    read output
    5716283203692768398 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7538163976229077410 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7538163976229077409 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    6631087085765162684 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -4944602676842877384 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -132447434639868537 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.2 sec)
        processed 2593 hmm output lines with 2593 sequences in 2593 events  (0 failures)
         infra time: 4.5
      hmm step time: 11.0
      total time: 14.2
[92mmulti-annotate-ref-simu[0m          ./bin/partis annotate --plot-annotation-performance --simultaneous-true-clonal-seqs --plotdir test/new-results/multi-annotate-ref-simu-annotation-performance --only-csv-plots --is-simu --sw-cachefname test/reference-results/test/parameters/simu/sw-cache.csv --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/multi-annotate-ref-simu.csv
annotating
smith-waterman 
        reading sw results from test/reference-results/test/parameters/simu/sw-cache
      info for 2593 / 2594 = 1.000   (1 failed)
      kept 1750 (0.675) unproductive
    6631087085765162684 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    5716283203692768398 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -4944602676842877384 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7538163976229077410 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7538163976229077409 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -132447434639868537 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.2 sec)
        water time: 2.3
hmm
  [93mwarning[0m split apart 3 clusters that contained multiple cdr3 lengths (total clusters: 462 --> 465)
    prepare_for_hmm: (0.2 sec)
    running 10 procs
                    calcd:         vtb  465        fwd    0
             min-max time:  3.7 - 5.3 sec
    read output
    5716283203692768398 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -132447434639868537 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    6631087085765162684 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -4944602676842877384 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7538163976229077410 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7538163976229077409 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.2 sec)
        processed 465 hmm output lines with 2593 sequences in 465 events  (0 failures)
         infra time: 2.7
      hmm step time: 8.1
      total time: 11.0
[92mpartition-ref-simu[0m               ./bin/partis partition --n-max-queries 500 --n-precache-procs 10 --plot-annotation-performance --biggest-logprob-cluster-to-calculate 5 --biggest-naive-seq-cluster-to-calculate 5 --persistent-cachefname test/new-results/cache-ref-partition.csv --plotdir test/new-results/partition-ref-simu-annotation-performance --only-csv-plots --is-simu --sw-cachefname test/reference-results/test/parameters/simu/sw-cache.csv --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/partition-ref-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
        reading sw results from test/reference-results/test/parameters/simu/sw-cache
      info for 500 / 500 = 1.000   (0 failed)
      kept 367 (0.734) unproductive
    6631087085765162684 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    5716283203692768398 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.2 sec)
        water time: 1.3
hmm
caching all 500 naive sequences
    prepare_for_hmm: (0.1 sec)
    running 10 procs
                no/empty cache file
                    calcd:         vtb 500        fwd   0
                   merged:       hfrac   0     lratio   0
             min-max time:  1.9 - 2.4 sec
      hmm step time: 2.6
   collapsed 500 queries into 308 clusters with identical naive seqs (0.0 sec)
308 clusters with 10 procs
    prepare_for_hmm: (0.0 sec)
       naive hfrac bounds: 0.015 0.109   (0.112 mean mutation in parameter dir test/reference-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 500   logprobs   0
                    calcd:         vtb 119        fwd 178
                   merged:       hfrac 546     lratio  32
             min-max time:  1.4 - 2.8 sec
         infra time: 0.1
      hmm step time: 2.9
256 clusters with 7 procs
    prepare_for_hmm: (0.0 sec)
    running 7 procs
          read from cache:  naive-seqs 626   logprobs 178
                    calcd:         vtb  50        fwd 122
                   merged:       hfrac 510     lratio  24
             min-max time:  1.2 - 3.0 sec
         infra time: 0.1
      hmm step time: 3.2
214 clusters with 5 procs
    prepare_for_hmm: (0.0 sec)
    running 5 procs
          read from cache:  naive-seqs 680   logprobs 300
                    calcd:         vtb  38        fwd  92
                   merged:       hfrac 526     lratio  20
             min-max time:  2.0 - 4.4 sec
         infra time: 0.1
      hmm step time: 4.6
175 clusters with 3 procs
    prepare_for_hmm: (0.0 sec)
    running 3 procs
          read from cache:  naive-seqs 730   logprobs 392
                    calcd:         vtb  29        fwd  75
                   merged:       hfrac 555     lratio  13
             min-max time:  3.2 - 5.1 sec
      hmm step time: 5.2
143 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 769   logprobs 467
                    calcd:         vtb  15        fwd  54
                   merged:       hfrac 517     lratio   7
             min-max time:  3.6 - 5.3 sec
      hmm step time: 5.4
124 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 792   logprobs 521
                    calcd:         vtb  11        fwd  27
                   merged:       hfrac 343     lratio   5
             min-max time:  2.7 - 4.3 sec
      hmm step time: 4.5
111 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 808   logprobs 548
                    calcd:         vtb   8        fwd  13
                   merged:       hfrac 245     lratio   3
             min-max time:  1.3 - 2.0 sec
      hmm step time: 2.1
103 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 819   logprobs 561
                    calcd:         vtb   0        fwd   6
                   merged:       hfrac 202     lratio   0
             min-max time:  0.5 - 0.8 sec
      hmm step time: 0.9
103 clusters with 1 proc
    prepare_for_hmm: (0.0 sec)
    running 1 proc
          read from cache:  naive-seqs 819   logprobs 567
                    calcd:         vtb   3        fwd  67
                   merged:       hfrac 449     lratio   3
                     time:  8.6 sec
      hmm step time: 8.7
      loop time: 37.5
getting annotations for final partition
    prepare_for_hmm: (0.1 sec)
    running 10 procs
                    calcd:         vtb  99        fwd   0
             min-max time:  0.9 - 1.7 sec
      hmm step time: 1.8
    read output
    6631087085765162684 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    5716283203692768398 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.2 sec)
        processed 99 hmm output lines with 500 sequences in 99 events  (0 failures)
  plotting partitions
subclusters
(3.9 sec)
      total time: 47.9
[92mseed-partition-ref-simu[0m          ./bin/partis partition --n-max-queries 500 --persistent-cachefname test/new-results/cache-ref-partition.csv --is-simu --sw-cachefname test/reference-results/test/parameters/simu/sw-cache.csv --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed-unique-id 5791850330088040066 --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/seed-partition-ref-simu.csv
  [91mnote[0m adding --seed-unique-id to empty --queries-to-include
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
        reading sw results from test/reference-results/test/parameters/simu/sw-cache
      info for 500 / 500 = 1.000   (0 failed)
      kept 367 (0.734) unproductive
      removed 492 / 500 = 0.98 sequences with cdr3 length different from seed sequence (leaving 8)
        water time: 0.4
hmm
   collapsed 8 queries into 7 clusters with identical naive seqs (0.0 sec)
7 clusters with 10 procs
    prepare_for_hmm: (0.0 sec)
       naive hfrac bounds: 0.015 0.109   (0.112 mean mutation in parameter dir test/reference-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 825   logprobs 634
                    calcd:         vtb   6        fwd   6
                   merged:       hfrac   6     lratio   6
             min-max time:  0.0 - 0.2 sec
      hmm step time: 0.3
10 clusters with 7 procs
    prepare_for_hmm: (0.0 sec)
    running 7 procs
          read from cache:  naive-seqs 831   logprobs 640
                    calcd:         vtb   0        fwd   0
                   merged:       hfrac   0     lratio   0
             min-max time:  0.0 - 0.0 sec
    nothing to merge into /tmp/dralph/hmms/970933/hmm_cached_info.csv
      hmm step time: 0.1
7 clusters with 5 procs
    prepare_for_hmm: (0.0 sec)
    running 5 procs
          read from cache:  naive-seqs 831   logprobs 640
                    calcd:         vtb   1        fwd   1
                   merged:       hfrac   1     lratio   1
             min-max time:  0.0 - 0.2 sec
      hmm step time: 0.3
      removed 0 sequences in unseeded clusters, split 5 seeded clusters into 8 singletons, and merged these into 7 clusters with identical naive seqs
        new n_procs 7 (initial seqs/proc: 0.80   new seqs/proc: 1.00
7 clusters with 7 procs
    prepare_for_hmm: (0.0 sec)
    running 7 procs
          read from cache:  naive-seqs 832   logprobs 641
                    calcd:         vtb   0        fwd   0
                   merged:       hfrac   0     lratio   0
             min-max time:  0.0 - 0.0 sec
    nothing to merge into /tmp/dralph/hmms/970933/hmm_cached_info.csv
      hmm step time: 0.1
7 clusters with 5 procs
    prepare_for_hmm: (0.0 sec)
    running 5 procs
          read from cache:  naive-seqs 832   logprobs 641
                    calcd:         vtb   1        fwd   1
                   merged:       hfrac   2     lratio   2
             min-max time:  0.0 - 0.2 sec
      hmm step time: 0.2
5 clusters with 3 procs
    prepare_for_hmm: (0.0 sec)
    running 3 procs
          read from cache:  naive-seqs 833   logprobs 642
                    calcd:         vtb   2        fwd   2
                   merged:       hfrac   2     lratio   2
             min-max time:  0.0 - 0.2 sec
      hmm step time: 0.3
3 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 835   logprobs 644
                    calcd:         vtb   1        fwd   1
                   merged:       hfrac   1     lratio   1
             min-max time:  0.0 - 0.3 sec
      hmm step time: 0.4
2 clusters with 1 proc
    prepare_for_hmm: (0.0 sec)
    running 1 proc
          read from cache:  naive-seqs 836   logprobs 645
                    calcd:         vtb   1        fwd   1
                   merged:       hfrac   1     lratio   1
                     time:  0.4 sec
      hmm step time: 0.4
      loop time: 2.0
getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 1 proc
                    calcd:         vtb   1        fwd   0
                     time:  0.3 sec
      hmm step time: 0.3
    read output
        processed 1 hmm output lines with 8 sequences in 1 events  (0 failures)
      total time: 2.9
[92mvsearch-partition-ref-simu[0m       ./bin/partis partition --naive-vsearch --n-max-queries 500 --persistent-cachefname test/new-results/cache-ref-partition.csv --is-simu --sw-cachefname test/reference-results/test/parameters/simu/sw-cache.csv --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/vsearch-partition-ref-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
        reading sw results from test/reference-results/test/parameters/simu/sw-cache
      info for 500 / 500 = 1.000   (0 failed)
      kept 367 (0.734) unproductive
        water time: 0.4
hmm
       naive hfrac bounds: 0.032 0.032   (0.112 mean mutation in parameter dir test/reference-results/test/parameters/simu/hmm)
        collapsed 500 sequences into 308 unique naive sequences
    using hfrac bound for vsearch 0.032
    running vsearch 28 times (once for each cdr3 length class): . . . . . . . . . . . . . . . . . . . . . . . . . . . . 
      vsearch time: 1.3
getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 10 procs
                    calcd:         vtb 120        fwd   0
             min-max time:  1.2 - 1.7 sec
      hmm step time: 1.8
    read output
        processed 120 hmm output lines with 500 sequences in 120 events  (0 failures)
      total time: 3.9
[92mcache-parameters-data[0m            ./bin/partis cache-parameters --plotdir test/new-results/test/plots/data --only-csv-plots --only-overall-plots --sw-cachefname test/new-results/test/parameters/data/sw-cache.csv --infname test/mishmash.fa --parameter-dir test/new-results/test/parameters/data --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human
caching parameters
vsearch: 1273 / 1412 v annotations (139 failed) in 0.1 sec
    keeping 68 / 239 v genes
smith-waterman 
  removing old sw cache test/new-results/test/parameters/data/sw-cache
         step  seqs    procs     ig-sw time    processing time
           1    1412     10        1.2                0.6
           2    301      10        0.3                0.1
           3    119      10        0.2                0.0
           4    72       7         0.1                0.0
      info for 1344 / 1412 = 0.952   (68 failed)
      kept 413 (0.292) unproductive
      removed 23 / 1344 = 0.02 duplicate sequences after trimming framework insertions (leaving 1321)
        water time: 2.6
  no queries for allele finding
[94mtry 0[0m: looking for new alleles among 0 genes (0 genes didn't have enough counts)
    plotting allele finding     <only_csv> not yet implemented in allelefinder
smith-waterman   (writing parameters) 
         step  seqs    procs     ig-sw time    processing time
           1    1344     10        1.1                0.7
           2    233      10        0.2                0.1
           3    51       5         0.1                0.0
           4    4        1         0.0                0.0
      info for 1344 / 1412 = 0.952   (68 failed)
      kept 413 (0.292) unproductive
      removed 23 / 1344 = 0.02 duplicate sequences after trimming framework insertions (leaving 1321)
        writing sw results to test/new-results/test/parameters/data/sw-cache
  plotting parameters (3.0 sec)
    writing parameters (1.2 sec)
        water time: 7.3
  writing hmms (2.1 sec)
hmm
    prepare_for_hmm: (0.1 sec)
    running 10 procs
                    calcd:         vtb 1321        fwd    0
             min-max time:  4.9 - 8.6 sec
    read output
  plotting parameters (2.4 sec)
    writing parameters (1.1 sec)
        processed 1321 hmm output lines with 1320 sequences in 1320 events  (1 failures)
            [91mwarning[0m skipped 1 invalid events
         infra time: 5.3
      hmm step time: 14.0
  writing hmms (1.9 sec)
      total time: 28.9
[92msimulate[0m                         ./bin/partis simulate --n-sim-events 500 --n-trees 500 --n-leaves 5 --parameter-dir test/new-results/test/parameters/data --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/test/simu.csv --indel-frequency 0.01 --indel-location v
simulating
   read 499 events from 10 files
      total time: 5.1
[92mcache-parameters-simu[0m            ./bin/partis cache-parameters --plotdir test/new-results/test/plots/simu --only-csv-plots --only-overall-plots --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human
caching parameters
vsearch: 2530 / 2585 v annotations (55 failed) in 0.2 sec
    keeping 53 / 239 v genes
smith-waterman 
  removing old sw cache test/new-results/test/parameters/simu/sw-cache
         step  seqs    procs     ig-sw time    processing time
           1    2585     10        3.2                1.2
           2    157      10        0.3                0.1
           3    36       3         0.1                0.0
           4    1        1         0.0                0.0
      info for 2585 / 2585 = 1.000   (0 failed)
      kept 1798 (0.696) unproductive
        water time: 5.0
[94mtry 0[0m: looking for new alleles among 0 genes (52 genes didn't have enough counts)
    plotting allele finding     <only_csv> not yet implemented in allelefinder
smith-waterman   (writing parameters) 
         step  seqs    procs     ig-sw time    processing time
           1    2585     10        3.3                1.2
           2    157      10        0.3                0.1
           3    36       3         0.2                0.0
           4    1        1         0.0                0.0
      info for 2585 / 2585 = 1.000   (0 failed)
      kept 1798 (0.696) unproductive
        writing sw results to test/new-results/test/parameters/simu/sw-cache
  plotting parameters (2.9 sec)
    writing parameters (1.3 sec)
        water time: 11.2
  writing hmms (1.8 sec)
hmm
    prepare_for_hmm: (0.3 sec)
    running 10 procs
                    calcd:         vtb 2585        fwd    0
             min-max time:  6.3 - 6.7 sec
    read output
  plotting parameters (2.7 sec)
  plotting parameters (2.7 sec)
    writing parameters (1.3 sec)
    writing parameters (1.0 sec)
        processed 2585 hmm output lines with 2585 sequences in 2585 events  (0 failures)
         infra time: 13.3
      hmm step time: 20.1
  writing hmms (2.0 sec)
      total time: 42.4
[92mannotate-new-simu[0m                ./bin/partis annotate --plot-annotation-performance --plotdir test/new-results/annotate-new-simu-annotation-performance --only-csv-plots --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/annotate-new-simu.csv
annotating
smith-waterman 
        reading sw results from test/new-results/test/parameters/simu/sw-cache
      info for 2585 / 2585 = 1.000   (0 failed)
      kept 1798 (0.696) unproductive
    2173706262152075878 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -4100183686560505839 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    567944520367113420 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    1027204433292299981 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    5716283203692768398 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    1535023322816969525 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    9074081854831124830 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7538163976229077410 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7538163976229077409 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -132447434639868537 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -845657749480897234 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -3749292409839134886 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -6180585439470181633 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.2 sec)
        water time: 2.5
hmm
    prepare_for_hmm: (0.3 sec)
    running 10 procs
                    calcd:         vtb 2585        fwd    0
             min-max time:  6.2 - 6.6 sec
    read output
    -4100183686560505839 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -6180585439470181633 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    567944520367113420 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    5716283203692768398 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    9074081854831124830 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7538163976229077410 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -845657749480897234 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    1027204433292299981 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7538163976229077409 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -3749292409839134886 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    1535023322816969525 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    2173706262152075878 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -132447434639868537 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.2 sec)
        processed 2585 hmm output lines with 2585 sequences in 2585 events  (0 failures)
         infra time: 4.5
      hmm step time: 11.3
      total time: 14.4
[92mmulti-annotate-new-simu[0m          ./bin/partis annotate --plot-annotation-performance --simultaneous-true-clonal-seqs --plotdir test/new-results/multi-annotate-new-simu-annotation-performance --only-csv-plots --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/multi-annotate-new-simu.csv
annotating
smith-waterman 
        reading sw results from test/new-results/test/parameters/simu/sw-cache
      info for 2585 / 2585 = 1.000   (0 failed)
      kept 1798 (0.696) unproductive
    2173706262152075878 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -4100183686560505839 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    567944520367113420 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    1027204433292299981 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    5716283203692768398 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    1535023322816969525 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    9074081854831124830 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7538163976229077410 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7538163976229077409 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -132447434639868537 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -845657749480897234 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -3749292409839134886 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -6180585439470181633 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.2 sec)
        water time: 2.3
hmm
  [93mwarning[0m split apart 8 clusters that contained multiple cdr3 lengths (total clusters: 458 --> 467)
    prepare_for_hmm: (0.2 sec)
    running 10 procs
                    calcd:         vtb  467        fwd    0
             min-max time:  3.9 - 5.8 sec
    read output
    5716283203692768398 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    9074081854831124830 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    1027204433292299981 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -6180585439470181633 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -4100183686560505839 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    2173706262152075878 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    567944520367113420 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -3749292409839134886 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7538163976229077410 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7538163976229077409 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -845657749480897234 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    1535023322816969525 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -132447434639868537 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.2 sec)
        processed 467 hmm output lines with 2585 sequences in 467 events  (0 failures)
         infra time: 2.7
      hmm step time: 8.6
      total time: 11.5
[92mpartition-new-simu[0m               ./bin/partis partition --n-max-queries 500 --n-precache-procs 10 --plot-annotation-performance --biggest-logprob-cluster-to-calculate 5 --biggest-naive-seq-cluster-to-calculate 5 --persistent-cachefname test/new-results/cache-new-partition.csv --plotdir test/new-results/partition-new-simu-annotation-performance --only-csv-plots --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/partition-new-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
        reading sw results from test/new-results/test/parameters/simu/sw-cache
      info for 500 / 500 = 1.000   (0 failed)
      kept 371 (0.742) unproductive
    2173706262152075878 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -4100183686560505839 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    567944520367113420 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    1027204433292299981 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    5716283203692768398 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.2 sec)
        water time: 1.2
hmm
caching all 500 naive sequences
    prepare_for_hmm: (0.1 sec)
    running 10 procs
                no/empty cache file
                    calcd:         vtb 500        fwd   0
                   merged:       hfrac   0     lratio   0
             min-max time:  2.0 - 2.3 sec
      hmm step time: 2.5
   collapsed 500 queries into 309 clusters with identical naive seqs (0.0 sec)
309 clusters with 10 procs
    prepare_for_hmm: (0.0 sec)
       naive hfrac bounds: 0.015 0.110   (0.114 mean mutation in parameter dir test/new-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 500   logprobs   0
                    calcd:         vtb 121        fwd 216
                   merged:       hfrac 566     lratio  41
             min-max time:  1.8 - 4.1 sec
         infra time: 0.1
      hmm step time: 4.3
245 clusters with 7 procs
    prepare_for_hmm: (0.0 sec)
    running 7 procs
          read from cache:  naive-seqs 631   logprobs 216
                    calcd:         vtb  46        fwd 116
                   merged:       hfrac 497     lratio  23
             min-max time:  1.4 - 6.0 sec
      hmm step time: 6.2
202 clusters with 5 procs
    prepare_for_hmm: (0.0 sec)
    running 5 procs
          read from cache:  naive-seqs 685   logprobs 332
                    calcd:         vtb  31        fwd  62
                   merged:       hfrac 410     lratio  14
             min-max time:  1.3 - 3.6 sec
      hmm step time: 3.7
172 clusters with 3 procs
    prepare_for_hmm: (0.0 sec)
    running 3 procs
          read from cache:  naive-seqs 724   logprobs 394
                    calcd:         vtb  30        fwd  66
                   merged:       hfrac 484     lratio  12
             min-max time:  3.7 - 5.7 sec
      hmm step time: 5.8
138 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 765   logprobs 460
                    calcd:         vtb  22        fwd  49
                   merged:       hfrac 510     lratio   7
             min-max time:  5.7 - 6.2 sec
      hmm step time: 6.3
112 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 799   logprobs 509
                    calcd:         vtb   7        fwd  22
                   merged:       hfrac 286     lratio   1
             min-max time:  1.2 - 2.1 sec
      hmm step time: 2.2
101 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 813   logprobs 531
                    calcd:         vtb   5        fwd  19
                   merged:       hfrac 195     lratio   3
             min-max time:  1.6 - 2.4 sec
      hmm step time: 2.6
97 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 818   logprobs 550
                    calcd:         vtb   1        fwd   7
                   merged:       hfrac 171     lratio   1
             min-max time:  0.7 - 0.7 sec
      hmm step time: 0.9
96 clusters with 1 proc
    prepare_for_hmm: (0.0 sec)
    running 1 proc
          read from cache:  naive-seqs 819   logprobs 557
                    calcd:         vtb   0        fwd  53
                   merged:       hfrac 343     lratio   0
                     time:  6.7 sec
      hmm step time: 6.9
      loop time: 38.9
getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 10 procs
                    calcd:         vtb  96        fwd   0
             min-max time:  1.0 - 1.9 sec
      hmm step time: 2.0
    read output
    5716283203692768398 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    1027204433292299981 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    567944520367113420 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    2173706262152075878 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -4100183686560505839 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.2 sec)
        processed 96 hmm output lines with 500 sequences in 96 events  (0 failures)
  plotting partitions
subclusters
(4.1 sec)
      total time: 49.5
[92mseed-partition-new-simu[0m          ./bin/partis partition --n-max-queries 500 --persistent-cachefname test/new-results/cache-new-partition.csv --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed-unique-id 3010205122972849674 --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/seed-partition-new-simu.csv
  [91mnote[0m adding --seed-unique-id to empty --queries-to-include
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
        reading sw results from test/new-results/test/parameters/simu/sw-cache
      info for 500 / 500 = 1.000   (0 failed)
      kept 371 (0.742) unproductive
      removed 453 / 500 = 0.91 sequences with cdr3 length different from seed sequence (leaving 47)
        water time: 0.4
hmm
   collapsed 47 queries into 39 clusters with identical naive seqs (0.0 sec)
39 clusters with 10 procs
    prepare_for_hmm: (0.0 sec)
       naive hfrac bounds: 0.015 0.110   (0.114 mean mutation in parameter dir test/new-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 819   logprobs 610
                    calcd:         vtb  16        fwd   8
                   merged:       hfrac  46     lratio   2
             min-max time:  0.1 - 0.6 sec
      hmm step time: 0.6
45 clusters with 7 procs
    prepare_for_hmm: (0.0 sec)
    running 7 procs
          read from cache:  naive-seqs 826   logprobs 616
                    calcd:         vtb   0        fwd   2
                   merged:       hfrac  35     lratio   0
             min-max time:  0.0 - 0.3 sec
      hmm step time: 0.4
42 clusters with 5 procs
    prepare_for_hmm: (0.0 sec)
    running 5 procs
          read from cache:  naive-seqs 826   logprobs 618
                    calcd:         vtb   0        fwd   2
                   merged:       hfrac  35     lratio   0
             min-max time:  0.0 - 0.5 sec
      hmm step time: 0.5
      removed 40 sequences in unseeded clusters, split 5 seeded clusters into 7 singletons, and merged these into 4 clusters with identical naive seqs
        new n_procs 1 (initial seqs/proc: 4.70   new seqs/proc: 4.00
4 clusters with 1 proc
    prepare_for_hmm: (0.0 sec)
    running 1 proc
          read from cache:  naive-seqs 826   logprobs 620
                    calcd:         vtb   4        fwd   7
                   merged:       hfrac   9     lratio   2
                     time:  0.5 sec
      hmm step time: 0.6
      loop time: 2.1
getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 1 proc
                    calcd:         vtb   1        fwd   0
                     time:  0.1 sec
      hmm step time: 0.2
    read output
        processed 1 hmm output lines with 7 sequences in 1 events  (0 failures)
      total time: 2.8
[92mvsearch-partition-new-simu[0m       ./bin/partis partition --naive-vsearch --n-max-queries 500 --persistent-cachefname test/new-results/cache-new-partition.csv --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/vsearch-partition-new-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
        reading sw results from test/new-results/test/parameters/simu/sw-cache
      info for 500 / 500 = 1.000   (0 failed)
      kept 371 (0.742) unproductive
        water time: 0.4
hmm
       naive hfrac bounds: 0.033 0.033   (0.114 mean mutation in parameter dir test/new-results/test/parameters/simu/hmm)
        collapsed 500 sequences into 309 unique naive sequences
    using hfrac bound for vsearch 0.033
    running vsearch 24 times (once for each cdr3 length class): . . . . . . . . . . . . . . . . . . . . . . . . 
      vsearch time: 1.1
getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 10 procs
                    calcd:         vtb 135        fwd   0
             min-max time:  1.1 - 1.9 sec
      hmm step time: 2.0
    read output
        processed 135 hmm output lines with 500 sequences in 135 events  (0 failures)
      total time: 3.8
