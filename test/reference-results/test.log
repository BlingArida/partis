[92mannotate-ref-simu[0m                ./bin/partis annotate --plot-performance --plotdir test/new-results/simu-ref-performance --only-csv-plots --is-simu --sw-cachefname test/reference-results/test/parameters/simu/sw-cache.csv --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/annotate-ref-simu.csv
annotating
smith-waterman 
        reading sw results from test/reference-results/test/parameters/simu/sw-cache
      info for 2593 / 2593 = 1.000   (0 failed)
      kept 1831 (0.706) unproductive
    6430515538579299224 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    4436030682607227520 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7717424396053052240 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -200082834084945136 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -3815347006109356531 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7296672363604352806 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    8663720624590359185 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    2322753960068119352 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    7308197642707743479 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    6861717572680796295 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    7066664948556387754 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    3489390720539552177 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -6488612694863678336 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.2 sec)
        water time: 3.1
hmm
    prepare_for_hmm: (0.7 sec)
    running 10 procs
    read output
    6430515538579299224 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7717424396053052240 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    4436030682607227520 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    2322753960068119352 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    7066664948556387754 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -200082834084945136 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    8663720624590359185 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -3815347006109356531 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7296672363604352806 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    7308197642707743479 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    3489390720539552177 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -6488612694863678336 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    6861717572680796295 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.1 sec)
        processed 2593 hmm output lines with 2593 sequences in 2593 events  (0 failures)
         infra time: 6.0
      hmm step time: 10.9
      total time: 15.2
[92mpartition-ref-simu[0m               ./bin/partis partition --n-max-queries 500 --n-precache-procs 10 --biggest-logprob-cluster-to-calculate 5 --biggest-naive-seq-cluster-to-calculate 5 --persistent-cachefname test/new-results/cache-ref-partition.csv --is-simu --sw-cachefname test/reference-results/test/parameters/simu/sw-cache.csv --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/partition-ref-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
        reading sw results from test/reference-results/test/parameters/simu/sw-cache
      info for 500 / 500 = 1.000   (0 failed)
      kept 355 (0.710) unproductive
        water time: 0.8
hmm
--> caching all 500 naive sequences
    prepare_for_hmm: (0.1 sec)
    running 10 procs
                no/empty cache file
                    calcd:         vtb 500        fwd   0
                   merged:       hfrac   0     lratio   0
             min-max time:  1.7 - 2.0 sec
      hmm step time: 2.1
--> 500 clusters with 10 procs
    prepare_for_hmm: (0.1 sec)
       naive hfrac bounds: 0.015 0.118   (0.131 mean mutation in parameter dir test/reference-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 500   logprobs   0
                    calcd:         vtb 115        fwd 328
                   merged:       hfrac 134     lratio  30
             min-max time:  2.5 - 4.9 sec
         infra time: 0.2
      hmm step time: 5.1
--> 336 clusters with 7 procs
    prepare_for_hmm: (0.2 sec)
    running 7 procs
          read from cache:  naive-seqs 664   logprobs 328
                    calcd:         vtb  65        fwd 197
                   merged:       hfrac  56     lratio  27
             min-max time:  3.0 - 4.7 sec
         infra time: 0.3
      hmm step time: 5.1
--> 253 clusters with 5 procs
    prepare_for_hmm: (0.1 sec)
    running 5 procs
          read from cache:  naive-seqs 750   logprobs 525
                    calcd:         vtb  38        fwd 103
                   merged:       hfrac  47     lratio  13
             min-max time:  2.6 - 3.8 sec
         infra time: 0.1
      hmm step time: 4.0
--> 193 clusters with 3 procs
    prepare_for_hmm: (0.1 sec)
    running 3 procs
          read from cache:  naive-seqs 816   logprobs 628
                    calcd:         vtb  30        fwd  83
                   merged:       hfrac  43     lratio   8
             min-max time:  3.2 - 5.9 sec
      hmm step time: 6.0
--> 142 clusters with 2 procs
    prepare_for_hmm: (0.1 sec)
    running 2 procs
          read from cache:  naive-seqs 874   logprobs 711
                    calcd:         vtb  16        fwd  72
                   merged:       hfrac  18     lratio   6
             min-max time:  5.3 - 7.5 sec
         infra time: 0.1
      hmm step time: 7.7
--> 118 clusters with 2 procs
    prepare_for_hmm: (0.2 sec)
    running 2 procs
          read from cache:  naive-seqs 902   logprobs 783
                    calcd:         vtb   9        fwd  40
                   merged:       hfrac  12     lratio   4
             min-max time:  5.0 - 5.8 sec
         infra time: 0.2
      hmm step time: 6.1
--> 102 clusters with 2 procs
    prepare_for_hmm: (0.1 sec)
    running 2 procs
          read from cache:  naive-seqs 924   logprobs 823
                    calcd:         vtb   4        fwd  11
                   merged:       hfrac   7     lratio   1
             min-max time:  2.2 - 2.2 sec
      hmm step time: 2.4
--> 94 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 933   logprobs 834
                    calcd:         vtb   1        fwd  14
                   merged:       hfrac   2     lratio   1
             min-max time:  1.8 - 1.9 sec
      hmm step time: 2.0
--> 91 clusters with 1 proc
    prepare_for_hmm: (0.0 sec)
    running 1 proc
          read from cache:  naive-seqs 937   logprobs 848
                    calcd:         vtb   1        fwd  58
                   merged:       hfrac   0     lratio   1
                     time:  10.4 sec
      hmm step time: 10.5
      loop time: 48.9
--> getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 10 procs
      hmm step time: 2.2
    read output
        processed 90 hmm output lines with 500 sequences in 90 events  (0 failures)
      total time: 54.3
[92mseed-partition-ref-simu[0m          ./bin/partis partition --n-max-queries 500 --persistent-cachefname test/new-results/cache-ref-partition.csv --dont-precache-naive-seqs --is-simu --sw-cachefname test/reference-results/test/parameters/simu/sw-cache.csv --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed-unique-id 4730626846417369276 --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/seed-partition-ref-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
        reading sw results from test/reference-results/test/parameters/simu/sw-cache
      info for 500 / 500 = 1.000   (0 failed)
      kept 355 (0.710) unproductive
      removed 405 / 500 = 0.81 sequences with cdr3 length different from seed sequence (leaving 95)
        water time: 1.1
hmm
--> 95 clusters with 10 procs
    prepare_for_hmm: (0.0 sec)
       naive hfrac bounds: 0.015 0.118   (0.131 mean mutation in parameter dir test/reference-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 938   logprobs 906
                    calcd:         vtb  13        fwd  21
                   merged:       hfrac  15     lratio   0
             min-max time:  0.3 - 1.2 sec
         infra time: 0.1
      hmm step time: 1.4
--> 89 clusters with 7 procs
    prepare_for_hmm: (0.0 sec)
    running 7 procs
          read from cache:  naive-seqs 953   logprobs 926
                    calcd:         vtb   1        fwd  15
                   merged:       hfrac   1     lratio   0
             min-max time:  0.0 - 1.3 sec
      hmm step time: 1.4
--> 87 clusters with 5 procs
    prepare_for_hmm: (0.0 sec)
    running 5 procs
          read from cache:  naive-seqs 954   logprobs 941
                    calcd:         vtb   1        fwd   9
                   merged:       hfrac   3     lratio   0
             min-max time:  0.0 - 1.2 sec
      hmm step time: 1.3
      removing 79 sequences in unseeded clusters, and splitting 5 seeded clusters into 16 singletons
        new n_procs 1 (initial seqs/proc: 9.50   new seqs/proc: 16.00
--> 16 clusters with 1 proc
    prepare_for_hmm: (0.0 sec)
    running 1 proc
          read from cache:  naive-seqs 957   logprobs 950
                    calcd:         vtb   5        fwd  17
                   merged:       hfrac  14     lratio   0
                     time:  4.4 sec
      hmm step time: 4.5
      loop time: 8.5
--> getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 2 procs
      hmm step time: 1.0
    read output
        processed 2 hmm output lines with 16 sequences in 2 events  (0 failures)
      total time: 11.1
[92mvsearch-partition-ref-simu[0m       ./bin/partis partition --naive-vsearch --n-max-queries 500 --persistent-cachefname test/new-results/cache-ref-partition.csv --dont-precache-naive-seqs --is-simu --sw-cachefname test/reference-results/test/parameters/simu/sw-cache.csv --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/vsearch-partition-ref-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
        reading sw results from test/reference-results/test/parameters/simu/sw-cache
      info for 500 / 500 = 1.000   (0 failed)
      kept 355 (0.710) unproductive
        water time: 1.1
hmm
       naive hfrac bounds: 0.036 0.036   (0.131 mean mutation in parameter dir test/reference-results/test/parameters/simu/hmm)
        collapsed 500 sequences into 301 unique naive sequences
    using hfrac bound for vsearch 0.036
    running vsearch 22 times (once for each cdr3 length class): . . . . . . . . . . . . . . . . . . . . . . 
      vsearch time: 1.8
--> getting annotations for final partition
    prepare_for_hmm: (0.2 sec)
    running 10 procs
         infra time: 0.2
      hmm step time: 2.5
    read output
        processed 106 hmm output lines with 500 sequences in 106 events  (0 failures)
      total time: 5.9
[92mcache-parameters-data[0m            ./bin/partis cache-parameters --n-max-total-alleles 10 --n-alleles-per-gene 1 --plotdir test/new-results/test/plots/data --only-csv-plots --only-overall-plots --sw-cachefname test/new-results/test/parameters/data/sw-cache.csv --infname test/mishmash.fa --parameter-dir test/new-results/test/parameters/data --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human
caching parameters
      vsearch: 1412 v annotations in 0.3 sec
    keeping 10 / 239 v genes
smith-waterman 
        sequences    n_procs     ig-sw time    processing time
            1412       10            0.7           0.6
             310       10            0.2           0.5
             141       10            0.2           0.2
              79        7            0.1           0.1
      info for 1340 / 1412 = 0.949   (72 failed)
      kept 410 (0.290) unproductive
      removed 23 / 1340 = 0.02 duplicate sequences after trimming framework insertions (leaving 1317)
        water time: 2.7
clustering for new alleles
   removing 916/1317 sequences with v_5p or j_3p deletions
   collapsed 401 input sequences into 76 representatives from 232 clones (removed 156 clones with >= 8 j mutations)
   vsearch clustering 76 v segments with threshold 0.07 (*300 = 19)
     read 61 vsearch clusters (76 sequences))
     removed 61 clusters with fewer than 15 sequences
smith-waterman 
        sequences    n_procs     ig-sw time    processing time
            1340       10            0.7           0.6
             238       10            0.2           0.3
              69        6            0.1           0.1
               7        1            0.0           0.0
      info for 1340 / 1412 = 0.949   (72 failed)
      kept 410 (0.290) unproductive
      removed 23 / 1340 = 0.02 duplicate sequences after trimming framework insertions (leaving 1317)
        water time: 2.2
   v mutations:
                    0      1      2      3      4      5      6      7      8      9     10     11     12     13     14     15     16     17     18     19     20     21     22     23
                   33     16     12      3     17     16     17     23     20     11      6      0      1      1      1      0      0      0      0      0      0      0      0      0     [95mh[0m[91mv[0m[95m1[0m[95m-2[0m[93m02[0m
                   65     44     30     22     11     13      9      7      6      7      3      1      0      0      0      0      0      0      0      0      0      0      0      0     [95mh[0m[91mv[0m[95m3[0m[95m-23[0m[93m01[0m
                   14     27     48     23     16     12      6     12      4      6      6      3      0      1      0      0      0      0      0      0      0      0      0      0     [95mh[0m[91mv[0m[95m4[0m[95m-61[0m[93m08[0m
   sequence counts:
                 excluded             excluded                 excluded             included                       actually
              >23 mutations       5p del (>N bases)        3p del (>N bases)       total seqs        clones          used
                     0                0  (251)                 1   (7)                226              142            177      [95mh[0m[91mv[0m[95m1[0m[95m-2[0m[93m02[0m
                     0                0  (259)                 2   (6)                234              197            218      [95mh[0m[91mv[0m[95m3[0m[95m-23[0m[93m01[0m
                     0                0  (259)                 1  (11)                193              178            178      [95mh[0m[91mv[0m[95m4[0m[95m-61[0m[93m08[0m
[94mtry 0[0m: looking for new alleles among 3 genes (7 genes didn't have enough counts)
    plotting allele finding     <only_csv> not yet implemented in allelefinder
    adding new allele to glfo: 
      template CAGGTGCAGCTGCAGGAGTCGGGCCCAGGACTGGTGAAGCCTTCGGAGACCCTGTCCCTCACCTGCACTGTCTCTGGTGGCTCCGTCAGCAGTGGTGGTTACTACTGGAGCTGGATCCGGCAGCCCCCAGGGAAGGGACTGGAGTGGATTGGGTATATCTATTACAGTGGGAGCACCAACTACAACCCCTCCCTCAAGAGTCGAGTCACCATATCAGTAGACACGTCCAAGAACCAGTTCTCCCTGAAGCTGAGCTCTGTGACCGCTGCGGACACGGCCGTGTATTACTGTGCGAGAGA   [95mh[0m[91mv[0m[95m4[0m[95m-61[0m[93m08[0m
           new CAG[91mC[0mTGCAGCTGCAGGAGTC[91mC[0mGGC[91mT[0mCAGGACTGGTGAAGCCTTC[91mA[0m[91mC[0mAGACCCTGTCCCTCACCTGC[91mG[0mCTGTCTCTGGTGGCTCC[91mA[0mTCAGCAGTGGTGGTTACT[91mC[0mCTGGAGCTGGATCCGGCAGCC[91mA[0mCCAGGGAAGGG[91mC[0mCTGGAGTGGATTGGGTA[91mC[0mATCTAT[91mC[0mA[91mT[0mAGTGGGAGCACC[91mT[0mACTACAACCC[91mG[0mTCCCTCAAGAGTCGAGTCACCATATCAGTAGACA[91mG[0mGTCCAAGAACCAGTTCTCCCTGAAGCTGAGCTCTGTGACCGC[91mC[0mGCGGACACGGCCGTGTATTACTGTGC[91mC[0mAGAGA   [95mh[0m[91mv[0m[95m4[0m[95m-30-2[0m[93m01[0m
smith-waterman   (writing parameters) 
        sequences    n_procs     ig-sw time    processing time
            1340       10            0.8           0.6
             238       10            0.2           0.1
              69        6            0.2           0.1
               7        1            0.0           0.0
      info for 1340 / 1412 = 0.949   (72 failed)
      kept 410 (0.290) unproductive
      removed 23 / 1340 = 0.02 duplicate sequences after trimming framework insertions (leaving 1317)
        writing sw results to test/new-results/test/parameters/data/sw-cache
  plotting parameters (1.3 sec)
    writing parameters (0.5 sec)
        water time: 5.1
  writing hmms (1.6 sec)
hmm
    prepare_for_hmm: (0.3 sec)
    running 10 procs
    read output
  plotting parameters (1.5 sec)
    writing parameters (0.5 sec)
        processed 1317 hmm output lines with 1316 sequences in 1316 events  (1 failures)
            [91mwarning[0m skipped 1 invalid events
         infra time: 4.4
      hmm step time: 8.6
  writing hmms (1.8 sec)
      total time: 25.9
[92msimulate[0m                         ./bin/partis simulate --n-sim-events 500 --n-trees 500 --n-leaves 5 --parameter-dir test/new-results/test/parameters/data --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/test/simu.csv --indel-frequency 0.01 --indel-location v
simulating
   read 499 events from 10 files
      total time: 6.3
[92mcache-parameters-simu[0m            ./bin/partis cache-parameters --n-max-total-alleles 10 --n-alleles-per-gene 1 --plotdir test/new-results/test/plots/simu --only-csv-plots --only-overall-plots --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human
caching parameters
      vsearch: 2565 v annotations in 0.5 sec
    keeping 10 / 239 v genes
smith-waterman 
        sequences    n_procs     ig-sw time    processing time
            2565       10            1.3           2.2
             147       10            0.2           0.2
              27        2            0.2           0.0
      info for 2565 / 2565 = 1.000   (0 failed)
      kept 1841 (0.718) unproductive
        water time: 4.4
clustering for new alleles
   removing 10/2565 sequences with v_5p or j_3p deletions
   collapsed 2555 input sequences into 767 representatives from 1574 clones (removed 807 clones with >= 8 j mutations)
   vsearch clustering 767 v segments with threshold 0.06 (*300 = 16)
     read 582 vsearch clusters (767 sequences))
     removed 580 clusters with fewer than 15 sequences
smith-waterman 
        sequences    n_procs     ig-sw time    processing time
            2565       10            1.5           1.7
             147       10            0.2           0.1
              27        2            0.2           0.0
      info for 2565 / 2565 = 1.000   (0 failed)
      kept 1841 (0.718) unproductive
        water time: 3.8
[94mtry 0[0m: looking for new alleles among 0 genes (10 genes didn't have enough counts)
    plotting allele finding     <only_csv> not yet implemented in allelefinder
smith-waterman   (writing parameters) 
        sequences    n_procs     ig-sw time    processing time
            2565       10            1.6           1.8
             147       10            0.2           0.2
              27        2            0.2           0.0
      info for 2565 / 2565 = 1.000   (0 failed)
      kept 1841 (0.718) unproductive
        writing sw results to test/new-results/test/parameters/simu/sw-cache
  plotting parameters (2.3 sec)
  plotting parameters (2.3 sec)
    writing parameters (0.6 sec)
    writing parameters (0.5 sec)
        water time: 15.0
  writing hmms (2.2 sec)
hmm
    prepare_for_hmm: (0.4 sec)
    running 10 procs
    read output
  plotting parameters (1.4 sec)
    writing parameters (0.3 sec)
  plotting parameters (1.9 sec)
    writing parameters (0.3 sec)
        processed 2565 hmm output lines with 2565 sequences in 2565 events  (0 failures)
         infra time: 11.4
      hmm step time: 16.5
  writing hmms (2.0 sec)
      total time: 48.9
[92mannotate-new-simu[0m                ./bin/partis annotate --plot-performance --plotdir test/new-results/simu-new-performance --only-csv-plots --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/annotate-new-simu.csv
annotating
smith-waterman 
        reading sw results from test/new-results/test/parameters/simu/sw-cache
      info for 2565 / 2565 = 1.000   (0 failed)
      kept 1841 (0.718) unproductive
    -8779363031767956918 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    8677969937465515487 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    6430515538579299224 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -5422592684311840849 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -2088714085557064999 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    6516197854203714194 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -9206819174273927587 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    3496672581503714735 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.2 sec)
        water time: 4.8
hmm
    prepare_for_hmm: (0.8 sec)
    running 10 procs
    read output
    6516197854203714194 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -5422592684311840849 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -8779363031767956918 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    3496672581503714735 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    8677969937465515487 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    6430515538579299224 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -2088714085557064999 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -9206819174273927587 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.1 sec)
        processed 2565 hmm output lines with 2565 sequences in 2565 events  (0 failures)
         infra time: 5.7
      hmm step time: 10.9
      total time: 17.4
[92mpartition-new-simu[0m               ./bin/partis partition --n-max-queries 500 --n-precache-procs 10 --biggest-logprob-cluster-to-calculate 5 --biggest-naive-seq-cluster-to-calculate 5 --persistent-cachefname test/new-results/cache-new-partition.csv --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/partition-new-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
        reading sw results from test/new-results/test/parameters/simu/sw-cache
      info for 500 / 500 = 1.000   (0 failed)
      kept 362 (0.724) unproductive
        water time: 0.4
hmm
--> caching all 500 naive sequences
    prepare_for_hmm: (0.1 sec)
    running 10 procs
                no/empty cache file
                    calcd:         vtb 500        fwd   0
                   merged:       hfrac   0     lratio   0
             min-max time:  1.5 - 2.1 sec
      hmm step time: 2.2
--> 500 clusters with 10 procs
    prepare_for_hmm: (0.1 sec)
       naive hfrac bounds: 0.015 0.118   (0.132 mean mutation in parameter dir test/new-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 500   logprobs   0
                    calcd:         vtb 111        fwd 359
                   merged:       hfrac 132     lratio  29
             min-max time:  2.4 - 7.0 sec
         infra time: 0.2
      hmm step time: 7.3
--> 339 clusters with 7 procs
    prepare_for_hmm: (0.2 sec)
    running 7 procs
          read from cache:  naive-seqs 663   logprobs 359
                    calcd:         vtb  48        fwd 147
                   merged:       hfrac  56     lratio  15
             min-max time:  2.4 - 4.4 sec
         infra time: 0.3
      hmm step time: 4.7
--> 268 clusters with 5 procs
    prepare_for_hmm: (0.2 sec)
    running 5 procs
          read from cache:  naive-seqs 738   logprobs 506
                    calcd:         vtb  31        fwd 108
                   merged:       hfrac  43     lratio   9
             min-max time:  3.3 - 5.4 sec
         infra time: 0.3
      hmm step time: 5.8
--> 216 clusters with 3 procs
    prepare_for_hmm: (0.1 sec)
    running 3 procs
          read from cache:  naive-seqs 795   logprobs 614
                    calcd:         vtb  31        fwd 127
                   merged:       hfrac  34     lratio  15
             min-max time:  5.8 - 11.1 sec
      hmm step time: 11.3
--> 167 clusters with 2 procs
    prepare_for_hmm: (0.1 sec)
    running 2 procs
          read from cache:  naive-seqs 851   logprobs 741
                    calcd:         vtb  24        fwd  98
                   merged:       hfrac  28     lratio  13
             min-max time:  6.1 - 15.3 sec
         infra time: 0.2
      hmm step time: 15.6
--> 126 clusters with 2 procs
    prepare_for_hmm: (0.2 sec)
    running 2 procs
          read from cache:  naive-seqs 900   logprobs 839
                    calcd:         vtb   9        fwd  47
                   merged:       hfrac   9     lratio   5
             min-max time:  4.2 - 7.2 sec
         infra time: 0.2
      hmm step time: 7.4
--> 112 clusters with 2 procs
    prepare_for_hmm: (0.2 sec)
    running 2 procs
          read from cache:  naive-seqs 916   logprobs 886
                    calcd:         vtb   2        fwd  20
                   merged:       hfrac   2     lratio   1
             min-max time:  1.3 - 6.1 sec
         infra time: 0.2
      hmm step time: 6.4
--> 109 clusters with 2 procs
    prepare_for_hmm: (0.1 sec)
    running 2 procs
          read from cache:  naive-seqs 919   logprobs 906
                    calcd:         vtb   1        fwd  10
                   merged:       hfrac   1     lratio   3
             min-max time:  0.9 - 2.9 sec
      hmm step time: 3.0
--> 105 clusters with 1 proc
    prepare_for_hmm: (0.2 sec)
    running 1 proc
          read from cache:  naive-seqs 923   logprobs 916
                    calcd:         vtb   2        fwd  57
                   merged:       hfrac   2     lratio   1
                     time:  11.9 sec
         infra time: 0.2
      hmm step time: 12.1
      loop time: 73.6
--> getting annotations for final partition
    prepare_for_hmm: (0.1 sec)
    running 10 procs
      hmm step time: 2.9
    read output
        processed 102 hmm output lines with 500 sequences in 102 events  (0 failures)
      total time: 79.8
[92mseed-partition-new-simu[0m          ./bin/partis partition --n-max-queries 500 --persistent-cachefname test/new-results/cache-new-partition.csv --dont-precache-naive-seqs --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed-unique-id 4730626846417369276 --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/seed-partition-new-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
        reading sw results from test/new-results/test/parameters/simu/sw-cache
      info for 500 / 500 = 1.000   (0 failed)
      kept 362 (0.724) unproductive
      removed 400 / 500 = 0.80 sequences with cdr3 length different from seed sequence (leaving 100)
        water time: 0.8
hmm
--> 100 clusters with 10 procs
    prepare_for_hmm: (0.0 sec)
       naive hfrac bounds: 0.015 0.118   (0.132 mean mutation in parameter dir test/new-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 926   logprobs 973
                    calcd:         vtb   6        fwd  24
                   merged:       hfrac   7     lratio   0
             min-max time:  0.0 - 1.3 sec
      hmm step time: 1.4
--> 102 clusters with 7 procs
    prepare_for_hmm: (0.0 sec)
    running 7 procs
          read from cache:  naive-seqs 932   logprobs 996
                    calcd:         vtb   0        fwd  11
                   merged:       hfrac   0     lratio   0
             min-max time:  0.0 - 1.3 sec
         infra time: 0.1
      hmm step time: 1.5
--> 99 clusters with 5 procs
    prepare_for_hmm: (0.0 sec)
    running 5 procs
          read from cache:  naive-seqs 932   logprobs 1007
                    calcd:         vtb   2        fwd  12
                   merged:       hfrac   2     lratio   0
             min-max time:  0.8 - 1.9 sec
      hmm step time: 2.0
      removing 92 sequences in unseeded clusters, and splitting 5 seeded clusters into 8 singletons
        new n_procs 1 (initial seqs/proc: 10.00   new seqs/proc: 8.00
--> 8 clusters with 1 proc
    prepare_for_hmm: (0.0 sec)
    running 1 proc
          read from cache:  naive-seqs 934   logprobs 1019
                    calcd:         vtb   5        fwd  11
                   merged:       hfrac   7     lratio   0
                     time:  2.5 sec
      hmm step time: 2.6
      loop time: 7.4
--> getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 1 proc
      hmm step time: 0.3
    read output
        processed 1 hmm output lines with 8 sequences in 1 events  (0 failures)
      total time: 9.1
[92mvsearch-partition-new-simu[0m       ./bin/partis partition --naive-vsearch --n-max-queries 500 --persistent-cachefname test/new-results/cache-new-partition.csv --dont-precache-naive-seqs --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/vsearch-partition-new-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
        reading sw results from test/new-results/test/parameters/simu/sw-cache
      info for 500 / 500 = 1.000   (0 failed)
      kept 362 (0.724) unproductive
        water time: 0.8
hmm
       naive hfrac bounds: 0.036 0.036   (0.132 mean mutation in parameter dir test/new-results/test/parameters/simu/hmm)
        collapsed 500 sequences into 310 unique naive sequences
    using hfrac bound for vsearch 0.036
    running vsearch 23 times (once for each cdr3 length class): . . . . . . . . . . . . . . . . . . . . . . . 
      vsearch time: 1.8
--> getting annotations for final partition
    prepare_for_hmm: (0.2 sec)
    running 10 procs
         infra time: 0.2
      hmm step time: 2.9
    read output
        processed 114 hmm output lines with 500 sequences in 114 events  (0 failures)
      total time: 6.4
