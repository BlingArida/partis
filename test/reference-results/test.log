[92mcache-parameters-data[0m            ./bin/partis cache-parameters --infname test/mishmash.fa --parameter-dir test/new-results/test/parameters/data --sw-cachefname test/new-results/test/parameters/data/sw-cache.yaml --n-max-queries -1 --seed 1 --n-procs 10
  note: running on a lot of sequences (1412) without setting --outfname. Which is ok, but there will be no persistent record of the results (except the parameter directory).
caching parameters
  vsearch: 1268 / 1412 v annotations (144 failed) with 177 v genes in 0.1 sec
    keeping 61 / 204 v genes
smith-waterman  (new-allele fitting)
  vsearch: 1264 / 1412 v annotations (148 failed) with 61 v genes in 0.2 sec
  removing old sw cache test/new-results/test/parameters/data/sw-cache.yaml
    running 10 procs for 1412 seqs
    running 13 procs for 71 seqs
      info for 1370 / 1412 = 0.970   (42 failed)
      kept 437 (0.309) unproductive
      removed 23 / 1370 = 0.02 duplicate sequences after trimming framework insertions (leaving 1347)
    water time: 2.5  (ig-sw 0.1  processing 0.1)
  no queries for allele finding
smith-waterman  (writing parameters)
  vsearch: 1264 / 1412 v annotations (148 failed) with 61 v genes in 0.2 sec
    running 10 procs for 1370 seqs
    running 13 procs for 29 seqs
      info for 1393 / 1412 = 0.987   (42 failed)
      kept 437 (0.309) unproductive
      removed 23 / 1370 = 0.02 duplicate sequences after trimming framework insertions (leaving 1347)
        writing sw results to test/new-results/test/parameters/data/sw-cache.yaml
    writing parameters to test/new-results/test/parameters/data/sw (6.3 sec)
    water time: 10.3  (ig-sw 7.8  processing 0.2)
  writing hmms (0.6 sec)
hmm
    skipping matches from 4 genes without enough counts: [95mh[0m[91mj[0m[95m4[0m[93m01[0m [95mh[0m[91mj[0m[95m6[0m[93m04[0m [95mh[0m[91mj[0m[95m4[0m[93m03[0m [95mh[0m[91mj[0m[95m6[0m[93m01[0m
    prepare_for_hmm: (0.1 sec)
    running 10 procs
                    calcd:         vtb 1347        fwd    0
             min-max time:  6.1 - 13.6 sec
    read output
    writing parameters to test/new-results/test/parameters/data/hmm (4.7 sec)
        processed 1347 hmm output lines with 1344 sequences in 1344 events  (3 failures)
            [91mwarning[0m skipped 3 invalid events
         infra time: 6.5
      hmm step time: 20.2
  writing hmms (1.2 sec)
      total time: 35.7
[92msimulate[0m                         ./bin/partis simulate --parameter-dir test/new-results/test/parameters/data --n-sim-events 500 --n-trees 500 --n-leaves 5 --seed 1 --n-procs 10 --outfname test/new-results/test/simu.yaml --indel-frequency 0.01 --indel-location v
simulating
   read 500 events from 10 csv files
      total time: 6.2
[92mcache-parameters-simu[0m            ./bin/partis cache-parameters --infname test/new-results/test/simu.yaml --parameter-dir test/new-results/test/parameters/simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.yaml --is-simu --seed 1 --n-procs 10
  note: running on a lot of sequences (2547) without setting --outfname. Which is ok, but there will be no persistent record of the results (except the parameter directory).
caching parameters
  vsearch: 2433 / 2547 v annotations (114 failed) with 92 v genes in 0.2 sec
    keeping 46 / 204 v genes
    [91mmissing[0m 11 simulation genes (counts): [95mh[0m[91mv[0m[95m1[0m[95m-45[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-69-2[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-13[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-20[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-30[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-NL1[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-30-2[0m[93m05[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-30-4[0m[93m07[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-31[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-34[0m[93m10[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-59[0m[93m02[0m 33
smith-waterman  (new-allele fitting)
  vsearch: 2431 / 2547 v annotations (116 failed) with 46 v genes in 0.5 sec
  removing old sw cache test/new-results/test/parameters/simu/sw-cache.yaml
    running 10 procs for 2547 seqs
    running 13 procs for 15 seqs
      info for 2547 / 2547 = 1.000   (0 failed)
      kept 1471 (0.578) unproductive
    water time: 5.7  (ig-sw 0.1  processing 0.1)
smith-waterman  (writing parameters)
  vsearch: 2431 / 2547 v annotations (116 failed) with 46 v genes in 0.5 sec
    running 10 procs for 2547 seqs
    running 13 procs for 15 seqs
      info for 2547 / 2547 = 1.000   (0 failed)
      kept 1471 (0.578) unproductive
        writing sw results to test/new-results/test/parameters/simu/sw-cache.yaml
    writing parameters to test/new-results/test/parameters/simu/sw (4.9 sec)
    water time: 13.5  (ig-sw 7.7  processing 0.2)
  writing hmms (0.9 sec)
hmm
    skipping matches from 3 genes without enough counts: [95mh[0m[91mj[0m[95m4[0m[93m01[0m [95mh[0m[91mj[0m[95m6[0m[93m04[0m [95mh[0m[91mj[0m[95m6[0m[93m01[0m
    prepare_for_hmm: (0.3 sec)
    running 10 procs
                    calcd:         vtb 2547        fwd    0
             min-max time:  6.2 - 6.7 sec
    read output
    writing parameters to test/new-results/test/parameters/simu/hmm (4.8 sec)
    writing parameters to test/new-results/test/parameters/simu/true (4.4 sec)
        processed 2547 hmm output lines with 2547 sequences in 2547 events  (0 failures)
         infra time: 15.2
      hmm step time: 22.1
  writing hmms (0.9 sec)
      total time: 47.4
[92mannotate-new-simu[0m                ./bin/partis annotate --infname test/new-results/test/simu.yaml --parameter-dir test/new-results/test/parameters/simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.yaml --plot-annotation-performance --is-simu --plotdir test/new-results/annotate-new-simu-annotation-performance --only-csv-plots --seed 1 --n-procs 10 --outfname test/new-results/annotate-new-simu.yaml
annotating
smith-waterman
  vsearch: 2431 / 2547 v annotations (116 failed) with 46 v genes in 0.4 sec
        reading sw results from test/new-results/test/parameters/simu/sw-cache.yaml
      info for 2547 / 2547 = 1.000   (0 failed, 0 duplicates)
      kept 1471 (0.578) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 31 queries with different true and inferred net shm indel lengths: -5651847160665664401 -5439269371937960587 -1671855173954335224 8954205596662700877 8035292104897566831 -6980816598168328992 -1944317774027608021 -8367653297265321903 -8293382619417154339 8432857210250136546 5799285248059412632 2068880357636149462 -2371885096165935033 1956948816140811658 7954543083237881632 7422004274478422216 -4705474587037986920 8275139848541491025 -989204982925865978 8637175181917571230 -7415776837269631489 -1655690294066692408 -5666140250886008893 7646408670496224120 3907228710595224434 -513524172495743856 4275748943507448387 -7817117079272132355 -3036310640334905899 -5311463564242888055 8783820690509299823
(0.3 sec)
        water time: 3.8
hmm
    prepare_for_hmm: (0.3 sec)
    running 10 procs
                    calcd:         vtb 2547        fwd    0
             min-max time:  5.8 - 6.6 sec
    read output
  plotting performance (0.3 sec)
        processed 2547 hmm output lines with 2547 sequences in 2547 events  (0 failures)
         infra time: 3.5
      hmm step time: 10.3
      total time: 16.1
[92mmulti-annotate-new-simu[0m          ./bin/partis annotate --infname test/new-results/test/simu.yaml --parameter-dir test/new-results/test/parameters/simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.yaml --plot-annotation-performance --simultaneous-true-clonal-seqs --is-simu --plotdir test/new-results/multi-annotate-new-simu-annotation-performance --only-csv-plots --seed 1 --n-procs 10 --outfname test/new-results/multi-annotate-new-simu.yaml
annotating
smith-waterman
  vsearch: 2431 / 2547 v annotations (116 failed) with 46 v genes in 0.5 sec
        reading sw results from test/new-results/test/parameters/simu/sw-cache.yaml
      info for 2547 / 2547 = 1.000   (0 failed, 0 duplicates)
      kept 1471 (0.578) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 31 queries with different true and inferred net shm indel lengths: -5651847160665664401 -5439269371937960587 -1671855173954335224 8954205596662700877 8035292104897566831 -6980816598168328992 -1944317774027608021 -8367653297265321903 -8293382619417154339 8432857210250136546 5799285248059412632 2068880357636149462 -2371885096165935033 1956948816140811658 7954543083237881632 7422004274478422216 -4705474587037986920 8275139848541491025 -989204982925865978 8637175181917571230 -7415776837269631489 -1655690294066692408 -5666140250886008893 7646408670496224120 3907228710595224434 -513524172495743856 4275748943507448387 -7817117079272132355 -3036310640334905899 -5311463564242888055 8783820690509299823
(0.3 sec)
        water time: 3.1
hmm
  [93mwarning[0m split apart 9 clusters that contained multiple cdr3 lengths (total clusters: 483 --> 492)
    prepare_for_hmm: (0.2 sec)
    running 10 procs
                    calcd:         vtb  492        fwd    0
             min-max time:  3.3 - 5.4 sec
    read output
  plotting performance (0.3 sec)
        processed 492 hmm output lines with 2547 sequences in 492 events  (0 failures)
         infra time: 2.8
      hmm step time: 8.3
      total time: 13.3
[92mpartition-new-simu[0m               ./bin/partis partition --infname test/new-results/test/simu.yaml --parameter-dir test/new-results/test/parameters/simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.yaml --n-max-queries 500 --n-precache-procs 10 --plot-annotation-performance --is-simu --persistent-cachefname test/new-results/cache-new-partition.csv --plotdir test/new-results/partition-new-simu-annotation-performance --only-csv-plots --seed 1 --n-procs 10 --outfname test/new-results/partition-new-simu.yaml
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman
  vsearch: 475 / 500 v annotations (25 failed) with 28 v genes in 0.1 sec
        reading sw results from test/new-results/test/parameters/simu/sw-cache.yaml
      info for 500 / 500 = 1.000   (0 failed, 0 duplicates)
      kept 287 (0.574) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 2 queries with different true and inferred net shm indel lengths: -5651847160665664401 -5439269371937960587
(0.3 sec)
        water time: 1.6
hmm
caching all 500 naive sequences
    prepare_for_hmm: (0.1 sec)
    running 10 procs
                no/empty cache file
                    calcd:         vtb 500        fwd   0
                   merged:       hfrac   0     lratio   0
             min-max time:  2.2 - 2.7 sec
      hmm step time: 2.9
   collapsed 500 queries into 314 clusters with identical naive seqs (0.0 sec)
314 clusters with 10 procs
    prepare_for_hmm: (0.1 sec)
       naive hfrac bounds: 0.015 0.105   (0.103 mean mutation in parameter dir test/new-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 500   logprobs   0
                    calcd:         vtb 131        fwd 182
                   merged:       hfrac  38     lratio  24
             min-max time:  1.3 - 3.2 sec
         infra time: 0.2
      hmm step time: 3.5
252 clusters with 7 procs
    prepare_for_hmm: (0.1 sec)
    running 7 procs
          read from cache:  naive-seqs 632   logprobs 182
                    calcd:         vtb  39        fwd 107
                   merged:       hfrac  20     lratio  15
             min-max time:  1.2 - 2.9 sec
         infra time: 0.1
      hmm step time: 3.1
217 clusters with 5 procs
    prepare_for_hmm: (0.1 sec)
    running 5 procs
          read from cache:  naive-seqs 672   logprobs 289
                    calcd:         vtb  34        fwd  93
                   merged:       hfrac  20     lratio  11
             min-max time:  1.6 - 3.1 sec
         infra time: 0.1
      hmm step time: 3.3
186 clusters with 3 procs
    prepare_for_hmm: (0.1 sec)
    running 3 procs
          read from cache:  naive-seqs 706   logprobs 382
                    calcd:         vtb  35        fwd  95
                   merged:       hfrac  24     lratio  10
             min-max time:  3.3 - 5.2 sec
         infra time: 0.1
      hmm step time: 5.4
152 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 742   logprobs 477
                    calcd:         vtb  25        fwd  77
                   merged:       hfrac  17     lratio   8
             min-max time:  4.5 - 6.7 sec
      hmm step time: 6.9
127 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 769   logprobs 554
                    calcd:         vtb  11        fwd  47
                   merged:       hfrac   9     lratio   2
             min-max time:  2.9 - 5.4 sec
      hmm step time: 5.5
116 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 781   logprobs 601
                    calcd:         vtb   3        fwd  15
                   merged:       hfrac   1     lratio   2
             min-max time:  1.7 - 2.8 sec
      hmm step time: 2.9
113 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 784   logprobs 616
                    calcd:         vtb   3        fwd   8
                   merged:       hfrac   3     lratio   0
             min-max time:  1.6 - 1.7 sec
      hmm step time: 1.8
110 clusters with 1 proc
    prepare_for_hmm: (0.0 sec)
    running 1 proc
          read from cache:  naive-seqs 787   logprobs 624
                    calcd:         vtb   1        fwd  58
                   merged:       hfrac   1     lratio   1
                     time:  6.1 sec
      hmm step time: 6.2
  [93mnote[0m not merging entire cpath history
      loop time: 38.7
getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 10 procs
                    calcd:         vtb 108        fwd   0
             min-max time:  1.0 - 1.8 sec
      hmm step time: 1.9
    read output
  plotting performance (0.3 sec)
        processed 108 hmm output lines with 500 sequences in 108 events  (0 failures)
  --only-csv-plots not implemented for partition plots, so skipping
      total time: 46.5
[92mseed-partition-new-simu[0m          ./bin/partis partition --infname test/new-results/test/simu.yaml --parameter-dir test/new-results/test/parameters/simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.yaml --n-max-queries 500 --is-simu --persistent-cachefname test/new-results/cache-new-partition.csv --seed-unique-id 4924829740908498546 --seed 1 --n-procs 10 --outfname test/new-results/seed-partition-new-simu.yaml
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman
  vsearch: 475 / 500 v annotations (25 failed) with 28 v genes in 0.1 sec
        reading sw results from test/new-results/test/parameters/simu/sw-cache.yaml
      info for 500 / 500 = 1.000   (0 failed, 0 duplicates)
      kept 287 (0.574) unproductive
      removed 474 / 500 = 0.95 sequences with cdr3 length different from seed sequence (leaving 26)
        water time: 0.3
hmm
   collapsed 26 queries into 17 clusters with identical naive seqs (0.0 sec)
17 clusters with 10 procs
    prepare_for_hmm: (0.0 sec)
       naive hfrac bounds: 0.015 0.105   (0.103 mean mutation in parameter dir test/new-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 789   logprobs 682
                    calcd:         vtb  13        fwd   5
                   merged:       hfrac   2     lratio   0
             min-max time:  0.1 - 0.4 sec
      hmm step time: 0.5
24 clusters with 7 procs
    prepare_for_hmm: (0.0 sec)
    running 7 procs
          read from cache:  naive-seqs 793   logprobs 687
                    calcd:         vtb   0        fwd   2
                   merged:       hfrac   0     lratio   0
             min-max time:  0.0 - 0.3 sec
      hmm step time: 0.4
21 clusters with 5 procs
    prepare_for_hmm: (0.0 sec)
    running 5 procs
          read from cache:  naive-seqs 793   logprobs 689
                    calcd:         vtb   0        fwd   2
                   merged:       hfrac   0     lratio   0
             min-max time:  0.0 - 0.3 sec
      hmm step time: 0.4
      removed 18 sequences in unseeded clusters, split 5 seeded clusters into 8 singletons, and merged these into 3 clusters with identical naive seqs
        new n_procs 1 (initial seqs/proc: 2.60   new seqs/proc: 3.00
3 clusters with 1 proc
    prepare_for_hmm: (0.0 sec)
    running 1 proc
          read from cache:  naive-seqs 793   logprobs 691
                    calcd:         vtb   4        fwd   5
                   merged:       hfrac   2     lratio   0
                     time:  0.3 sec
      hmm step time: 0.3
      loop time: 1.6
getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 1 proc
                    calcd:         vtb   1        fwd   0
                     time:  0.2 sec
      hmm step time: 0.2
    read output
        processed 1 hmm output lines with 8 sequences in 1 events  (0 failures)
      total time: 2.5
[92mvsearch-partition-new-simu[0m       ./bin/partis partition --infname test/new-results/test/simu.yaml --parameter-dir test/new-results/test/parameters/simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.yaml --naive-vsearch --n-max-queries 500 --is-simu --persistent-cachefname test/new-results/cache-new-partition.csv --seed 1 --n-procs 10 --outfname test/new-results/vsearch-partition-new-simu.yaml
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman
  vsearch: 475 / 500 v annotations (25 failed) with 28 v genes in 0.2 sec
        reading sw results from test/new-results/test/parameters/simu/sw-cache.yaml
      info for 500 / 500 = 1.000   (0 failed, 0 duplicates)
      kept 287 (0.574) unproductive
        water time: 0.3
hmm
       naive hfrac bounds: 0.031 0.031   (0.103 mean mutation in parameter dir test/new-results/test/parameters/simu/hmm)
        collapsed 500 sequences into 314 unique naive sequences
    using hfrac bound for vsearch 0.031
    running vsearch 22 times (once for each cdr3 length class): . . . . . . . . . . . . . . . . . . . . . . 
      vsearch time: 1.1
getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 10 procs
                    calcd:         vtb 128        fwd   0
             min-max time:  1.2 - 1.8 sec
      hmm step time: 2.0
    read output
        processed 128 hmm output lines with 500 sequences in 128 events  (0 failures)
      total time: 4.0
