[92mannotate-ref-simu[0m                ./bin/partis annotate --plot-annotation-performance --plotdir test/new-results/annotate-ref-simu-annotation-performance --only-csv-plots --only-overall-plots --is-simu --sw-cachefname test/reference-results/test/parameters/simu/sw-cache.csv --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/annotate-ref-simu.csv
annotating
smith-waterman
  vsearch: 2393 / 2562 v annotations (169 failed) with 43 v genes in 0.4 sec
        reading sw results from test/reference-results/test/parameters/simu/sw-cache
      info for 2554 / 2562 = 0.997   (8 failed)
      kept 1573 (0.614) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 14 queries with different true and inferred net shm indel lengths: 1667014127108520889 -1698125377776887754 -6592981928632373576 3411555643997713375 -1223213546020366966 -5730441331628128067 2447496209938796791 6480740913865585177 2712916551846080017 1284982905843564095 3501569511712948868 299191433789177356 -1057333660992891686 -8866798616931867804
(1.6 sec)
        water time: 3.8
hmm
    prepare_for_hmm: (0.3 sec)
    running 10 procs
                    calcd:         vtb 2554        fwd    0
             min-max time:  5.1 - 5.4 sec
    read output
  plotting performance (1.8 sec)
        processed 2554 hmm output lines with 2553 sequences in 2553 events  (1 failures)
          [91mwarning[0m no valid paths: -2945885595145226818
         infra time: 6.3
      hmm step time: 11.9
      total time: 16.8
[92mmulti-annotate-ref-simu[0m          ./bin/partis annotate --plot-annotation-performance --simultaneous-true-clonal-seqs --plotdir test/new-results/multi-annotate-ref-simu-annotation-performance --only-csv-plots --only-overall-plots --is-simu --sw-cachefname test/reference-results/test/parameters/simu/sw-cache.csv --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/multi-annotate-ref-simu.csv
annotating
smith-waterman
  vsearch: 2393 / 2562 v annotations (169 failed) with 43 v genes in 0.4 sec
        reading sw results from test/reference-results/test/parameters/simu/sw-cache
      info for 2554 / 2562 = 0.997   (8 failed)
      kept 1573 (0.614) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 14 queries with different true and inferred net shm indel lengths: 1667014127108520889 -1698125377776887754 -6592981928632373576 3411555643997713375 -1223213546020366966 -5730441331628128067 2447496209938796791 6480740913865585177 2712916551846080017 1284982905843564095 3501569511712948868 299191433789177356 -1057333660992891686 -8866798616931867804
(1.7 sec)
        water time: 3.8
hmm
  [93mwarning[0m split apart 6 clusters that contained multiple cdr3 lengths (total clusters: 484 --> 490)
    prepare_for_hmm: (0.2 sec)
    running 10 procs
                    calcd:         vtb  490        fwd    0
             min-max time:  2.9 - 4.8 sec
    read output
  plotting performance (1.3 sec)
        processed 490 hmm output lines with 2554 sequences in 490 events  (0 failures)
         infra time: 3.7
      hmm step time: 8.6
      total time: 13.5
[92mpartition-ref-simu[0m               ./bin/partis partition --n-max-queries 500 --n-precache-procs 10 --plot-annotation-performance --biggest-logprob-cluster-to-calculate 5 --biggest-naive-seq-cluster-to-calculate 5 --persistent-cachefname test/new-results/cache-ref-partition.csv --plotdir test/new-results/partition-ref-simu-annotation-performance --only-csv-plots --only-overall-plots --is-simu --sw-cachefname test/reference-results/test/parameters/simu/sw-cache.csv --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/partition-ref-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman
  vsearch: 485 / 500 v annotations (15 failed) with 30 v genes in 0.1 sec
        reading sw results from test/reference-results/test/parameters/simu/sw-cache
      info for 500 / 500 = 1.000   (0 failed)
      kept 306 (0.612) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 9 queries with different true and inferred net shm indel lengths: 1667014127108520889 -1698125377776887754 -6592981928632373576 3411555643997713375 -1223213546020366966 -5730441331628128067 2447496209938796791 6480740913865585177 2712916551846080017
(1.5 sec)
        water time: 2.3
hmm
caching all 500 naive sequences
    prepare_for_hmm: (0.1 sec)
    running 10 procs
                no/empty cache file
                    calcd:         vtb 500        fwd   0
                   merged:       hfrac   0     lratio   0
             min-max time:  1.6 - 2.0 sec
      hmm step time: 2.2
   collapsed 500 queries into 282 clusters with identical naive seqs (0.0 sec)
282 clusters with 10 procs
    prepare_for_hmm: (0.0 sec)
       naive hfrac bounds: 0.015 0.106   (0.105 mean mutation in parameter dir test/reference-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 500   logprobs   0
                    calcd:         vtb 106        fwd 135
                   merged:       hfrac  38     lratio  14
             min-max time:  0.7 - 3.2 sec
         infra time: 0.2
      hmm step time: 3.4
230 clusters with 7 procs
    prepare_for_hmm: (0.0 sec)
    running 7 procs
          read from cache:  naive-seqs 622   logprobs 135
                    calcd:         vtb  40        fwd  77
                   merged:       hfrac  27     lratio   9
             min-max time:  0.4 - 2.4 sec
      hmm step time: 2.6
194 clusters with 5 procs
    prepare_for_hmm: (0.0 sec)
    running 5 procs
          read from cache:  naive-seqs 665   logprobs 212
                    calcd:         vtb  33        fwd  55
                   merged:       hfrac  26     lratio   6
             min-max time:  1.2 - 2.1 sec
      hmm step time: 2.3
162 clusters with 3 procs
    prepare_for_hmm: (0.1 sec)
    running 3 procs
          read from cache:  naive-seqs 706   logprobs 267
                    calcd:         vtb  26        fwd  67
                   merged:       hfrac  14     lratio   9
             min-max time:  1.5 - 4.7 sec
      hmm step time: 4.9
139 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 739   logprobs 334
                    calcd:         vtb  20        fwd  67
                   merged:       hfrac  12     lratio  11
             min-max time:  3.3 - 7.1 sec
      hmm step time: 7.2
116 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 768   logprobs 401
                    calcd:         vtb   9        fwd  27
                   merged:       hfrac   6     lratio   4
             min-max time:  1.3 - 3.3 sec
      hmm step time: 3.4
106 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 781   logprobs 428
                    calcd:         vtb   3        fwd  12
                   merged:       hfrac   4     lratio   0
             min-max time:  0.8 - 2.0 sec
      hmm step time: 2.1
102 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 787   logprobs 440
                    calcd:         vtb   1        fwd   8
                   merged:       hfrac   0     lratio   1
             min-max time:  0.3 - 1.3 sec
      hmm step time: 1.5
101 clusters with 1 proc
    prepare_for_hmm: (0.0 sec)
    running 1 proc
          read from cache:  naive-seqs 788   logprobs 448
                    calcd:         vtb   3        fwd  70
                   merged:       hfrac   0     lratio   3
                     time:  6.1 sec
      hmm step time: 6.3
      loop time: 33.7
getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 10 procs
                    calcd:         vtb  98        fwd   0
             min-max time:  0.9 - 1.3 sec
      hmm step time: 1.5
    read output
  plotting performance (1.6 sec)
        processed 98 hmm output lines with 500 sequences in 98 events  (0 failures)
  --only-csv-plots not implemented for partition plots, so skipping
      total time: 42.1
[92mseed-partition-ref-simu[0m          ./bin/partis partition --n-max-queries 500 --persistent-cachefname test/new-results/cache-ref-partition.csv --is-simu --sw-cachefname test/reference-results/test/parameters/simu/sw-cache.csv --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed-unique-id 9005994567486518305 --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/seed-partition-ref-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman
  vsearch: 485 / 500 v annotations (15 failed) with 30 v genes in 0.1 sec
        reading sw results from test/reference-results/test/parameters/simu/sw-cache
      info for 500 / 500 = 1.000   (0 failed)
      kept 306 (0.612) unproductive
      removed 428 / 500 = 0.86 sequences with cdr3 length different from seed sequence (leaving 72)
        water time: 0.4
hmm
   collapsed 72 queries into 46 clusters with identical naive seqs (0.0 sec)
46 clusters with 10 procs
    prepare_for_hmm: (0.0 sec)
       naive hfrac bounds: 0.015 0.106   (0.105 mean mutation in parameter dir test/reference-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 792   logprobs 518
                    calcd:         vtb  12        fwd  15
                   merged:       hfrac   0     lratio   4
             min-max time:  0.0 - 0.6 sec
      hmm step time: 0.7
51 clusters with 7 procs
    prepare_for_hmm: (0.0 sec)
    running 7 procs
          read from cache:  naive-seqs 804   logprobs 533
                    calcd:         vtb   0        fwd   2
                   merged:       hfrac   0     lratio   0
             min-max time:  0.0 - 0.5 sec
      hmm step time: 0.5
48 clusters with 5 procs
    prepare_for_hmm: (0.0 sec)
    running 5 procs
          read from cache:  naive-seqs 804   logprobs 535
                    calcd:         vtb   0        fwd   4
                   merged:       hfrac   0     lratio   0
             min-max time:  0.0 - 0.5 sec
      hmm step time: 0.5
      removed 67 sequences in unseeded clusters, split 5 seeded clusters into 5 singletons, and merged these into 5 clusters with identical naive seqs
        new n_procs 1 (initial seqs/proc: 7.20   new seqs/proc: 5.00
5 clusters with 1 proc
    prepare_for_hmm: (0.0 sec)
    running 1 proc
          read from cache:  naive-seqs 804   logprobs 539
                    calcd:         vtb   2        fwd   8
                   merged:       hfrac   1     lratio   2
                     time:  0.6 sec
      hmm step time: 0.7
      loop time: 2.5
getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 2 procs
                    calcd:         vtb   2        fwd   0
             min-max time:  0.2 - 0.2 sec
      hmm step time: 0.2
    read output
        processed 2 hmm output lines with 5 sequences in 2 events  (0 failures)
      total time: 3.6
[92mvsearch-partition-ref-simu[0m       ./bin/partis partition --naive-vsearch --n-max-queries 500 --persistent-cachefname test/new-results/cache-ref-partition.csv --is-simu --sw-cachefname test/reference-results/test/parameters/simu/sw-cache.csv --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/vsearch-partition-ref-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman
  vsearch: 485 / 500 v annotations (15 failed) with 30 v genes in 0.1 sec
        reading sw results from test/reference-results/test/parameters/simu/sw-cache
      info for 500 / 500 = 1.000   (0 failed)
      kept 306 (0.612) unproductive
        water time: 0.4
hmm
       naive hfrac bounds: 0.031 0.031   (0.105 mean mutation in parameter dir test/reference-results/test/parameters/simu/hmm)
        collapsed 500 sequences into 282 unique naive sequences
    using hfrac bound for vsearch 0.031
    running vsearch 27 times (once for each cdr3 length class): . . . . . . . . . . . . . . . . . . . . . . . . . . . 
      vsearch time: 1.2
getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 10 procs
                    calcd:         vtb 119        fwd   0
             min-max time:  0.9 - 1.4 sec
      hmm step time: 1.5
    read output
        processed 119 hmm output lines with 500 sequences in 119 events  (0 failures)
      total time: 3.6
[92mcache-parameters-data[0m            ./bin/partis cache-parameters --plotdir test/new-results/test/plots/data --only-csv-plots --only-overall-plots --sw-cachefname test/new-results/test/parameters/data/sw-cache.csv --infname test/mishmash.fa --parameter-dir test/new-results/test/parameters/data --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human
  note: running on a lot of sequences (1412) without setting --outfname. Which is ok, but there will be no persistent record of the results.
caching parameters
  vsearch: 1268 / 1412 v annotations (144 failed) with 177 v genes in 0.1 sec
    keeping 61 / 204 v genes
smith-waterman  (new-allele fitting)
  vsearch: 1264 / 1412 v annotations (148 failed) with 61 v genes in 0.2 sec
  removing old sw cache test/new-results/test/parameters/data/sw-cache
    running 10 procs for 1412 seqs
    running 10 procs for 72 seqs
      info for 1369 / 1412 = 0.970   (43 failed)
      kept 436 (0.309) unproductive
      removed 23 / 1369 = 0.02 duplicate sequences after trimming framework insertions (leaving 1346)
    water time: 2.5  (ig-sw 0.1  processing 0.1)
  no queries for allele finding
    <only_csv> not yet implemented in allelefinder
smith-waterman  (writing parameters)
  vsearch: 1264 / 1412 v annotations (148 failed) with 61 v genes in 0.2 sec
    running 10 procs for 1369 seqs
    running 10 procs for 29 seqs
      info for 1369 / 1412 = 0.970   (43 failed)
      kept 436 (0.309) unproductive
      removed 23 / 1369 = 0.02 duplicate sequences after trimming framework insertions (leaving 1346)
        writing sw results to test/new-results/test/parameters/data/sw-cache
  plotting parameters (3.7 sec)
    writing parameters (7.8 sec)
    water time: 14.8  (ig-sw 12.4  processing 0.1)
    keeping 18 / 28 d genes
    keeping 7 / 13 j genes
  (not actually removing d and j alleleremover genes)
  writing hmms (2.3 sec)
hmm
    prepare_for_hmm: (0.1 sec)
    running 10 procs
                    calcd:         vtb 1346        fwd    0
             min-max time:  4.7 - 11.2 sec
    read output
  plotting parameters (3.4 sec)
    writing parameters (6.5 sec)
        processed 1346 hmm output lines with 1344 sequences in 1344 events  (2 failures)
            [91mwarning[0m skipped 2 invalid events
         infra time: 12.0
      hmm step time: 23.3
  writing hmms (2.2 sec)
      total time: 46.3
[92msimulate[0m                         ./bin/partis simulate --n-sim-events 500 --n-trees 500 --n-leaves 5 --parameter-dir test/new-results/test/parameters/data --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/test/simu.csv --indel-frequency 0.01 --indel-location v
simulating
   read 500 events from 10 files
      total time: 5.3
[92mcache-parameters-simu[0m            ./bin/partis cache-parameters --plotdir test/new-results/test/plots/simu --only-csv-plots --only-overall-plots --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human
  note: running on a lot of sequences (2562) without setting --outfname. Which is ok, but there will be no persistent record of the results.
caching parameters
  vsearch: 2397 / 2562 v annotations (165 failed) with 90 v genes in 0.2 sec
    keeping 44 / 204 v genes
    [91mmissing[0m 160 simulation genes (counts): [95mh[0m[91mv[0m[95m1[0m[95m-18[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-18[0m[93m04[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-2[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-2[0m[93m04[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-2[0m[93m05[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-45[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-46[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-46[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-58[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-69[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-69[0m[93m04[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-69[0m[93m05[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-69[0m[93m06[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-69[0m[93m08[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-69[0m[93m09[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-69[0m[93m10[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-69[0m[93m11[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-69[0m[93m12[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-69[0m[93m13[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-69[0m[93m14[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-69-2[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m1[0m[95m-8[0m[93m01[0m 11  [95mh[0m[91mv[0m[95m1[0m[95m-8[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m2[0m[95m-26[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m2[0m[95m-5[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m2[0m[95m-5[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m2[0m[95m-5[0m[93m04[0m 0  [95mh[0m[91mv[0m[95m2[0m[95m-5[0m[93m05[0m 0  [95mh[0m[91mv[0m[95m2[0m[95m-5[0m[93m06[0m 0  [95mh[0m[91mv[0m[95m2[0m[95m-5[0m[93m09[0m 0  [95mh[0m[91mv[0m[95m2[0m[95m-70[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m2[0m[95m-70[0m[93m10[0m 0  [95mh[0m[91mv[0m[95m2[0m[95m-70[0m[93m11[0m 0  [95mh[0m[91mv[0m[95m2[0m[95m-70[0m[93m12[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-11[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-11[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-11[0m[93m05[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-13[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-13[0m[93m04[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-13[0m[93m05[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-15[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-15[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-15[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-15[0m[93m05[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-15[0m[93m06[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-15[0m[93m07[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-15[0m[93m08[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-20[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-21[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-21[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-21[0m[93m04[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-23[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-23[0m[93m04[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-23[0m[93m05[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-30[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-30[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-30[0m[93m04[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-30[0m[93m05[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-30[0m[93m06[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-30[0m[93m07[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-30[0m[93m08[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-30[0m[93m09[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-30[0m[93m10[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-30[0m[93m11[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-30[0m[93m12[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-30[0m[93m13[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-30[0m[93m14[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-30[0m[93m15[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-30[0m[93m16[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-30[0m[93m17[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-30[0m[93m18[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-30[0m[93m19[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-30-3[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-30-3[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-33[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-33[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-33[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-33[0m[93m04[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-33[0m[93m05[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-33[0m[93m06[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-43[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-48[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-48[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-49[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-49[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-49[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-49[0m[93m05[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-53[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-53[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-53[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-53[0m[93m04[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-64[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-64[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-64[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-64[0m[93m05[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-66[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-66[0m[93m04[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-7[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-7[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-72[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-73[0m[93m01[0m 1  [95mh[0m[91mv[0m[95m3[0m[95m-73[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-74[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-74[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-9[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m3[0m[95m-9[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-28[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-28[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-28[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-28[0m[93m04[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-28[0m[93m05[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-28[0m[93m06[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-28[0m[93m07[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-30-2[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-30-2[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-30-2[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-30-2[0m[93m05[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-30-2[0m[93m06[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-30-4[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-30-4[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-31[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-31[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-31[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-31[0m[93m04[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-31[0m[93m05[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-31[0m[93m10[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-34[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-34[0m[93m04[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-34[0m[93m05[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-34[0m[93m08[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-34[0m[93m10[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-34[0m[93m11[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-34[0m[93m12[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-38-2[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-38-2[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-39[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-39[0m[93m05[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-39[0m[93m06[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-39[0m[93m07[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-4[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-4[0m[93m02[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-4[0m[93m08[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-59[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-59[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-59[0m[93m04[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-59[0m[93m05[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-59[0m[93m06[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-59[0m[93m07[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-59[0m[93m08[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-61[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m4[0m[95m-61[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m5[0m[95m-10-1[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m5[0m[95m-10-1[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m5[0m[95m-51[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m5[0m[95m-51[0m[93m03[0m 0  [95mh[0m[91mv[0m[95m5[0m[95m-51[0m[93m04[0m 0  [95mh[0m[91mv[0m[95m6[0m[95m-1[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m7[0m[95m-4-1[0m[93m01[0m 0  [95mh[0m[91mv[0m[95m7[0m[95m-4-1[0m[93m04[0m 0  [95mh[0m[91mv[0m[95m7[0m[95m-4-1[0m[93m05[0m 0
smith-waterman  (new-allele fitting)
  vsearch: 2393 / 2562 v annotations (169 failed) with 44 v genes in 0.4 sec
  removing old sw cache test/new-results/test/parameters/simu/sw-cache
    running 10 procs for 2562 seqs
    running 10 procs for 24 seqs
      info for 2554 / 2562 = 0.997   (8 failed)
      kept 1573 (0.614) unproductive
    water time: 5.3  (ig-sw 0.1  processing 0.1)
    <only_csv> not yet implemented in allelefinder
smith-waterman  (writing parameters)
  vsearch: 2393 / 2562 v annotations (169 failed) with 44 v genes in 0.6 sec
    running 10 procs for 2554 seqs
    running 10 procs for 16 seqs
      info for 2554 / 2562 = 0.997   (8 failed)
      kept 1573 (0.614) unproductive
        writing sw results to test/new-results/test/parameters/simu/sw-cache
  plotting parameters (3.1 sec)
    writing parameters (5.1 sec)
    water time: 15.7  (ig-sw 10.1  processing 0.2)
    keeping 18 / 28 d genes
    [91mmissing[0m 10 simulation genes (counts): [95mh[0m[91md[0m[95m1[0m[95m-20[0m[93m01[0m 42  [95mh[0m[91md[0m[95m1[0m[95m-7[0m[93m01[0m 9  [95mh[0m[91md[0m[95m2[0m[95m-2[0m[93m02[0m 44  [95mh[0m[91md[0m[95m2[0m[95m-2[0m[93m03[0m 20  [95mh[0m[91md[0m[95m2[0m[95m-21[0m[93m01[0m 48  [95mh[0m[91md[0m[95m2[0m[95m-8[0m[93m02[0m 15  [95mh[0m[91md[0m[95m3[0m[95m-16[0m[93m01[0m 30  [95mh[0m[91md[0m[95m3[0m[95m-3[0m[93m01[0m 45  [95mh[0m[91md[0m[95m3[0m[95m-9[0m[93m01[0m 37  [95mh[0m[91md[0m[95m6[0m[95m-13[0m[93m01[0m 103
    keeping 7 / 13 j genes
    [91mmissing[0m 6 simulation genes (counts): [95mh[0m[91mj[0m[95m3[0m[93m01[0m 21  [95mh[0m[91mj[0m[95m4[0m[93m01[0m 0  [95mh[0m[91mj[0m[95m4[0m[93m03[0m 0  [95mh[0m[91mj[0m[95m5[0m[93m01[0m 8  [95mh[0m[91mj[0m[95m6[0m[93m03[0m 161  [95mh[0m[91mj[0m[95m6[0m[93m04[0m 0
  (not actually removing d and j alleleremover genes)
  writing hmms (1.6 sec)
hmm
    prepare_for_hmm: (0.3 sec)
    running 10 procs
                    calcd:         vtb 2554        fwd    0
             min-max time:  5.6 - 7.9 sec
    read output
  plotting parameters (2.8 sec)
  plotting parameters (3.0 sec)
    writing parameters (5.1 sec)
    writing parameters (2.7 sec)
        processed 2554 hmm output lines with 2553 sequences in 2553 events  (1 failures)
            [91mwarning[0m skipped 1 invalid events
         infra time: 19.7
      hmm step time: 27.8
  writing hmms (1.7 sec)
      total time: 55.3
[92mannotate-new-simu[0m                ./bin/partis annotate --plot-annotation-performance --plotdir test/new-results/annotate-new-simu-annotation-performance --only-csv-plots --only-overall-plots --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/annotate-new-simu.csv
annotating
smith-waterman
  vsearch: 2393 / 2562 v annotations (169 failed) with 43 v genes in 0.4 sec
        reading sw results from test/new-results/test/parameters/simu/sw-cache
      info for 2554 / 2562 = 0.997   (8 failed)
      kept 1573 (0.614) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 14 queries with different true and inferred net shm indel lengths: 1667014127108520889 -1698125377776887754 -6592981928632373576 3411555643997713375 -1223213546020366966 -5730441331628128067 2447496209938796791 6480740913865585177 2712916551846080017 1284982905843564095 3501569511712948868 299191433789177356 -1057333660992891686 -8866798616931867804
(0.8 sec)
        water time: 3.0
hmm
    prepare_for_hmm: (0.3 sec)
    running 10 procs
                    calcd:         vtb 2554        fwd    0
             min-max time:  5.1 - 5.4 sec
    read output
  plotting performance (0.7 sec)
        processed 2554 hmm output lines with 2553 sequences in 2553 events  (1 failures)
          [91mwarning[0m no valid paths: -2945885595145226818
         infra time: 5.3
      hmm step time: 10.9
      total time: 14.9
[92mmulti-annotate-new-simu[0m          ./bin/partis annotate --plot-annotation-performance --simultaneous-true-clonal-seqs --plotdir test/new-results/multi-annotate-new-simu-annotation-performance --only-csv-plots --only-overall-plots --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/multi-annotate-new-simu.csv
annotating
smith-waterman
  vsearch: 2393 / 2562 v annotations (169 failed) with 43 v genes in 0.4 sec
        reading sw results from test/new-results/test/parameters/simu/sw-cache
      info for 2554 / 2562 = 0.997   (8 failed)
      kept 1573 (0.614) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 14 queries with different true and inferred net shm indel lengths: 1667014127108520889 -1698125377776887754 -6592981928632373576 3411555643997713375 -1223213546020366966 -5730441331628128067 2447496209938796791 6480740913865585177 2712916551846080017 1284982905843564095 3501569511712948868 299191433789177356 -1057333660992891686 -8866798616931867804
(0.7 sec)
        water time: 2.6
hmm
  [93mwarning[0m split apart 6 clusters that contained multiple cdr3 lengths (total clusters: 484 --> 490)
    prepare_for_hmm: (0.2 sec)
    running 10 procs
                    calcd:         vtb  490        fwd    0
             min-max time:  2.9 - 4.9 sec
    read output
  plotting performance (0.8 sec)
        processed 490 hmm output lines with 2554 sequences in 490 events  (0 failures)
         infra time: 3.2
      hmm step time: 8.3
      total time: 11.9
[92mpartition-new-simu[0m               ./bin/partis partition --n-max-queries 500 --n-precache-procs 10 --plot-annotation-performance --biggest-logprob-cluster-to-calculate 5 --biggest-naive-seq-cluster-to-calculate 5 --persistent-cachefname test/new-results/cache-new-partition.csv --plotdir test/new-results/partition-new-simu-annotation-performance --only-csv-plots --only-overall-plots --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/partition-new-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman
  vsearch: 485 / 500 v annotations (15 failed) with 30 v genes in 0.1 sec
        reading sw results from test/new-results/test/parameters/simu/sw-cache
      info for 500 / 500 = 1.000   (0 failed)
      kept 306 (0.612) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 9 queries with different true and inferred net shm indel lengths: 1667014127108520889 -1698125377776887754 -6592981928632373576 3411555643997713375 -1223213546020366966 -5730441331628128067 2447496209938796791 6480740913865585177 2712916551846080017
(0.8 sec)
        water time: 1.6
hmm
caching all 500 naive sequences
    prepare_for_hmm: (0.1 sec)
    running 10 procs
                no/empty cache file
                    calcd:         vtb 500        fwd   0
                   merged:       hfrac   0     lratio   0
             min-max time:  1.7 - 2.0 sec
      hmm step time: 2.2
   collapsed 500 queries into 282 clusters with identical naive seqs (0.0 sec)
282 clusters with 10 procs
    prepare_for_hmm: (0.0 sec)
       naive hfrac bounds: 0.015 0.106   (0.105 mean mutation in parameter dir test/new-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 500   logprobs   0
                    calcd:         vtb 106        fwd 135
                   merged:       hfrac  38     lratio  14
             min-max time:  0.7 - 3.3 sec
         infra time: 0.2
      hmm step time: 3.5
230 clusters with 7 procs
    prepare_for_hmm: (0.0 sec)
    running 7 procs
          read from cache:  naive-seqs 622   logprobs 135
                    calcd:         vtb  40        fwd  77
                   merged:       hfrac  27     lratio   9
             min-max time:  0.4 - 2.4 sec
      hmm step time: 2.5
194 clusters with 5 procs
    prepare_for_hmm: (0.0 sec)
    running 5 procs
          read from cache:  naive-seqs 665   logprobs 212
                    calcd:         vtb  33        fwd  55
                   merged:       hfrac  26     lratio   6
             min-max time:  1.2 - 2.1 sec
      hmm step time: 2.3
162 clusters with 3 procs
    prepare_for_hmm: (0.0 sec)
    running 3 procs
          read from cache:  naive-seqs 706   logprobs 267
                    calcd:         vtb  26        fwd  67
                   merged:       hfrac  14     lratio   9
             min-max time:  1.5 - 4.6 sec
      hmm step time: 4.8
139 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 739   logprobs 334
                    calcd:         vtb  20        fwd  67
                   merged:       hfrac  12     lratio  11
             min-max time:  3.3 - 7.0 sec
      hmm step time: 7.2
116 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 768   logprobs 401
                    calcd:         vtb   9        fwd  27
                   merged:       hfrac   6     lratio   4
             min-max time:  1.3 - 3.3 sec
      hmm step time: 3.4
106 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 781   logprobs 428
                    calcd:         vtb   3        fwd  12
                   merged:       hfrac   4     lratio   0
             min-max time:  0.8 - 2.0 sec
      hmm step time: 2.1
102 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 787   logprobs 440
                    calcd:         vtb   1        fwd   8
                   merged:       hfrac   0     lratio   1
             min-max time:  0.2 - 1.4 sec
      hmm step time: 1.5
101 clusters with 1 proc
    prepare_for_hmm: (0.0 sec)
    running 1 proc
          read from cache:  naive-seqs 788   logprobs 448
                    calcd:         vtb   3        fwd  70
                   merged:       hfrac   0     lratio   3
                     time:  6.1 sec
      hmm step time: 6.3
      loop time: 33.6
getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 10 procs
                    calcd:         vtb  98        fwd   0
             min-max time:  0.8 - 1.3 sec
      hmm step time: 1.4
    read output
  plotting performance (1.0 sec)
        processed 98 hmm output lines with 500 sequences in 98 events  (0 failures)
  --only-csv-plots not implemented for partition plots, so skipping
      total time: 40.6
[92mseed-partition-new-simu[0m          ./bin/partis partition --n-max-queries 500 --persistent-cachefname test/new-results/cache-new-partition.csv --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed-unique-id 9005994567486518305 --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/seed-partition-new-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman
  vsearch: 485 / 500 v annotations (15 failed) with 30 v genes in 0.1 sec
        reading sw results from test/new-results/test/parameters/simu/sw-cache
      info for 500 / 500 = 1.000   (0 failed)
      kept 306 (0.612) unproductive
      removed 428 / 500 = 0.86 sequences with cdr3 length different from seed sequence (leaving 72)
        water time: 0.4
hmm
   collapsed 72 queries into 46 clusters with identical naive seqs (0.0 sec)
46 clusters with 10 procs
    prepare_for_hmm: (0.0 sec)
       naive hfrac bounds: 0.015 0.106   (0.105 mean mutation in parameter dir test/new-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 792   logprobs 518
                    calcd:         vtb  12        fwd  15
                   merged:       hfrac   0     lratio   4
             min-max time:  0.0 - 0.6 sec
      hmm step time: 0.7
51 clusters with 7 procs
    prepare_for_hmm: (0.0 sec)
    running 7 procs
          read from cache:  naive-seqs 804   logprobs 533
                    calcd:         vtb   0        fwd   2
                   merged:       hfrac   0     lratio   0
             min-max time:  0.0 - 0.5 sec
      hmm step time: 0.5
48 clusters with 5 procs
    prepare_for_hmm: (0.0 sec)
    running 5 procs
          read from cache:  naive-seqs 804   logprobs 535
                    calcd:         vtb   0        fwd   4
                   merged:       hfrac   0     lratio   0
             min-max time:  0.0 - 0.5 sec
      hmm step time: 0.5
      removed 67 sequences in unseeded clusters, split 5 seeded clusters into 5 singletons, and merged these into 5 clusters with identical naive seqs
        new n_procs 1 (initial seqs/proc: 7.20   new seqs/proc: 5.00
5 clusters with 1 proc
    prepare_for_hmm: (0.0 sec)
    running 1 proc
          read from cache:  naive-seqs 804   logprobs 539
                    calcd:         vtb   2        fwd   8
                   merged:       hfrac   1     lratio   2
                     time:  0.6 sec
      hmm step time: 0.7
      loop time: 2.5
getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 2 procs
                    calcd:         vtb   2        fwd   0
             min-max time:  0.2 - 0.2 sec
      hmm step time: 0.2
    read output
        processed 2 hmm output lines with 5 sequences in 2 events  (0 failures)
      total time: 3.5
[92mvsearch-partition-new-simu[0m       ./bin/partis partition --naive-vsearch --n-max-queries 500 --persistent-cachefname test/new-results/cache-new-partition.csv --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/vsearch-partition-new-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman
  vsearch: 485 / 500 v annotations (15 failed) with 30 v genes in 0.1 sec
        reading sw results from test/new-results/test/parameters/simu/sw-cache
      info for 500 / 500 = 1.000   (0 failed)
      kept 306 (0.612) unproductive
        water time: 0.4
hmm
       naive hfrac bounds: 0.031 0.031   (0.105 mean mutation in parameter dir test/new-results/test/parameters/simu/hmm)
        collapsed 500 sequences into 282 unique naive sequences
    using hfrac bound for vsearch 0.031
    running vsearch 27 times (once for each cdr3 length class): . . . . . . . . . . . . . . . . . . . . . . . . . . . 
      vsearch time: 1.2
getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 10 procs
                    calcd:         vtb 119        fwd   0
             min-max time:  0.9 - 1.4 sec
      hmm step time: 1.5
    read output
        processed 119 hmm output lines with 500 sequences in 119 events  (0 failures)
      total time: 3.7
