[92mannotate-ref-simu[0m                ./bin/partis annotate --plot-annotation-performance --plotdir test/new-results/annotate-ref-simu-annotation-performance --only-csv-plots --is-simu --sw-cachefname test/reference-results/test/parameters/simu/sw-cache.csv --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/annotate-ref-simu.csv
annotating
smith-waterman 
        reading sw results from test/reference-results/test/parameters/simu/sw-cache
      info for 2585 / 2585 = 1.000   (0 failed)
      kept 1798 (0.696) unproductive
    2173706262152075878 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -4100183686560505839 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    567944520367113420 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    1027204433292299981 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    5716283203692768398 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    1535023322816969525 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    9074081854831124830 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7538163976229077410 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7538163976229077409 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -132447434639868537 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -845657749480897234 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -3749292409839134886 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -6180585439470181633 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.3 sec)
        water time: 2.8
hmm
    prepare_for_hmm: (0.3 sec)
    running 10 procs
                    calcd:         vtb 2585        fwd    0
             min-max time:  6.0 - 6.4 sec
    read output
    -4100183686560505839 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -6180585439470181633 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    567944520367113420 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    5716283203692768398 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    9074081854831124830 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7538163976229077410 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -845657749480897234 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    1027204433292299981 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7538163976229077409 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -3749292409839134886 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    1535023322816969525 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    2173706262152075878 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -132447434639868537 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.4 sec)
        processed 2585 hmm output lines with 2585 sequences in 2585 events  (0 failures)
         infra time: 4.7
      hmm step time: 11.2
      total time: 14.5
[92mmulti-annotate-ref-simu[0m          ./bin/partis annotate --plot-annotation-performance --simultaneous-true-clonal-seqs --plotdir test/new-results/multi-annotate-ref-simu-annotation-performance --only-csv-plots --is-simu --sw-cachefname test/reference-results/test/parameters/simu/sw-cache.csv --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/multi-annotate-ref-simu.csv
annotating
smith-waterman 
        reading sw results from test/reference-results/test/parameters/simu/sw-cache
      info for 2585 / 2585 = 1.000   (0 failed)
      kept 1798 (0.696) unproductive
    2173706262152075878 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -4100183686560505839 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    567944520367113420 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    1027204433292299981 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    5716283203692768398 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    1535023322816969525 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    9074081854831124830 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7538163976229077410 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7538163976229077409 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -132447434639868537 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -845657749480897234 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -3749292409839134886 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -6180585439470181633 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.3 sec)
        water time: 2.4
hmm
  [93mwarning[0m split apart 8 clusters that contained multiple cdr3 lengths (total clusters: 458 --> 467)
    prepare_for_hmm: (0.2 sec)
    running 10 procs
                    calcd:         vtb  467        fwd    0
             min-max time:  3.9 - 5.7 sec
    read output
    5716283203692768398 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    9074081854831124830 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    1027204433292299981 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -6180585439470181633 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -4100183686560505839 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    2173706262152075878 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    567944520367113420 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -3749292409839134886 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7538163976229077410 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7538163976229077409 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -845657749480897234 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    1535023322816969525 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -132447434639868537 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.4 sec)
        processed 467 hmm output lines with 2585 sequences in 467 events  (0 failures)
         infra time: 2.8
      hmm step time: 8.7
      total time: 11.7
[92mpartition-ref-simu[0m               ./bin/partis partition --n-max-queries 500 --n-precache-procs 10 --plot-annotation-performance --biggest-logprob-cluster-to-calculate 5 --biggest-naive-seq-cluster-to-calculate 5 --persistent-cachefname test/new-results/cache-ref-partition.csv --plotdir test/new-results/partition-ref-simu-annotation-performance --only-csv-plots --is-simu --sw-cachefname test/reference-results/test/parameters/simu/sw-cache.csv --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/partition-ref-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
        reading sw results from test/reference-results/test/parameters/simu/sw-cache
      info for 500 / 500 = 1.000   (0 failed)
      kept 371 (0.742) unproductive
    2173706262152075878 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -4100183686560505839 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    567944520367113420 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    1027204433292299981 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    5716283203692768398 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.3 sec)
        water time: 1.3
hmm
caching all 500 naive sequences
    prepare_for_hmm: (0.1 sec)
    running 10 procs
                no/empty cache file
                    calcd:         vtb 500        fwd   0
                   merged:       hfrac   0     lratio   0
             min-max time:  1.8 - 2.2 sec
      hmm step time: 2.4
   collapsed 500 queries into 309 clusters with identical naive seqs (0.0 sec)
309 clusters with 10 procs
    prepare_for_hmm: (0.0 sec)
       naive hfrac bounds: 0.015 0.110   (0.114 mean mutation in parameter dir test/reference-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 500   logprobs   0
                    calcd:         vtb 124        fwd 197
                   merged:       hfrac 577     lratio  37
             min-max time:  1.3 - 4.0 sec
         infra time: 0.1
      hmm step time: 4.2
245 clusters with 7 procs
    prepare_for_hmm: (0.0 sec)
    running 7 procs
          read from cache:  naive-seqs 635   logprobs 197
                    calcd:         vtb  38        fwd  87
                   merged:       hfrac 479     lratio  19
             min-max time:  1.6 - 2.8 sec
      hmm step time: 3.0
205 clusters with 5 procs
    prepare_for_hmm: (0.0 sec)
    running 5 procs
          read from cache:  naive-seqs 683   logprobs 284
                    calcd:         vtb  39        fwd  78
                   merged:       hfrac 426     lratio  18
             min-max time:  1.3 - 3.6 sec
      hmm step time: 3.7
166 clusters with 3 procs
    prepare_for_hmm: (0.0 sec)
    running 3 procs
          read from cache:  naive-seqs 727   logprobs 362
                    calcd:         vtb  25        fwd  56
                   merged:       hfrac 443     lratio  10
             min-max time:  2.7 - 3.7 sec
      hmm step time: 3.9
141 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 760   logprobs 418
                    calcd:         vtb  25        fwd  65
                   merged:       hfrac 525     lratio  15
             min-max time:  6.1 - 6.4 sec
      hmm step time: 6.6
111 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 799   logprobs 483
                    calcd:         vtb   8        fwd  28
                   merged:       hfrac 246     lratio   5
             min-max time:  3.5 - 4.4 sec
      hmm step time: 4.5
103 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 810   logprobs 511
                    calcd:         vtb   3        fwd   8
                   merged:       hfrac 198     lratio   2
             min-max time:  0.6 - 1.0 sec
      hmm step time: 1.1
100 clusters with 1 proc
    prepare_for_hmm: (0.0 sec)
    running 1 proc
          read from cache:  naive-seqs 814   logprobs 519
                    calcd:         vtb   5        fwd  65
                   merged:       hfrac 398     lratio   1
                     time:  8.5 sec
      hmm step time: 8.6
      loop time: 35.7
getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 10 procs
                    calcd:         vtb  95        fwd   0
             min-max time:  1.0 - 1.7 sec
      hmm step time: 1.8
    read output
    5716283203692768398 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    1027204433292299981 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    567944520367113420 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    2173706262152075878 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -4100183686560505839 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.4 sec)
        processed 95 hmm output lines with 500 sequences in 95 events  (0 failures)
  plotting partitions
subclusters
[91mhey[0m decide how you want to do these imports
[91mhey[0m decide how you want to do these imports
[91mhey[0m decide how you want to do these imports
[91mhey[0m decide how you want to do these imports
[91mhey[0m decide how you want to do these imports
[91mhey[0m decide how you want to do these imports
[91mhey[0m decide how you want to do these imports
[91mhey[0m decide how you want to do these imports
[91mhey[0m decide how you want to do these imports
[91mhey[0m decide how you want to do these imports
[91mhey[0m decide how you want to do these imports
[91mhey[0m decide how you want to do these imports
    skipped 83 clusters with lengths: 9 9 9 9 8 8 8 8 8 8 8 8 8 7 7 7 7 7 6 5 5 5 5 5 5 5 4 4 4 4 4 4 4 3 3 3 3 3 3 3 3 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
(9.5 sec)
      total time: 51.7
[92mseed-partition-ref-simu[0m          ./bin/partis partition --n-max-queries 500 --persistent-cachefname test/new-results/cache-ref-partition.csv --is-simu --sw-cachefname test/reference-results/test/parameters/simu/sw-cache.csv --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed-unique-id 3010205122972849674 --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/seed-partition-ref-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
        reading sw results from test/reference-results/test/parameters/simu/sw-cache
      info for 500 / 500 = 1.000   (0 failed)
      kept 371 (0.742) unproductive
      removed 453 / 500 = 0.91 sequences with cdr3 length different from seed sequence (leaving 47)
        water time: 0.4
hmm
   collapsed 47 queries into 39 clusters with identical naive seqs (0.0 sec)
39 clusters with 10 procs
    prepare_for_hmm: (0.0 sec)
       naive hfrac bounds: 0.015 0.110   (0.114 mean mutation in parameter dir test/reference-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 821   logprobs 584
                    calcd:         vtb  16        fwd   8
                   merged:       hfrac  46     lratio   2
             min-max time:  0.1 - 0.6 sec
      hmm step time: 0.6
45 clusters with 7 procs
    prepare_for_hmm: (0.0 sec)
    running 7 procs
          read from cache:  naive-seqs 828   logprobs 590
                    calcd:         vtb   0        fwd   2
                   merged:       hfrac  35     lratio   0
             min-max time:  0.0 - 0.3 sec
      hmm step time: 0.4
42 clusters with 5 procs
    prepare_for_hmm: (0.0 sec)
    running 5 procs
          read from cache:  naive-seqs 828   logprobs 592
                    calcd:         vtb   0        fwd   2
                   merged:       hfrac  35     lratio   0
             min-max time:  0.0 - 0.5 sec
      hmm step time: 0.5
      removed 40 sequences in unseeded clusters, split 5 seeded clusters into 7 singletons, and merged these into 4 clusters with identical naive seqs
        new n_procs 1 (initial seqs/proc: 4.70   new seqs/proc: 4.00
4 clusters with 1 proc
    prepare_for_hmm: (0.0 sec)
    running 1 proc
          read from cache:  naive-seqs 828   logprobs 594
                    calcd:         vtb   4        fwd   6
                   merged:       hfrac   9     lratio   2
                     time:  0.5 sec
      hmm step time: 0.5
      loop time: 2.1
getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 1 proc
                    calcd:         vtb   1        fwd   0
                     time:  0.1 sec
      hmm step time: 0.2
    read output
        processed 1 hmm output lines with 7 sequences in 1 events  (0 failures)
      total time: 2.8
[92mvsearch-partition-ref-simu[0m       ./bin/partis partition --naive-vsearch --n-max-queries 500 --persistent-cachefname test/new-results/cache-ref-partition.csv --is-simu --sw-cachefname test/reference-results/test/parameters/simu/sw-cache.csv --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/vsearch-partition-ref-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
        reading sw results from test/reference-results/test/parameters/simu/sw-cache
      info for 500 / 500 = 1.000   (0 failed)
      kept 371 (0.742) unproductive
        water time: 0.4
hmm
       naive hfrac bounds: 0.033 0.033   (0.114 mean mutation in parameter dir test/reference-results/test/parameters/simu/hmm)
        collapsed 500 sequences into 309 unique naive sequences
    using hfrac bound for vsearch 0.033
    running vsearch 24 times (once for each cdr3 length class): . . . . . . . . . . . . . . . . . . . . . . . . 
      vsearch time: 1.1
getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 10 procs
                    calcd:         vtb 135        fwd   0
             min-max time:  1.1 - 1.9 sec
      hmm step time: 2.0
    read output
        processed 135 hmm output lines with 500 sequences in 135 events  (0 failures)
      total time: 3.8
[92mcache-parameters-data[0m            ./bin/partis cache-parameters --plotdir test/new-results/test/plots/data --only-csv-plots --only-overall-plots --sw-cachefname test/new-results/test/parameters/data/sw-cache.csv --infname test/mishmash.fa --parameter-dir test/new-results/test/parameters/data --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human
caching parameters
vsearch: 1273 / 1412 v annotations (139 failed) in 0.1 sec
    keeping 68 / 239 v genes
smith-waterman 
  removing old sw cache test/new-results/test/parameters/data/sw-cache
         step  seqs    procs     ig-sw time    processing time
           1    1412     10        1.1                0.6
           2    301      10        0.3                0.1
           3    119      10        0.2                0.0
           4    72       7         0.1                0.0
      info for 1344 / 1412 = 0.952   (68 failed)
      kept 413 (0.292) unproductive
      removed 23 / 1344 = 0.02 duplicate sequences after trimming framework insertions (leaving 1321)
        water time: 2.6
  no queries for allele finding
[94mtry 0[0m: looking for new alleles among 0 genes (0 genes didn't have enough counts)
    plotting allele finding     <only_csv> not yet implemented in allelefinder
smith-waterman   (writing parameters) 
         step  seqs    procs     ig-sw time    processing time
           1    1344     10        1.0                0.6
           2    233      10        0.2                0.1
           3    51       5         0.1                0.0
           4    4        1         0.0                0.0
      info for 1344 / 1412 = 0.952   (68 failed)
      kept 413 (0.292) unproductive
      removed 23 / 1344 = 0.02 duplicate sequences after trimming framework insertions (leaving 1321)
        writing sw results to test/new-results/test/parameters/data/sw-cache
  plotting parameters (3.2 sec)
    writing parameters (2.5 sec)
        water time: 8.6
  writing hmms (2.3 sec)
hmm
    prepare_for_hmm: (0.1 sec)
    running 10 procs
                    calcd:         vtb 1321        fwd    0
             min-max time:  5.2 - 9.0 sec
    read output
  plotting parameters (2.8 sec)
    writing parameters (2.4 sec)
        processed 1321 hmm output lines with 1320 sequences in 1320 events  (1 failures)
            [91mwarning[0m skipped 1 invalid events
         infra time: 6.9
      hmm step time: 16.0
  writing hmms (2.1 sec)
      total time: 32.6
[92msimulate[0m                         ./bin/partis simulate --n-sim-events 500 --n-trees 500 --n-leaves 5 --parameter-dir test/new-results/test/parameters/data --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/test/simu.csv --indel-frequency 0.01 --indel-location v
simulating
   read 500 events from 10 files
      total time: 4.1
[92mcache-parameters-simu[0m            ./bin/partis cache-parameters --plotdir test/new-results/test/plots/simu --only-csv-plots --only-overall-plots --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human
caching parameters
vsearch: 2531 / 2588 v annotations (57 failed) in 0.2 sec
    keeping 47 / 239 v genes
smith-waterman 
  removing old sw cache test/new-results/test/parameters/simu/sw-cache
         step  seqs    procs     ig-sw time    processing time
           1    2588     10        3.0                1.2
           2    231      10        0.3                0.1
           3    32       3         0.1                0.0
           4    1        1         0.0                0.0
      info for 2587 / 2588 = 1.000   (1 failed)
      kept 1753 (0.677) unproductive
        water time: 4.9
[94mtry 0[0m: looking for new alleles among 0 genes (46 genes didn't have enough counts)
    plotting allele finding     <only_csv> not yet implemented in allelefinder
smith-waterman   (writing parameters) 
         step  seqs    procs     ig-sw time    processing time
           1    2587     10        3.0                1.2
           2    230      10        0.4                0.1
           3    31       3         0.1                0.0
      info for 2587 / 2588 = 1.000   (1 failed)
      kept 1753 (0.677) unproductive
        writing sw results to test/new-results/test/parameters/simu/sw-cache
  plotting parameters (2.8 sec)
    writing parameters (2.4 sec)
        water time: 12.1
  writing hmms (1.6 sec)
hmm
    prepare_for_hmm: (0.3 sec)
    running 10 procs
                    calcd:         vtb 2587        fwd    0
             min-max time:  6.0 - 6.6 sec
    read output
  plotting parameters (2.6 sec)
  plotting parameters (2.9 sec)
    writing parameters (2.5 sec)
    writing parameters (1.6 sec)
        processed 2587 hmm output lines with 2587 sequences in 2587 events  (0 failures)
         infra time: 15.3
      hmm step time: 22.1
  writing hmms (1.7 sec)
      total time: 44.5
[92mannotate-new-simu[0m                ./bin/partis annotate --plot-annotation-performance --plotdir test/new-results/annotate-new-simu-annotation-performance --only-csv-plots --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/annotate-new-simu.csv
annotating
smith-waterman 
        reading sw results from test/new-results/test/parameters/simu/sw-cache
      info for 2587 / 2588 = 1.000   (1 failed)
      kept 1753 (0.677) unproductive
    2570792715206825358 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    2353525297554906415 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    3185602433054030216 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -2666098280805240715 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7790136593313351660 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    2691077690003538679 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -5831361237041547463 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -5709204211324813968 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.3 sec)
        water time: 2.5
hmm
    prepare_for_hmm: (0.3 sec)
    running 10 procs
                    calcd:         vtb 2587        fwd    0
             min-max time:  6.3 - 6.8 sec
    read output
    -2666098280805240715 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -5831361237041547463 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -5709204211324813968 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7790136593313351660 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    2570792715206825358 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    2353525297554906415 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    3185602433054030216 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    2691077690003538679 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.4 sec)
        processed 2587 hmm output lines with 2587 sequences in 2587 events  (0 failures)
         infra time: 4.7
      hmm step time: 11.6
      total time: 14.7
[92mmulti-annotate-new-simu[0m          ./bin/partis annotate --plot-annotation-performance --simultaneous-true-clonal-seqs --plotdir test/new-results/multi-annotate-new-simu-annotation-performance --only-csv-plots --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/multi-annotate-new-simu.csv
annotating
smith-waterman 
        reading sw results from test/new-results/test/parameters/simu/sw-cache
      info for 2587 / 2588 = 1.000   (1 failed)
      kept 1753 (0.677) unproductive
    2570792715206825358 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    2353525297554906415 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    3185602433054030216 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -2666098280805240715 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7790136593313351660 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    2691077690003538679 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -5831361237041547463 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -5709204211324813968 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.3 sec)
        water time: 2.4
hmm
  [93mwarning[0m split apart 4 clusters that contained multiple cdr3 lengths (total clusters: 465 --> 469)
    prepare_for_hmm: (0.2 sec)
    running 10 procs
                    calcd:         vtb  469        fwd    0
             min-max time:  3.5 - 5.7 sec
    read output
    3185602433054030216 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -7790136593313351660 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    2353525297554906415 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    2570792715206825358 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    2691077690003538679 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -5831361237041547463 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -5709204211324813968 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
    -2666098280805240715 true and inferred shm net indel lengths different, so skipping rest of performance evaluation
  plotting performance (0.4 sec)
        processed 469 hmm output lines with 2587 sequences in 469 events  (0 failures)
         infra time: 2.9
      hmm step time: 8.6
      total time: 11.7
[92mpartition-new-simu[0m               ./bin/partis partition --n-max-queries 500 --n-precache-procs 10 --plot-annotation-performance --biggest-logprob-cluster-to-calculate 5 --biggest-naive-seq-cluster-to-calculate 5 --persistent-cachefname test/new-results/cache-new-partition.csv --plotdir test/new-results/partition-new-simu-annotation-performance --only-csv-plots --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/partition-new-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
        reading sw results from test/new-results/test/parameters/simu/sw-cache
      info for 499 / 500 = 0.998   (1 failed)
      kept 341 (0.682) unproductive
  plotting performance (0.3 sec)
        water time: 1.3
hmm
caching all 499 naive sequences
    prepare_for_hmm: (0.1 sec)
    running 10 procs
                no/empty cache file
                    calcd:         vtb 499        fwd   0
                   merged:       hfrac   0     lratio   0
             min-max time:  2.1 - 2.6 sec
      hmm step time: 2.7
   collapsed 499 queries into 291 clusters with identical naive seqs (0.0 sec)
291 clusters with 10 procs
    prepare_for_hmm: (0.0 sec)
       naive hfrac bounds: 0.015 0.110   (0.113 mean mutation in parameter dir test/new-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 499   logprobs   0
                    calcd:         vtb 112        fwd 171
                   merged:       hfrac 462     lratio  21
             min-max time:  1.7 - 3.7 sec
         infra time: 0.1
      hmm step time: 3.9
245 clusters with 7 procs
    prepare_for_hmm: (0.0 sec)
    running 7 procs
          read from cache:  naive-seqs 620   logprobs 171
                    calcd:         vtb  40        fwd 117
                   merged:       hfrac 505     lratio  19
             min-max time:  1.5 - 4.9 sec
      hmm step time: 5.0
208 clusters with 5 procs
    prepare_for_hmm: (0.0 sec)
    running 5 procs
          read from cache:  naive-seqs 664   logprobs 288
                    calcd:         vtb  39        fwd  82
                   merged:       hfrac 556     lratio  12
             min-max time:  2.1 - 6.5 sec
      hmm step time: 6.7
170 clusters with 3 procs
    prepare_for_hmm: (0.0 sec)
    running 3 procs
          read from cache:  naive-seqs 711   logprobs 370
                    calcd:         vtb  21        fwd  80
                   merged:       hfrac 577     lratio  13
             min-max time:  5.1 - 5.6 sec
      hmm step time: 5.7
143 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 743   logprobs 450
                    calcd:         vtb  14        fwd  45
                   merged:       hfrac 522     lratio   5
             min-max time:  7.0 - 7.1 sec
      hmm step time: 7.3
128 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 763   logprobs 495
                    calcd:         vtb  12        fwd  39
                   merged:       hfrac 436     lratio   6
             min-max time:  3.0 - 5.4 sec
      hmm step time: 5.5
115 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 780   logprobs 534
                    calcd:         vtb   7        fwd  19
                   merged:       hfrac 287     lratio   4
             min-max time:  1.7 - 3.5 sec
      hmm step time: 3.6
107 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 790   logprobs 553
                    calcd:         vtb   1        fwd  14
                   merged:       hfrac 242     lratio   1
             min-max time:  1.5 - 2.9 sec
      hmm step time: 3.0
105 clusters with 1 proc
    prepare_for_hmm: (0.0 sec)
    running 1 proc
          read from cache:  naive-seqs 793   logprobs 567
                    calcd:         vtb   1        fwd  60
                   merged:       hfrac 439     lratio   1
                     time:  9.6 sec
      hmm step time: 9.8
      loop time: 50.6
getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 10 procs
                    calcd:         vtb 104        fwd   0
             min-max time:  0.8 - 1.9 sec
      hmm step time: 2.0
    read output
  plotting performance (0.3 sec)
        processed 104 hmm output lines with 499 sequences in 104 events  (0 failures)
  plotting partitions
subclusters
[91mhey[0m decide how you want to do these imports
[91mhey[0m decide how you want to do these imports
[91mhey[0m decide how you want to do these imports
[91mhey[0m decide how you want to do these imports
[91mhey[0m decide how you want to do these imports
[91mhey[0m decide how you want to do these imports
[91mhey[0m decide how you want to do these imports
[91mhey[0m decide how you want to do these imports
[91mhey[0m decide how you want to do these imports
[91mhey[0m decide how you want to do these imports
[91mhey[0m decide how you want to do these imports
[91mhey[0m decide how you want to do these imports
    skipped 92 clusters with lengths: 9 9 9 9 9 9 8 8 8 8 8 8 8 8 8 7 7 7 7 6 6 5 5 5 5 4 4 4 4 4 4 4 4 4 3 3 3 3 3 3 3 3 3 3 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
(9.3 sec)
      total time: 67.0
[92mseed-partition-new-simu[0m          ./bin/partis partition --n-max-queries 500 --persistent-cachefname test/new-results/cache-new-partition.csv --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed-unique-id 1013338242313946264 --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/seed-partition-new-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
        reading sw results from test/new-results/test/parameters/simu/sw-cache
      info for 499 / 500 = 0.998   (1 failed)
      kept 341 (0.682) unproductive
      removed 451 / 499 = 0.90 sequences with cdr3 length different from seed sequence (leaving 48)
        water time: 0.4
hmm
   collapsed 48 queries into 30 clusters with identical naive seqs (0.0 sec)
30 clusters with 10 procs
    prepare_for_hmm: (0.0 sec)
       naive hfrac bounds: 0.015 0.110   (0.113 mean mutation in parameter dir test/new-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 794   logprobs 627
                    calcd:         vtb  11        fwd   9
                   merged:       hfrac  42     lratio   7
             min-max time:  0.0 - 0.6 sec
      hmm step time: 0.7
32 clusters with 7 procs
    prepare_for_hmm: (0.0 sec)
    running 7 procs
          read from cache:  naive-seqs 805   logprobs 636
                    calcd:         vtb   0        fwd   1
                   merged:       hfrac  22     lratio   0
             min-max time:  0.0 - 0.3 sec
      hmm step time: 0.3
29 clusters with 5 procs
    prepare_for_hmm: (0.0 sec)
    running 5 procs
          read from cache:  naive-seqs 805   logprobs 637
                    calcd:         vtb   2        fwd   4
                   merged:       hfrac  42     lratio   2
             min-max time:  0.0 - 0.8 sec
      hmm step time: 0.8
      removed 40 sequences in unseeded clusters, split 5 seeded clusters into 8 singletons, and merged these into 8 clusters with identical naive seqs
        new n_procs 2 (initial seqs/proc: 4.80   new seqs/proc: 4.00
8 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 807   logprobs 641
                    calcd:         vtb   5        fwd  13
                   merged:       hfrac  18     lratio   5
             min-max time:  0.9 - 1.0 sec
      hmm step time: 1.0
3 clusters with 1 proc
    prepare_for_hmm: (0.0 sec)
    running 1 proc
          read from cache:  naive-seqs 812   logprobs 654
                    calcd:         vtb   2        fwd   3
                   merged:       hfrac   4     lratio   2
                     time:  1.1 sec
      hmm step time: 1.1
      loop time: 4.0
getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 1 proc
                    calcd:         vtb   1        fwd   0
                     time:  0.3 sec
      hmm step time: 0.4
    read output
        processed 1 hmm output lines with 8 sequences in 1 events  (0 failures)
      total time: 4.9
[92mvsearch-partition-new-simu[0m       ./bin/partis partition --naive-vsearch --n-max-queries 500 --persistent-cachefname test/new-results/cache-new-partition.csv --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/vsearch-partition-new-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
        reading sw results from test/new-results/test/parameters/simu/sw-cache
      info for 499 / 500 = 0.998   (1 failed)
      kept 341 (0.682) unproductive
        water time: 0.4
hmm
       naive hfrac bounds: 0.033 0.033   (0.113 mean mutation in parameter dir test/new-results/test/parameters/simu/hmm)
        collapsed 499 sequences into 291 unique naive sequences
    using hfrac bound for vsearch 0.033
    running vsearch 25 times (once for each cdr3 length class): . . . . . . . . . . . . . . . . . . . . . . . . . 
      vsearch time: 1.1
getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 10 procs
                    calcd:         vtb 126        fwd   0
             min-max time:  1.1 - 1.9 sec
      hmm step time: 2.0
    read output
        processed 126 hmm output lines with 499 sequences in 126 events  (0 failures)
      total time: 3.8
