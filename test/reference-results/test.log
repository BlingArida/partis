[92mannotate-ref-simu[0m                ./bin/partis annotate --plot-annotation-performance --plotdir test/new-results/annotate-ref-simu-annotation-performance --only-csv-plots --only-overall-plots --is-simu --sw-cachefname test/reference-results/test/parameters/simu/sw-cache.csv --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/annotate-ref-simu.csv
  note: running on a lot of sequences (2592) without setting --outfname. Which is ok, but there will be no persistent record of the results.
annotating
smith-waterman 
  vsearch: 2426 / 2592 v annotations (166 failed) with 42 v genes in 0.4 sec
        reading sw results from test/reference-results/test/parameters/simu/sw-cache
      info for 2586 / 2592 = 0.998   (6 failed)
      kept 1708 (0.659) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 22 queries with different true and inferred net shm indel lengths: 274239787520697575 2297067684685451081 2323698662113114669 4326855600139878338 8953202691498841439 -8822467204674255149 6099443263929485145 8808016541917777952 1715868591834685511 8713709947334653556 -3297467371882090978 -3297467371882090979 7347477969923080518 1226564419259445811 3397360095365556469 7975086309426860953 4829978072624285070 7670245129313673609 -4279249722524819428 2872636323358386458 495473891860183024 -3679054569332905577
(0.1 sec)
        water time: 2.2
hmm
    prepare_for_hmm: (0.3 sec)
    running 10 procs
                    calcd:         vtb 2586        fwd    0
             min-max time:  5.3 - 5.9 sec
    read output
  plotting performance (0.1 sec)
        processed 2586 hmm output lines with 2586 sequences in 2586 events  (0 failures)
         infra time: 4.6
      hmm step time: 10.6
      total time: 13.9
[92mmulti-annotate-ref-simu[0m          ./bin/partis annotate --plot-annotation-performance --simultaneous-true-clonal-seqs --plotdir test/new-results/multi-annotate-ref-simu-annotation-performance --only-csv-plots --only-overall-plots --is-simu --sw-cachefname test/reference-results/test/parameters/simu/sw-cache.csv --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/multi-annotate-ref-simu.csv
  note: running on a lot of sequences (2592) without setting --outfname. Which is ok, but there will be no persistent record of the results.
annotating
smith-waterman 
  vsearch: 2426 / 2592 v annotations (166 failed) with 42 v genes in 0.4 sec
        reading sw results from test/reference-results/test/parameters/simu/sw-cache
      info for 2586 / 2592 = 0.998   (6 failed)
      kept 1708 (0.659) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 22 queries with different true and inferred net shm indel lengths: 274239787520697575 2297067684685451081 2323698662113114669 4326855600139878338 8953202691498841439 -8822467204674255149 6099443263929485145 8808016541917777952 1715868591834685511 8713709947334653556 -3297467371882090978 -3297467371882090979 7347477969923080518 1226564419259445811 3397360095365556469 7975086309426860953 4829978072624285070 7670245129313673609 -4279249722524819428 2872636323358386458 495473891860183024 -3679054569332905577
(0.1 sec)
        water time: 2.1
hmm
  [93mwarning[0m split apart 7 clusters that contained multiple cdr3 lengths (total clusters: 479 --> 486)
    prepare_for_hmm: (0.2 sec)
    running 10 procs
                    calcd:         vtb  486        fwd    0
             min-max time:  2.7 - 4.5 sec
    read output
  plotting performance (0.2 sec)
        processed 486 hmm output lines with 2586 sequences in 486 events  (0 failures)
         infra time: 2.6
      hmm step time: 7.3
      total time: 10.4
[92mpartition-ref-simu[0m               ./bin/partis partition --n-max-queries 500 --n-precache-procs 10 --plot-annotation-performance --biggest-logprob-cluster-to-calculate 5 --biggest-naive-seq-cluster-to-calculate 5 --persistent-cachefname test/new-results/cache-ref-partition.csv --plotdir test/new-results/partition-ref-simu-annotation-performance --only-csv-plots --only-overall-plots --is-simu --sw-cachefname test/reference-results/test/parameters/simu/sw-cache.csv --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/partition-ref-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
  vsearch: 478 / 500 v annotations (22 failed) with 23 v genes in 0.1 sec
        reading sw results from test/reference-results/test/parameters/simu/sw-cache
      info for 499 / 500 = 0.998   (1 failed)
      kept 307 (0.614) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 6 queries with different true and inferred net shm indel lengths: 274239787520697575 2297067684685451081 2323698662113114669 4326855600139878338 8953202691498841439 -8822467204674255149
(0.1 sec)
        water time: 0.9
hmm
caching all 499 naive sequences
    prepare_for_hmm: (0.1 sec)
    running 10 procs
                no/empty cache file
                    calcd:         vtb 499        fwd   0
                   merged:       hfrac   0     lratio   0
             min-max time:  1.5 - 1.9 sec
      hmm step time: 2.0
   collapsed 499 queries into 281 clusters with identical naive seqs (0.0 sec)
281 clusters with 10 procs
    prepare_for_hmm: (0.0 sec)
       naive hfrac bounds: 0.015 0.106   (0.105 mean mutation in parameter dir test/reference-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 499   logprobs   0
                    calcd:         vtb 108        fwd 167
                   merged:       hfrac  25     lratio  25
             min-max time:  0.8 - 4.0 sec
         infra time: 0.2
      hmm step time: 4.3
231 clusters with 7 procs
    prepare_for_hmm: (0.0 sec)
    running 7 procs
          read from cache:  naive-seqs 615   logprobs 167
                    calcd:         vtb  53        fwd 108
                   merged:       hfrac  19     lratio  17
             min-max time:  0.9 - 2.8 sec
      hmm step time: 2.9
195 clusters with 5 procs
    prepare_for_hmm: (0.0 sec)
    running 5 procs
          read from cache:  naive-seqs 674   logprobs 275
                    calcd:         vtb  35        fwd  64
                   merged:       hfrac  28     lratio   7
             min-max time:  1.9 - 2.6 sec
      hmm step time: 2.7
160 clusters with 3 procs
    prepare_for_hmm: (0.0 sec)
    running 3 procs
          read from cache:  naive-seqs 715   logprobs 339
                    calcd:         vtb  23        fwd  75
                   merged:       hfrac  14     lratio  11
             min-max time:  2.6 - 5.7 sec
      hmm step time: 5.8
135 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 748   logprobs 414
                    calcd:         vtb  13        fwd  49
                   merged:       hfrac  12     lratio   3
             min-max time:  4.0 - 4.1 sec
      hmm step time: 4.2
120 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 768   logprobs 463
                    calcd:         vtb   8        fwd  32
                   merged:       hfrac   6     lratio   4
             min-max time:  3.0 - 3.4 sec
      hmm step time: 3.6
110 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 780   logprobs 495
                    calcd:         vtb   4        fwd  16
                   merged:       hfrac   3     lratio   1
             min-max time:  1.3 - 1.7 sec
      hmm step time: 1.8
106 clusters with 1 proc
    prepare_for_hmm: (0.0 sec)
    running 1 proc
          read from cache:  naive-seqs 785   logprobs 511
                    calcd:         vtb   3        fwd  67
                   merged:       hfrac   2     lratio   3
                     time:  7.8 sec
      hmm step time: 8.0
      loop time: 33.4
getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 10 procs
                    calcd:         vtb 101        fwd   0
             min-max time:  0.8 - 1.5 sec
      hmm step time: 1.6
    read output
  plotting performance (0.1 sec)
        processed 101 hmm output lines with 499 sequences in 101 events  (0 failures)
  --only-csv-plots not implemented for partition plots, so skipping
      total time: 38.9
[92mseed-partition-ref-simu[0m          ./bin/partis partition --n-max-queries 500 --persistent-cachefname test/new-results/cache-ref-partition.csv --is-simu --sw-cachefname test/reference-results/test/parameters/simu/sw-cache.csv --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed-unique-id 8159376626588811342 --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/seed-partition-ref-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
  vsearch: 478 / 500 v annotations (22 failed) with 23 v genes in 0.1 sec
        reading sw results from test/reference-results/test/parameters/simu/sw-cache
      info for 499 / 500 = 0.998   (1 failed)
      kept 307 (0.614) unproductive
      removed 449 / 499 = 0.90 sequences with cdr3 length different from seed sequence (leaving 50)
        water time: 0.4
hmm
   collapsed 50 queries into 31 clusters with identical naive seqs (0.0 sec)
31 clusters with 10 procs
    prepare_for_hmm: (0.0 sec)
       naive hfrac bounds: 0.015 0.106   (0.105 mean mutation in parameter dir test/reference-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 791   logprobs 578
                    calcd:         vtb   7        fwd   2
                   merged:       hfrac   4     lratio   0
             min-max time:  0.0 - 0.2 sec
      hmm step time: 0.3
36 clusters with 7 procs
    prepare_for_hmm: (0.0 sec)
    running 7 procs
          read from cache:  naive-seqs 798   logprobs 580
                    calcd:         vtb   0        fwd   0
                   merged:       hfrac   0     lratio   0
             min-max time:  0.0 - 0.0 sec
    nothing to merge into /tmp/dralph/hmms/332272/hmm_cached_info.csv
      hmm step time: 0.1
33 clusters with 5 procs
    prepare_for_hmm: (0.0 sec)
    running 5 procs
          read from cache:  naive-seqs 798   logprobs 580
                    calcd:         vtb   0        fwd   2
                   merged:       hfrac   0     lratio   0
             min-max time:  0.0 - 0.2 sec
      hmm step time: 0.3
      removed 43 sequences in unseeded clusters, split 5 seeded clusters into 7 singletons, and merged these into 5 clusters with identical naive seqs
        new n_procs 1 (initial seqs/proc: 5.00   new seqs/proc: 5.00
5 clusters with 1 proc
    prepare_for_hmm: (0.0 sec)
    running 1 proc
          read from cache:  naive-seqs 798   logprobs 582
                    calcd:         vtb   4        fwd   7
                   merged:       hfrac   4     lratio   0
                     time:  0.3 sec
      hmm step time: 0.4
      loop time: 1.1
getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 1 proc
                    calcd:         vtb   1        fwd   0
                     time:  0.1 sec
      hmm step time: 0.2
    read output
        processed 1 hmm output lines with 7 sequences in 1 events  (0 failures)
      total time: 2.0
[92mvsearch-partition-ref-simu[0m       ./bin/partis partition --naive-vsearch --n-max-queries 500 --persistent-cachefname test/new-results/cache-ref-partition.csv --is-simu --sw-cachefname test/reference-results/test/parameters/simu/sw-cache.csv --infname test/reference-results/test/simu.csv --parameter-dir test/reference-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/vsearch-partition-ref-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
  vsearch: 478 / 500 v annotations (22 failed) with 23 v genes in 0.1 sec
        reading sw results from test/reference-results/test/parameters/simu/sw-cache
      info for 499 / 500 = 0.998   (1 failed)
      kept 307 (0.614) unproductive
        water time: 0.4
hmm
       naive hfrac bounds: 0.031 0.031   (0.105 mean mutation in parameter dir test/reference-results/test/parameters/simu/hmm)
        collapsed 499 sequences into 281 unique naive sequences
    using hfrac bound for vsearch 0.031
    running vsearch 27 times (once for each cdr3 length class): . . . . . . . . . . . . . . . . . . . . . . . . . . . 
      vsearch time: 1.2
getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 10 procs
                    calcd:         vtb 122        fwd   0
             min-max time:  0.9 - 1.4 sec
      hmm step time: 1.5
    read output
        processed 122 hmm output lines with 499 sequences in 122 events  (0 failures)
      total time: 3.6
[92mcache-parameters-data[0m            ./bin/partis cache-parameters --plotdir test/new-results/test/plots/data --only-csv-plots --only-overall-plots --sw-cachefname test/new-results/test/parameters/data/sw-cache.csv --infname test/mishmash.fa --parameter-dir test/new-results/test/parameters/data --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human
  note: running on a lot of sequences (1412) without setting --outfname. Which is ok, but there will be no persistent record of the results.
caching parameters
  vsearch: 1268 / 1412 v annotations (144 failed) with 177 v genes in 0.1 sec
    keeping 61 / 204 v genes
smith-waterman 
  vsearch: 1264 / 1412 v annotations (148 failed) with 61 v genes in 0.2 sec
    running 10 procs for 1412 seqs
    running 10 procs for 72 seqs
      info for 1369 / 1412 = 0.970   (43 failed)
      kept 436 (0.309) unproductive
      removed 23 / 1369 = 0.02 duplicate sequences after trimming framework insertions (leaving 1346)
    water time: 2.5  (ig-sw 0.1  processing 0.1)
  no queries for allele finding
    <only_csv> not yet implemented in allelefinder
smith-waterman   (writing parameters) 
  vsearch: 1264 / 1412 v annotations (148 failed) with 61 v genes in 0.2 sec
    running 10 procs for 1369 seqs
    running 10 procs for 29 seqs
      info for 1369 / 1412 = 0.970   (43 failed)
      kept 436 (0.309) unproductive
      removed 23 / 1369 = 0.02 duplicate sequences after trimming framework insertions (leaving 1346)
        writing sw results to test/new-results/test/parameters/data/sw-cache
  plotting parameters (2.8 sec)
    writing parameters (0.6 sec)
    water time: 6.6  (ig-sw 4.3  processing 0.1)
  writing hmms (2.5 sec)
hmm
    prepare_for_hmm: (0.1 sec)
    running 10 procs
                    calcd:         vtb 1346        fwd    0
             min-max time:  5.1 - 12.0 sec
    read output
  plotting parameters (2.6 sec)
    writing parameters (0.6 sec)
        processed 1346 hmm output lines with 1343 sequences in 1343 events  (3 failures)
            [91mwarning[0m skipped 3 invalid events
         infra time: 5.2
      hmm step time: 17.3
  writing hmms (2.3 sec)
      total time: 32.1
[92msimulate[0m                         ./bin/partis simulate --n-sim-events 500 --n-trees 500 --n-leaves 5 --parameter-dir test/new-results/test/parameters/data --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/test/simu.csv --indel-frequency 0.01 --indel-location v
simulating
   read 499 events from 10 files
      total time: 5.2
[92mcache-parameters-simu[0m            ./bin/partis cache-parameters --plotdir test/new-results/test/plots/simu --only-csv-plots --only-overall-plots --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human
  note: running on a lot of sequences (2592) without setting --outfname. Which is ok, but there will be no persistent record of the results.
caching parameters
  vsearch: 2428 / 2592 v annotations (164 failed) with 94 v genes in 0.2 sec
    keeping 42 / 204 v genes
smith-waterman 
  vsearch: 2426 / 2592 v annotations (166 failed) with 42 v genes in 0.4 sec
    running 10 procs for 2592 seqs
    running 10 procs for 26 seqs
      info for 2586 / 2592 = 0.998   (6 failed)
      kept 1708 (0.659) unproductive
    water time: 5.3  (ig-sw 0.1  processing 0.1)
    <only_csv> not yet implemented in allelefinder
smith-waterman   (writing parameters) 
  vsearch: 2426 / 2592 v annotations (166 failed) with 42 v genes in 0.6 sec
    running 10 procs for 2586 seqs
    running 10 procs for 20 seqs
      info for 2586 / 2592 = 0.998   (6 failed)
      kept 1708 (0.659) unproductive
        writing sw results to test/new-results/test/parameters/simu/sw-cache
  plotting parameters (2.6 sec)
    writing parameters (0.7 sec)
    water time: 10.6  (ig-sw 5.1  processing 0.2)
  writing hmms (1.6 sec)
hmm
    prepare_for_hmm: (0.3 sec)
    running 10 procs
                    calcd:         vtb 2586        fwd    0
             min-max time:  5.3 - 5.9 sec
    read output
  plotting parameters (2.5 sec)
  plotting parameters (2.7 sec)
    writing parameters (0.7 sec)
    writing parameters (0.7 sec)
        processed 2586 hmm output lines with 2586 sequences in 2586 events  (0 failures)
         infra time: 12.7
      hmm step time: 18.8
  writing hmms (1.8 sec)
      total time: 41.2
[92mannotate-new-simu[0m                ./bin/partis annotate --plot-annotation-performance --plotdir test/new-results/annotate-new-simu-annotation-performance --only-csv-plots --only-overall-plots --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/annotate-new-simu.csv
  note: running on a lot of sequences (2592) without setting --outfname. Which is ok, but there will be no persistent record of the results.
annotating
smith-waterman 
  vsearch: 2426 / 2592 v annotations (166 failed) with 42 v genes in 0.4 sec
        reading sw results from test/new-results/test/parameters/simu/sw-cache
      info for 2586 / 2592 = 0.998   (6 failed)
      kept 1708 (0.659) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 22 queries with different true and inferred net shm indel lengths: 274239787520697575 2297067684685451081 2323698662113114669 4326855600139878338 8953202691498841439 -8822467204674255149 6099443263929485145 8808016541917777952 1715868591834685511 8713709947334653556 -3297467371882090978 -3297467371882090979 7347477969923080518 1226564419259445811 3397360095365556469 7975086309426860953 4829978072624285070 7670245129313673609 -4279249722524819428 2872636323358386458 495473891860183024 -3679054569332905577
(0.2 sec)
        water time: 2.2
hmm
    prepare_for_hmm: (0.3 sec)
    running 10 procs
                    calcd:         vtb 2586        fwd    0
             min-max time:  5.3 - 5.7 sec
    read output
  plotting performance (0.2 sec)
        processed 2586 hmm output lines with 2586 sequences in 2586 events  (0 failures)
         infra time: 4.7
      hmm step time: 10.5
      total time: 13.8
[92mmulti-annotate-new-simu[0m          ./bin/partis annotate --plot-annotation-performance --simultaneous-true-clonal-seqs --plotdir test/new-results/multi-annotate-new-simu-annotation-performance --only-csv-plots --only-overall-plots --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/multi-annotate-new-simu.csv
  note: running on a lot of sequences (2592) without setting --outfname. Which is ok, but there will be no persistent record of the results.
annotating
smith-waterman 
  vsearch: 2426 / 2592 v annotations (166 failed) with 42 v genes in 0.4 sec
        reading sw results from test/new-results/test/parameters/simu/sw-cache
      info for 2586 / 2592 = 0.998   (6 failed)
      kept 1708 (0.659) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 22 queries with different true and inferred net shm indel lengths: 274239787520697575 2297067684685451081 2323698662113114669 4326855600139878338 8953202691498841439 -8822467204674255149 6099443263929485145 8808016541917777952 1715868591834685511 8713709947334653556 -3297467371882090978 -3297467371882090979 7347477969923080518 1226564419259445811 3397360095365556469 7975086309426860953 4829978072624285070 7670245129313673609 -4279249722524819428 2872636323358386458 495473891860183024 -3679054569332905577
(0.2 sec)
        water time: 2.2
hmm
  [93mwarning[0m split apart 7 clusters that contained multiple cdr3 lengths (total clusters: 479 --> 486)
    prepare_for_hmm: (0.2 sec)
    running 10 procs
                    calcd:         vtb  486        fwd    0
             min-max time:  2.7 - 4.5 sec
    read output
  plotting performance (0.2 sec)
        processed 486 hmm output lines with 2586 sequences in 486 events  (0 failures)
         infra time: 2.7
      hmm step time: 7.4
      total time: 10.6
[92mpartition-new-simu[0m               ./bin/partis partition --n-max-queries 500 --n-precache-procs 10 --plot-annotation-performance --biggest-logprob-cluster-to-calculate 5 --biggest-naive-seq-cluster-to-calculate 5 --persistent-cachefname test/new-results/cache-new-partition.csv --plotdir test/new-results/partition-new-simu-annotation-performance --only-csv-plots --only-overall-plots --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/partition-new-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
  vsearch: 478 / 500 v annotations (22 failed) with 23 v genes in 0.1 sec
        reading sw results from test/new-results/test/parameters/simu/sw-cache
      info for 499 / 500 = 0.998   (1 failed)
      kept 307 (0.614) unproductive
  plotting performance 
    [93mwarning[0m skipped annotation performance evaluation on 6 queries with different true and inferred net shm indel lengths: 274239787520697575 2297067684685451081 2323698662113114669 4326855600139878338 8953202691498841439 -8822467204674255149
(0.1 sec)
        water time: 1.0
hmm
caching all 499 naive sequences
    prepare_for_hmm: (0.1 sec)
    running 10 procs
                no/empty cache file
                    calcd:         vtb 499        fwd   0
                   merged:       hfrac   0     lratio   0
             min-max time:  1.4 - 1.8 sec
      hmm step time: 2.0
   collapsed 499 queries into 281 clusters with identical naive seqs (0.0 sec)
281 clusters with 10 procs
    prepare_for_hmm: (0.0 sec)
       naive hfrac bounds: 0.015 0.106   (0.105 mean mutation in parameter dir test/new-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 499   logprobs   0
                    calcd:         vtb 108        fwd 167
                   merged:       hfrac  25     lratio  25
             min-max time:  0.7 - 4.1 sec
         infra time: 0.2
      hmm step time: 4.3
231 clusters with 7 procs
    prepare_for_hmm: (0.0 sec)
    running 7 procs
          read from cache:  naive-seqs 615   logprobs 167
                    calcd:         vtb  53        fwd 108
                   merged:       hfrac  19     lratio  17
             min-max time:  1.0 - 2.8 sec
         infra time: 0.1
      hmm step time: 3.0
195 clusters with 5 procs
    prepare_for_hmm: (0.0 sec)
    running 5 procs
          read from cache:  naive-seqs 674   logprobs 275
                    calcd:         vtb  35        fwd  64
                   merged:       hfrac  28     lratio   7
             min-max time:  2.0 - 2.6 sec
      hmm step time: 2.7
160 clusters with 3 procs
    prepare_for_hmm: (0.0 sec)
    running 3 procs
          read from cache:  naive-seqs 715   logprobs 339
                    calcd:         vtb  23        fwd  75
                   merged:       hfrac  14     lratio  11
             min-max time:  2.6 - 5.7 sec
      hmm step time: 5.8
135 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 748   logprobs 414
                    calcd:         vtb  13        fwd  49
                   merged:       hfrac  12     lratio   3
             min-max time:  3.9 - 4.0 sec
      hmm step time: 4.2
120 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 768   logprobs 463
                    calcd:         vtb   8        fwd  32
                   merged:       hfrac   6     lratio   4
             min-max time:  3.0 - 3.4 sec
      hmm step time: 3.6
110 clusters with 2 procs
    prepare_for_hmm: (0.0 sec)
    running 2 procs
          read from cache:  naive-seqs 780   logprobs 495
                    calcd:         vtb   4        fwd  16
                   merged:       hfrac   3     lratio   1
             min-max time:  1.3 - 1.7 sec
      hmm step time: 1.8
106 clusters with 1 proc
    prepare_for_hmm: (0.0 sec)
    running 1 proc
          read from cache:  naive-seqs 785   logprobs 511
                    calcd:         vtb   3        fwd  67
                   merged:       hfrac   2     lratio   3
                     time:  7.9 sec
      hmm step time: 8.0
      loop time: 33.5
getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 10 procs
                    calcd:         vtb 101        fwd   0
             min-max time:  0.8 - 1.5 sec
      hmm step time: 1.6
    read output
  plotting performance (0.1 sec)
        processed 101 hmm output lines with 499 sequences in 101 events  (0 failures)
  --only-csv-plots not implemented for partition plots, so skipping
      total time: 39.1
[92mseed-partition-new-simu[0m          ./bin/partis partition --n-max-queries 500 --persistent-cachefname test/new-results/cache-new-partition.csv --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed-unique-id 8159376626588811342 --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/seed-partition-new-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
  vsearch: 478 / 500 v annotations (22 failed) with 23 v genes in 0.1 sec
        reading sw results from test/new-results/test/parameters/simu/sw-cache
      info for 499 / 500 = 0.998   (1 failed)
      kept 307 (0.614) unproductive
      removed 449 / 499 = 0.90 sequences with cdr3 length different from seed sequence (leaving 50)
        water time: 0.4
hmm
   collapsed 50 queries into 31 clusters with identical naive seqs (0.0 sec)
31 clusters with 10 procs
    prepare_for_hmm: (0.0 sec)
       naive hfrac bounds: 0.015 0.106   (0.105 mean mutation in parameter dir test/new-results/test/parameters/simu/hmm)
    running 10 procs
          read from cache:  naive-seqs 791   logprobs 578
                    calcd:         vtb   7        fwd   2
                   merged:       hfrac   4     lratio   0
             min-max time:  0.0 - 0.2 sec
      hmm step time: 0.3
36 clusters with 7 procs
    prepare_for_hmm: (0.0 sec)
    running 7 procs
          read from cache:  naive-seqs 798   logprobs 580
                    calcd:         vtb   0        fwd   0
                   merged:       hfrac   0     lratio   0
             min-max time:  0.0 - 0.0 sec
    nothing to merge into /tmp/dralph/hmms/279043/hmm_cached_info.csv
      hmm step time: 0.1
33 clusters with 5 procs
    prepare_for_hmm: (0.0 sec)
    running 5 procs
          read from cache:  naive-seqs 798   logprobs 580
                    calcd:         vtb   0        fwd   2
                   merged:       hfrac   0     lratio   0
             min-max time:  0.0 - 0.2 sec
      hmm step time: 0.3
      removed 43 sequences in unseeded clusters, split 5 seeded clusters into 7 singletons, and merged these into 5 clusters with identical naive seqs
        new n_procs 1 (initial seqs/proc: 5.00   new seqs/proc: 5.00
5 clusters with 1 proc
    prepare_for_hmm: (0.0 sec)
    running 1 proc
          read from cache:  naive-seqs 798   logprobs 582
                    calcd:         vtb   4        fwd   7
                   merged:       hfrac   4     lratio   0
                     time:  0.3 sec
      hmm step time: 0.4
      loop time: 1.0
getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 1 proc
                    calcd:         vtb   1        fwd   0
                     time:  0.1 sec
      hmm step time: 0.2
    read output
        processed 1 hmm output lines with 7 sequences in 1 events  (0 failures)
      total time: 1.9
[92mvsearch-partition-new-simu[0m       ./bin/partis partition --naive-vsearch --n-max-queries 500 --persistent-cachefname test/new-results/cache-new-partition.csv --is-simu --sw-cachefname test/new-results/test/parameters/simu/sw-cache.csv --infname test/new-results/test/simu.csv --parameter-dir test/new-results/test/parameters/simu --seed 1 --n-procs 10 --simulation-germline-dir data/germlines/human --outfname test/new-results/vsearch-partition-new-simu.csv
  --n-max-queries: stopped after reading 500 queries from input file
partitioning
smith-waterman 
  vsearch: 478 / 500 v annotations (22 failed) with 23 v genes in 0.1 sec
        reading sw results from test/new-results/test/parameters/simu/sw-cache
      info for 499 / 500 = 0.998   (1 failed)
      kept 307 (0.614) unproductive
        water time: 0.4
hmm
       naive hfrac bounds: 0.031 0.031   (0.105 mean mutation in parameter dir test/new-results/test/parameters/simu/hmm)
        collapsed 499 sequences into 281 unique naive sequences
    using hfrac bound for vsearch 0.031
    running vsearch 27 times (once for each cdr3 length class): . . . . . . . . . . . . . . . . . . . . . . . . . . . 
      vsearch time: 1.2
getting annotations for final partition
    prepare_for_hmm: (0.0 sec)
    running 10 procs
                    calcd:         vtb 122        fwd   0
             min-max time:  0.9 - 1.3 sec
      hmm step time: 1.5
    read output
        processed 122 hmm output lines with 499 sequences in 122 events  (0 failures)
      total time: 3.6
